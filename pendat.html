<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>a4f7fd61a63c4356b99f616d89d30bbc</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<section id="proyek-penambangan-data" class="cell markdown"
data-cell_id="a9a1ce5730e145d1870a74fd4023bece"
data-deepnote_app_block_visible="true"
data-deepnote_cell_type="text-cell-h1" data-formattedRanges="[]">
<h1>PROYEK PENAMBANGAN DATA</h1>
</section>
<div class="cell markdown"
data-cell_id="cbf1053142484ab093bed537fd6ba137"
data-deepnote_app_block_visible="true"
data-deepnote_cell_type="text-cell-p"
data-formattedRanges="[{&quot;fromCodePoint&quot;:78,&quot;ranges&quot;:[],&quot;toCodePoint&quot;:106,&quot;type&quot;:&quot;link&quot;,&quot;url&quot;:&quot;https://archive.ics.uci.edu/&quot;}]">
<p>Kami mengambil data Diagnosa Penyakit Jantung atau Heart Diasese dari
website <a href="https://archive.ics.uci.edu/"
class="uri">https://archive.ics.uci.edu/</a> yang selanjutnya akan kami
uji sebagai proyek dari mata matakuliah kami yaitu matakuliah
Penambangan Data. Untuk lebih jelasnya dapat disimak langkah-langkah
kami dalam mengerjakan proyek ini</p>
</div>
<section id="1-data-understanding-memahami-data" class="cell markdown"
data-cell_id="59ce9469004c4b51a95f6fb2643741a7"
data-deepnote_app_block_visible="true"
data-deepnote_cell_type="text-cell-h2" data-formattedRanges="[]">
<h2>1. Data Understanding (memahami data)</h2>
</section>
<div class="cell markdown"
data-cell_id="b26f3e5eeaa44d8a857f18cef33f8b2a"
data-deepnote_app_block_visible="true"
data-deepnote_cell_type="text-cell-p"
data-formattedRanges="[{&quot;fromCodePoint&quot;:289,&quot;marks&quot;:{&quot;bold&quot;:true},&quot;toCodePoint&quot;:302,&quot;type&quot;:&quot;marks&quot;}]">
<p>Pada pekerjaan kali ini, kami akan melakukan klasifikasi untuk
prediksi penyakit jantung. Tujuan dari pekerjaan ini adalah untuk
membantu dalam memprediksi adanya penyakit jantung atau tidak pada
individu berdasarkan berbagai fitur yang tersedia. Dataset yang kami
gunakan adalah dataset "Heart Disease" yang kami ambil dari UCI Machine
Learning Repository. Dataset ini berasal dari Cleveland Clinic
Foundation.</p>
</div>
<div class="cell markdown"
data-cell_id="35b17bc9fa354bb58dc1a88819e6c796"
data-deepnote_app_block_visible="true"
data-deepnote_cell_type="text-cell-p"
data-formattedRanges="[{&quot;fromCodePoint&quot;:181,&quot;marks&quot;:{&quot;bold&quot;:true},&quot;toCodePoint&quot;:189,&quot;type&quot;:&quot;marks&quot;}]">
<p>Langkah pertama yang dilakukan adalah mengumpulkan data. Data
tersebut berada di aiven.com, sehingga data perlu ditarik dari sumber
tersebut. Dataset ini terdiri dari 303 baris dan 13 fitur, yaitu age,
sex, cp, trestbp, chol, fbs, restecg, thalach, exang, oldpeak, slope,
ca, dan thal.</p>
</div>
<div class="cell markdown"
data-cell_id="c198d38ac78b4671969a7f613e5c1623"
data-deepnote_app_block_visible="true"
data-deepnote_cell_type="text-cell-p" data-formattedRanges="[]">
<p>Terdapat 2 type data dalam dataset ini, yakni numeric dan
categorical.</p>
</div>
<div class="cell markdown"
data-cell_id="a0778dc67a2d4532b2026a162372864c"
data-deepnote_app_block_visible="true"
data-deepnote_cell_type="text-cell-bullet" data-formattedRanges="[]">
<ul>
<li>Tipe data numeric merujuk pada nilai-nilai yang terdiri dari angka
atau bilangan. Tipe data numeric terdiri dari integer (int) dan floating
point (float).</li>
</ul>
</div>
<div class="cell markdown"
data-cell_id="5762fbbbf8514a7fa35673d4808af0c3"
data-deepnote_app_block_visible="true"
data-deepnote_cell_type="text-cell-bullet" data-formattedRanges="[]">
<ul>
<li>Tipe data categorical, juga dikenal sebagai tipe data kategorikal,
merujuk pada variabel yang menggambarkan kategori atau kelompok yang
berbeda.</li>
</ul>
</div>
<div class="cell markdown"
data-cell_id="834a59c7aadb424cbcb5caac3db5eba2"
data-deepnote_app_block_visible="true"
data-deepnote_cell_type="markdown">
<table>
    <tbody>
        <tr>
            <td>no</td>
            <td>nama</td>
            <td>type</td>
            <td>deskripsi</td>
            <td>value</td>
        </tr>
        <tr>
            <td>1</td>
            <td>age</td>
            <td>int (numerik)</td>
            <td>Variabel Usia pasien dalam tahun.</td>
            <td></td>
        </tr>
        <tr>
            <td>2</td>
            <td>sex</td>
            <td>categorical</td>
            <td>Variabel jenis kelamin individu dalam dataset</td>
            <td>1 untuk laki-laki, 0 untuk perempuan</td>
        </tr>
        <tr>
            <td>3</td>
            <td>cp (Chest Pain Type)</td>
            <td>categorical</td>
            <td>Variabel Tipe nyeri dada yang dirasakan pasien.</td>
            <td>
                -- Value 0: typical angina<br>
                -- Value 1: atypical angina<br>
                -- Value 2: non-anginal pain<br>
                -- Value 3: asymptomatic
            </td>
        </tr>
        <tr>
            <td>4</td>
            <td>trestbps (Resting Blood Pressure)</td>
            <td>int</td>
            <td>Variabel Tekanan darah pasien saat istirahat, diukur dalam mm Hg (milimeter merkuri).</td>
            <td></td>
        </tr>
        <tr>
            <td>5</td>
            <td>chol (Serum Cholesterol)</td>
            <td>int</td>
            <td>Variabel kadar kolesterol serum. Jumlah kolesterol dalam darah pasien, diukur dalam mg/dL (miligram per desiliter).</td>
            <td></td>
        </tr>
        <tr>
            <td>6</td>
            <td>fbs (Fasting Blood Sugar)</td>
            <td>categorical</td>
            <td>Variabel kadar gula darah puasa > 120mg/dl. Kadar gula darah pasien setelah berpuasa selama 8 jam.</td>
            <td>1 = true; 0 = false</td>
        </tr>
        <tr>
            <td>7</td>
            <td>restecg (Resting Electrodiographic Result)</td>
            <td>categorical</td>
            <td>Variabel hasil elektrokardiografi(rekaman aktivitas listrik jantung) ketika istirahat</td>
            <td>
                -- Value 0: normal<br>
                -- Value 1: having ST-T wave abnormality<br>
                -- Value 2: showing probable or definite left ventricular hypertrophy by Estes' criteria
            </td>
        </tr>
        <tr>
            <td>8</td>
            <td>thalach (Maximum Heart Rate Achieved)</td>
            <td>int</td>
            <td>Variabel denyut jantung maksimal yang dicapai pasien selama tes latihan.</td>
            <td></td>
        </tr>
        <tr>
            <td>9</td>
            <td>exang (Exercise Induced Angina)</td>
            <td>categorical</td>
            <td>Variabel angina yang diinduksi latihan (nyeri dada selama latihan)</td>
            <td>1 = yes; 0 = no</td>
        </tr>
        <tr>
            <td>10</td>
            <td>oldpeak (ST Depression Induced by Exercise Relative to Rest)</td>
            <td>int</td>
            <td>Variabel depresi ST latihan relatif terhadap istirahat (Perubahan level ST pada elektrokardiogram (EKG) yang menunjukkan seberapa parah jantung terpengaruh oleh latihan fisik.)</td>
            <td></td>
        </tr>
        <tr>
            <td>11</td>
            <td>slope (Slope of the Peak Exercise ST Segment)</td>
            <td>categorical</td>
            <td>Variabel kemiringan segmen ST selama latihan (Kemiringan segmen ST pada EKG)</td>
            <td>
                -- Value 1: upsloping<br>
                -- Value 2: flat<br>
                -- Value 3: downsloping
            </td>
        </tr>
        <tr>
            <td>12</td>
            <td>ca (Number of Major Vessels Colored by Fluoroscopy)</td>
            <td>int</td>
            <td>Variabel jumlah pembuluh darah utama berwarna yang dapat dilihat dengan fluoroskopi (teknik pencitraan medis).</td>
            <td></td>
        </tr>
        <tr>
            <td>13</td>
            <td>thal (Thalassemia)</td>
            <td>categorical</td>
            <td>Variabel Kondisi darah terkait thalasemia.</td>
            <td>
                0 = normal; 1 = fixed defect; 2 = reversable defect
            </td>
        </tr>
        <tr>
            <td>Target Variable</td>
            <td>target</td>
            <td>categorical</td>
            <td>Memprediksi apakah seseorang menderita penyakit jantung atau tidak</td>
            <td>
                0 = tidak ada; 1 = ada
            </td>
        </tr>
    </tbody>
</table>
<h2 id="markdown-output-">Markdown output 🛫</h2>
<p><a href="https://ckeditor.com/">CKEditor 5</a> can be configured to
output Markdown instead of HTML. Markdown is a lightweight markup
language that you can use to add formatting to plain text documents. Use
the <strong>Source</strong> button to check and edit the Markdown source
code of this content. The editor-produced Markdown output supports most
essential features, like <a href="https://ckeditor.com/">links</a>,
<strong>different</strong> kinds of <em>emphasis</em>,
<code>inline code formatting</code>, or code blocks:</p>
<div class="sourceCode" id="cb1"><pre
class="sourceCode css"><code class="sourceCode css"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>p {</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">text-align</span>: <span class="dv">center</span><span class="op">;</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">color</span>: <span class="cn">red</span><span class="op">;</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<h2 id="markdown-input-">Markdown input 🛬</h2>
<p>Thanks to the <a
href="https://ckeditor.com/docs/ckeditor5/latest/features/autoformat.html">autoformatting
feature</a>, you can use Markdown syntax when writing. Try it out - use
these (or any other) Markdown shortcuts in the editor to format the
content on the fly 🚀! | Inline formatting | Shortcut | | --- | --- | |
<strong>Bold</strong> | Type <code>**</code> or <code>__</code> around
your text. | | <em>Italic</em> | Type <code>*</code> or <code>_</code>
around your text. | | <code>Code</code> | Type <code>ˋ</code> around
your text. | | ~Strikethrough~ | Type <code>~~</code> around your text.
| Shh! 🤫 Markdown has very basic support for tables. Some advanced
table-related features like table or cell styling were disabled in this
demo.</p>
<h2 id="block-formatting">Block formatting</h2>
<p>You can also use Markdown to create various text blocks, such as:</p>
<ul>
<li>Block quotes - Start a line with <code>﹥</code> followed by a
space.</li>
<li>Headings:
<ol>
<li>Heading 1 - Start a line with <code>#</code> followed by a
space.</li>
<li>Heading 2 - Start a line with <code>##</code> followed by a
space.</li>
<li>Heading 3 - Start a line with <code>###</code> followed by a
space.</li>
</ol></li>
<li>Lists, including nested ones:
<ul>
<li>Numbered lists - Start a line with <code>1.</code> or
<code>1)</code> followed by a space.</li>
<li>Bulleted lists - Start a line with <code>*</code> or <code>-</code>
followed by a space.</li>
<li>To-do lists - Start a line with <code>[ ]</code> or <code>[x]</code>
followed by a space to insert an unchecked or checked list item.</li>
</ul></li>
<li>Code blocks - Start a line with <code>ˋˋˋ</code>.</li>
<li>Horizontal lines - Start a line with <code>---</code></li>
</ul>
</div>
<section id="menampilkan-data" class="cell markdown"
data-cell_id="461246bbd0b24120b63b75f3482a7555"
data-deepnote_app_block_visible="true"
data-deepnote_cell_type="text-cell-h3" data-formattedRanges="[]">
<h3>Menampilkan Data</h3>
</section>
<div class="cell code" data-cell_id="2d667ef578c84f02a652f8ab9a9b1b96"
data-deepnote_app_block_visible="true" data-deepnote_cell_type="sql"
data-deepnote_sql_source="SELECT * FROM `defaultdb`.`dataset`"
data-deepnote_to_be_reexecuted="false"
data-deepnote_variable_name="df_1" data-execution_millis="3716"
data-execution_start="1718761871449" data-source_hash="null"
data-sql_integration_id="bc3f0200-03fa-4df4-b292-41d7a332fcda">
<div class="sourceCode" id="cb2"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>df_1 <span class="op">=</span> _deepnote_execute_sql(<span class="st">&#39;SELECT * FROM `defaultdb`.`dataset`&#39;</span>, <span class="st">&#39;SQL_BC3F0200_03FA_4DF4_B292_41D7A332FCDA&#39;</span>, audit_sql_comment<span class="op">=</span><span class="st">&#39;&#39;</span>, sql_cache_mode<span class="op">=</span><span class="st">&#39;cache_disabled&#39;</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>df_1</span></code></pre></div>
<div class="output display_data">
<div class="sourceCode" id="cb3"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;size_in_bytes&quot;</span><span class="fu">:</span><span class="dv">36488</span><span class="fu">,</span><span class="dt">&quot;status&quot;</span><span class="fu">:</span><span class="st">&quot;success_no_cache&quot;</span><span class="fu">}</span></span></code></pre></div>
</div>
<div class="output execute_result" data-execution_count="1">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>age</th>
      <th>sex</th>
      <th>cp</th>
      <th>trestbps</th>
      <th>chol</th>
      <th>fbs</th>
      <th>restecg</th>
      <th>thalach</th>
      <th>exang</th>
      <th>oldpeak</th>
      <th>slope</th>
      <th>ca</th>
      <th>thal</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>63</td>
      <td>1</td>
      <td>3</td>
      <td>145</td>
      <td>233</td>
      <td>1</td>
      <td>0</td>
      <td>150</td>
      <td>0</td>
      <td>2.3</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>37</td>
      <td>1</td>
      <td>2</td>
      <td>130</td>
      <td>250</td>
      <td>0</td>
      <td>1</td>
      <td>187</td>
      <td>0</td>
      <td>3.5</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>41</td>
      <td>0</td>
      <td>1</td>
      <td>130</td>
      <td>204</td>
      <td>0</td>
      <td>0</td>
      <td>172</td>
      <td>0</td>
      <td>1.4</td>
      <td>2</td>
      <td>0</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>56</td>
      <td>1</td>
      <td>1</td>
      <td>120</td>
      <td>236</td>
      <td>0</td>
      <td>1</td>
      <td>178</td>
      <td>0</td>
      <td>0.8</td>
      <td>2</td>
      <td>0</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>57</td>
      <td>0</td>
      <td>0</td>
      <td>120</td>
      <td>354</td>
      <td>0</td>
      <td>1</td>
      <td>163</td>
      <td>1</td>
      <td>0.6</td>
      <td>2</td>
      <td>0</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>298</th>
      <td>299</td>
      <td>57</td>
      <td>0</td>
      <td>0</td>
      <td>140</td>
      <td>241</td>
      <td>0</td>
      <td>1</td>
      <td>123</td>
      <td>1</td>
      <td>0.2</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
    </tr>
    <tr>
      <th>299</th>
      <td>300</td>
      <td>45</td>
      <td>1</td>
      <td>3</td>
      <td>110</td>
      <td>264</td>
      <td>0</td>
      <td>1</td>
      <td>132</td>
      <td>0</td>
      <td>1.2</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
    </tr>
    <tr>
      <th>300</th>
      <td>301</td>
      <td>68</td>
      <td>1</td>
      <td>0</td>
      <td>144</td>
      <td>193</td>
      <td>1</td>
      <td>1</td>
      <td>141</td>
      <td>0</td>
      <td>3.4</td>
      <td>1</td>
      <td>2</td>
      <td>3</td>
      <td>0</td>
    </tr>
    <tr>
      <th>301</th>
      <td>302</td>
      <td>57</td>
      <td>1</td>
      <td>0</td>
      <td>130</td>
      <td>131</td>
      <td>0</td>
      <td>1</td>
      <td>115</td>
      <td>1</td>
      <td>1.2</td>
      <td>1</td>
      <td>1</td>
      <td>3</td>
      <td>0</td>
    </tr>
    <tr>
      <th>302</th>
      <td>303</td>
      <td>57</td>
      <td>0</td>
      <td>1</td>
      <td>130</td>
      <td>236</td>
      <td>0</td>
      <td>0</td>
      <td>174</td>
      <td>0</td>
      <td>0.0</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>303 rows × 15 columns</p>
</div>
</div>
</div>
<section id="menentukan-missing-value" class="cell markdown"
data-cell_id="a18260679382430c8f0b8e38326fb0e7"
data-deepnote_app_block_visible="true"
data-deepnote_cell_type="text-cell-h3" data-formattedRanges="[]">
<h3>Menentukan Missing Value</h3>
</section>
<div class="cell code" data-cell_id="8f3cdd024a834d5683a1a117ab31ba0f"
data-deepnote_app_block_visible="true" data-deepnote_cell_type="code"
data-deepnote_to_be_reexecuted="false" data-execution_millis="5878"
data-execution_start="1718761875181" data-source_hash="null">
<div class="sourceCode" id="cb4"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np  </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">&#39;dataset.csv&#39;</span>) </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>df.isnull().<span class="bu">sum</span>()</span></code></pre></div>
<div class="output execute_result" data-execution_count="2">
<pre><code>ID          0
age         0
sex         0
cp          0
trestbps    0
chol        0
fbs         0
restecg     0
thalach     0
exang       0
oldpeak     0
slope       0
ca          0
thal        0
target      0
dtype: int64</code></pre>
</div>
</div>
<div class="cell markdown"
data-cell_id="b0f1068971ff488490bd343eeddd03d9"
data-deepnote_app_block_visible="true"
data-deepnote_cell_type="text-cell-p"
data-formattedRanges="[{&quot;fromCodePoint&quot;:0,&quot;marks&quot;:{&quot;bold&quot;:true},&quot;toCodePoint&quot;:11,&quot;type&quot;:&quot;marks&quot;},{&quot;fromCodePoint&quot;:32,&quot;marks&quot;:{&quot;bold&quot;:true},&quot;toCodePoint&quot;:61,&quot;type&quot;:&quot;marks&quot;}]">
<p>KESIMPULAN: dapat dilihat bahwa tidak terdapat missing values dalam
dataset</p>
</div>
<section id="mengeksplorasi-data-numerik" class="cell markdown"
data-cell_id="bedf6c19af1e4da999be01cd6248183d"
data-deepnote_app_block_visible="true"
data-deepnote_cell_type="text-cell-h3" data-formattedRanges="[]">
<h3>Mengeksplorasi Data (Numerik)</h3>
</section>
<div class="cell code" data-cell_id="17ce79e203a241588997c2950bb03a27"
data-deepnote_app_block_visible="true" data-deepnote_cell_type="code"
data-deepnote_to_be_reexecuted="false" data-execution_millis="299"
data-execution_start="1718762578960" data-source_hash="null">
<div class="sourceCode" id="cb6"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np  <span class="co"># Import library numpy</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd  <span class="co"># Import library pandas</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">&#39;Numerical.csv&#39;</span>)  <span class="co"># Membaca file dataset.csv</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>df.describe() <span class="co">#hanya berlaku untuk type data numerik </span></span></code></pre></div>
<div class="output execute_result" data-execution_count="4">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>trestbps</th>
      <th>chol</th>
      <th>thalach</th>
      <th>oldpeak</th>
      <th>ca</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>272.000000</td>
      <td>272.000000</td>
      <td>272.000000</td>
      <td>272.000000</td>
      <td>272.000000</td>
      <td>272.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>53.977941</td>
      <td>130.750000</td>
      <td>244.488971</td>
      <td>151.091912</td>
      <td>1.021324</td>
      <td>0.727941</td>
    </tr>
    <tr>
      <th>std</th>
      <td>9.005916</td>
      <td>16.414713</td>
      <td>41.800262</td>
      <td>22.017161</td>
      <td>1.152050</td>
      <td>1.030651</td>
    </tr>
    <tr>
      <th>min</th>
      <td>29.000000</td>
      <td>94.000000</td>
      <td>157.000000</td>
      <td>88.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>47.000000</td>
      <td>120.000000</td>
      <td>212.000000</td>
      <td>139.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>55.000000</td>
      <td>130.000000</td>
      <td>240.500000</td>
      <td>154.500000</td>
      <td>0.650000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>60.000000</td>
      <td>140.000000</td>
      <td>273.000000</td>
      <td>168.000000</td>
      <td>1.600000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>77.000000</td>
      <td>200.000000</td>
      <td>353.000000</td>
      <td>202.000000</td>
      <td>6.200000</td>
      <td>4.000000</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell markdown"
data-cell_id="81bbac9a72044ed88492a80659173473"
data-deepnote_app_block_visible="true" data-deepnote_cell_type="image"
data-deepnote_img_src="image-20240606-061415.png">
<p><img src="_images/image-20240606-061415.png" width="" align="" /></p>
</div>
<div class="cell markdown"
data-cell_id="8cd93d16a0ea44b28b1866ce4c6292ea"
data-deepnote_app_block_visible="true" data-deepnote_cell_type="image"
data-deepnote_img_src="image-20240606-061259.png">
<p><img src="_images/image-20240606-061259.png" width="" align="" /></p>
</div>
<div class="cell markdown"
data-cell_id="5fe9f0c84a09431b95217d1020e79cc3"
data-deepnote_app_block_visible="true"
data-deepnote_cell_type="text-cell-p"
data-formattedRanges="[{&quot;fromCodePoint&quot;:0,&quot;marks&quot;:{&quot;bold&quot;:true},&quot;toCodePoint&quot;:12,&quot;type&quot;:&quot;marks&quot;}]">
<p>KETERANGAN :</p>
</div>
<div class="cell markdown"
data-cell_id="f56d368d643345c6a346b2de9e484e5d"
data-deepnote_app_block_visible="true"
data-deepnote_cell_type="text-cell-p"
data-formattedRanges="[{&quot;fromCodePoint&quot;:0,&quot;marks&quot;:{&quot;bold&quot;:true},&quot;toCodePoint&quot;:63,&quot;type&quot;:&quot;marks&quot;},{&quot;fromCodePoint&quot;:96,&quot;marks&quot;:{&quot;bold&quot;:true},&quot;toCodePoint&quot;:101,&quot;type&quot;:&quot;marks&quot;},{&quot;fromCodePoint&quot;:139,&quot;marks&quot;:{&quot;bold&quot;:true},&quot;toCodePoint&quot;:164,&quot;type&quot;:&quot;marks&quot;},{&quot;fromCodePoint&quot;:213,&quot;marks&quot;:{&quot;bold&quot;:true},&quot;toCodePoint&quot;:216,&quot;type&quot;:&quot;marks&quot;},{&quot;fromCodePoint&quot;:253,&quot;marks&quot;:{&quot;bold&quot;:true},&quot;toCodePoint&quot;:279,&quot;type&quot;:&quot;marks&quot;},{&quot;fromCodePoint&quot;:381,&quot;marks&quot;:{&quot;bold&quot;:true},&quot;toCodePoint&quot;:385,&quot;type&quot;:&quot;marks&quot;},{&quot;fromCodePoint&quot;:420,&quot;marks&quot;:{&quot;bold&quot;:true},&quot;toCodePoint&quot;:422,&quot;type&quot;:&quot;marks&quot;}]">
<p>df.describe() hanya digunakan untuk tipe data numerik Count: Jumlah
data dalam setiap kolom. Mean: Rata-rata nilai dalam setiap kolom. Std
(Standard Deviation): Standar Deviasi dari nilai dalam setiap kolom.
Min: Nilai minimum dalam setiap kolom. 25%, 50%, 75% (quartiles):
Nilai-nilai kuartil yang membagi data menjadi empat bagian sama besar.
Kuartil ke-50 adalah median. Max: Nilai maksimum dalam setiap kolom.</p>
</div>
<section id="mengeksplorasi-data-categorical" class="cell markdown"
data-cell_id="c6551bb1597340449c79c70644ac0a43"
data-deepnote_app_block_visible="true"
data-deepnote_cell_type="text-cell-h3" data-formattedRanges="[]">
<h3>Mengeksplorasi Data (Categorical)</h3>
</section>
<div class="cell code" data-cell_id="95a56d5bcd82418ea09e2cbe4b3e4a46"
data-deepnote_app_block_visible="true" data-deepnote_cell_type="code"
data-deepnote_to_be_reexecuted="false" data-execution_millis="712"
data-execution_start="1717628861524" data-source_hash="null">
<div class="sourceCode" id="cb7"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Langkah 1: Impor pustaka pandas</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Langkah 2: Baca file CSV menggunakan pd.read_csv</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Ganti &#39;nama_file.csv&#39; dengan nama file CSV yang sesuai dengan data Anda</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> pd.read_csv(<span class="st">&#39;categorical.csv&#39;</span>)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Langkah 3: Hitung modus untuk setiap kolom kategori menggunakan mode()</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>modus <span class="op">=</span> data.mode()</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Langkah 4: Tampilkan hasil modus</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Modus untuk setiap kolom kategori:&quot;</span>)</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(modus)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Modus untuk setiap kolom kategori:
   sex  cp  fbs  restecg  exang  slope  thal  target
0    1   0    0        1      0      2     2       1
</code></pre>
</div>
</div>
<div class="cell markdown"
data-cell_id="89c17cb95c6e4b2f8fe80aeea8c182c3"
data-deepnote_app_block_visible="true" data-deepnote_cell_type="image"
data-deepnote_img_src="image-20240606-061654.png">
<p><img src="_images/image-20240606-061654.png" width="" align="" /></p>
</div>
<div class="cell markdown"
data-cell_id="c10896c412fb4075a4236c8bcfbcf942"
data-deepnote_app_block_visible="true" data-deepnote_cell_type="image"
data-deepnote_img_src="image-20240606-061613.png">
<p><img src="_images/image-20240606-061613.png" width="" align="" /></p>
</div>
<div class="cell markdown"
data-cell_id="9ed2506a36534eafaaa983aaa7c7638c"
data-deepnote_app_block_visible="true"
data-deepnote_cell_type="text-cell-p"
data-formattedRanges="[{&quot;fromCodePoint&quot;:0,&quot;marks&quot;:{&quot;bold&quot;:true},&quot;toCodePoint&quot;:11,&quot;type&quot;:&quot;marks&quot;}]">
<p>KESIMPULAN: dapat dilihat bahwa karakteristik yang paling sering
muncul adalah berjenis kelamin(sex) pria(1), jenis nyeri dada(cp)
"typical angina"(0), kadar gula darah puasa(fbs) normal(0), hasil
elektrokardiogram(restecg) normal(1), (slope) jarang mengalami angina
saat latihan fisik, tipe slope "flat"(2), dan jenis thalassemia(thal)
"normal"(2).</p>
</div>
<section id="menentukan-outlier" class="cell markdown"
data-cell_id="f6bea4650e1849a184b43822aa6d0a0e"
data-deepnote_app_block_visible="true"
data-deepnote_cell_type="text-cell-h3" data-formattedRanges="[]">
<h3>Menentukan Outlier</h3>
</section>
<div class="cell markdown"
data-cell_id="e363197523264f5882bcb95ab76f631f"
data-deepnote_app_block_visible="true"
data-deepnote_cell_type="text-cell-p" data-formattedRanges="[]">
<p>Outlier adalah data yang berbeda secara signifikan dari data lain
dalam sebuah set data. Mereka bisa menjadi nilai yang sangat kecil atau
sangat besar dibandingkan dengan nilai rata-rata atau mayoritas data
lainnya.</p>
</div>
<div class="cell markdown"
data-cell_id="6b7ec24064974bc7bc01c4737bc72f34"
data-deepnote_app_block_visible="true"
data-deepnote_cell_type="text-cell-p" data-formattedRanges="[]">
<p>LOF (Local Outlier Factor) adalah metode statistik yang digunakan
untuk mendeteksi outlier dalam sebuah set data. Metode ini menghitung
seberapa jauh suatu titik data berada dari tetangga-tetangganya dalam
konteks data tersebut. LOF memberikan nilai yang menggambarkan seberapa
"aneh" atau tidak biasa suatu titik data dibandingkan dengan
tetangganya.</p>
</div>
<div class="cell markdown"
data-cell_id="70b65fc245584fb0a5221f2077ded2b2"
data-deepnote_app_block_visible="true"
data-deepnote_cell_type="text-cell-p" data-formattedRanges="[]">
<p>Berikut merupakan implementasi dari perhitungan LOF dengan
menggunakan library Scikit Learn.</p>
</div>
<div class="cell code" data-cell_id="d80777b2e392428fb88da55469174b40"
data-deepnote_app_block_visible="true" data-deepnote_cell_type="code"
data-deepnote_to_be_reexecuted="true" data-execution_millis="722"
data-execution_start="1717628250302" data-source_hash="null">
<div class="sourceCode" id="cb9"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Mengimpor pustaka pandas dengan alias &#39;pd&#39;.</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Mengimpor kelas LocalOutlierFactor dari modul neighbors di pustaka Scikit-learn (sklearn).</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.neighbors <span class="im">import</span> LocalOutlierFactor</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Membaca dataset dari file CSV (&quot;dataset.csv&quot;) ke dalam DataFrame X menggunakan Pandas.</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> pd.read_csv(<span class="st">&quot;dataset.csv&quot;</span>)</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Membuat objek LocalOutlierFactor (LOF).</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="co"># n_neighbors=5 menentukan jumlah tetangga yang akan digunakan dalam perhitungan LOF.</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="co"># contamination=0.1 menentukan tingkat kontaminasi atau persentase outlier yang diharapkan dalam data.</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>lof <span class="op">=</span> LocalOutlierFactor(n_neighbors<span class="op">=</span><span class="dv">5</span>, contamination<span class="op">=</span><span class="fl">0.1</span>)</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Menggunakan metode fit_predict() dari objek LOF untuk menentukan status outlier (outlier atau bukan) untuk setiap sampel dalam data.</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Hasilnya akan berupa array yang berisi prediksi status outlier untuk setiap sampel.</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>y_pred <span class="op">=</span> lof.fit_predict(X)</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Mencetak tabel prediksi status outlier.</span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Predicted table:&quot;</span>, y_pred)</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Mencetak nilai LOF yang bersifat negatif.</span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Negative LOF scores memberikan informasi tentang seberapa jauh setiap sampel berada dari tetangganya dalam konteks outlier detection.</span></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Negative LOF scores:&quot;</span>, <span class="op">-</span>lof.negative_outlier_factor_)</span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Cari indeks dari nilai -1 dalam array y_pred</span></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>outlier_indices <span class="op">=</span> [index <span class="cf">for</span> index, value <span class="kw">in</span> <span class="bu">enumerate</span>(y_pred) <span class="cf">if</span> value <span class="op">==</span> <span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Cetak indeks dari nilai -1 untuk mengetahui data ke berapa yang dianggap sebagai outlier</span></span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Data outlier terdapat pada indeks:&quot;</span>, outlier_indices)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Predicted table: [ 1  1  1  1 -1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
  1  1  1  1 -1  1  1  1  1  1  1  1  1  1  1 -1  1  1  1  1  1  1  1  1
  1  1  1  1  1 -1  1  1  1  1  1  1  1  1  1 -1  1  1  1  1  1  1  1  1
  1  1  1  1  1  1  1  1  1  1  1  1 -1 -1  1  1  1  1  1  1  1  1 -1 -1
 -1  1  1  1  1 -1  1  1  1 -1 -1  1  1  1 -1 -1  1  1  1  1  1  1  1  1
  1  1  1  1  1  1  1  1  1 -1 -1  1  1  1  1  1  1  1  1  1  1  1  1  1
  1  1  1  1  1  1  1 -1  1  1  1  1  1  1  1  1  1  1  1  1  1 -1  1  1
  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1 -1  1  1  1  1  1  1
  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
  1  1  1  1 -1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
  1  1  1  1  1  1 -1  1 -1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
  1  1 -1 -1  1  1  1  1 -1  1  1  1 -1  1  1 -1  1  1  1  1  1  1  1  1
  1  1  1  1  1  1 -1  1  1 -1  1  1  1 -1  1]
Negative LOF scores: [0.99710253 1.07055211 1.10317456 0.98688025 1.36179513 1.05455635
 1.04312786 1.1136824  1.17921262 1.15398158 1.03206924 1.05035766
 1.04101311 0.96893306 1.0259659  1.00672292 1.20170549 1.16204075
 0.99299785 1.01332825 0.96258321 0.98252991 0.97202749 1.1007573
 1.01658246 1.04797362 0.99476059 1.2036188  1.48184233 1.04249566
 1.0421829  1.02684687 0.99858083 0.98293505 1.04447309 1.0412997
 1.01069119 0.96707467 1.04033638 1.40193142 0.98691258 0.99328319
 1.0293164  1.00400181 1.07336052 1.03102213 0.96910093 0.98311378
 1.10154684 1.01425808 0.99747996 0.94200702 1.10996145 1.36493789
 0.95658066 0.98878571 0.99682248 1.10417253 1.15364832 0.98459891
 1.13258989 0.96627201 1.12488904 1.21448933 0.99031287 1.135565
 1.06772696 0.98363984 0.98854266 1.01290157 0.96791608 1.05713049
 1.20863332 1.08424677 0.93489975 0.98569836 1.00256745 0.94460625
 0.97656704 1.05481169 1.03734554 0.97683783 1.0514034  1.08261437
 1.23294807 2.58246148 1.15918541 1.13045496 1.03939841 1.18931183
 0.96037085 1.02899114 0.99455108 1.07552553 1.67869881 1.23283812
 1.59677269 0.94833329 1.03421357 0.98194326 1.05700081 1.50961529
 1.01286454 1.10102041 0.96928415 1.36427866 1.25722521 1.02479298
 1.00615978 0.98847364 1.3872608  2.01613413 1.16349727 1.01490499
 0.97189745 0.99086237 0.94743283 0.95683089 1.00644147 1.00539385
 1.16891397 1.05564374 0.99234096 0.98246196 1.07635857 1.03597597
 1.01266384 1.08382033 1.02807417 1.35199658 1.2682644  1.01961153
 1.02822865 1.10117625 1.03484964 0.99703712 1.2108642  1.00976572
 1.029855   1.15879677 1.03107282 1.13586852 1.00266719 1.03563209
 1.14555605 1.07510473 1.06846677 1.14320023 0.96341232 1.03409591
 1.18358389 1.31402    1.1065415  1.07520536 0.98406196 1.02250736
 1.02825083 1.04809689 0.99506433 0.97497182 0.99511088 1.13151814
 1.05623813 1.08850019 1.08850019 1.21448314 0.98842249 1.02654247
 1.06670436 1.04096515 1.05855214 0.97421618 1.0686391  0.97506281
 0.97833857 1.13097128 0.96646274 1.05977598 1.10044161 1.03839129
 1.04734386 1.09994694 1.05476225 1.00328575 1.09121023 1.25082815
 1.03573359 1.07653834 1.07933863 0.98997091 1.0198115  1.04875395
 1.0512862  1.10911279 1.09029519 1.08578839 1.07337158 0.99697676
 0.97686308 1.0059718  1.15893009 0.94904916 1.04547659 1.18320303
 1.2121696  1.02148467 0.98769852 1.11725414 0.99699389 1.02233142
 1.00352881 1.0091896  1.07851426 0.9979436  0.9709955  1.08818161
 1.08483216 1.02247129 1.0274108  0.95722325 1.67877982 1.18036081
 0.97764377 1.15721361 1.11305703 1.10126588 1.05080832 1.01227226
 1.03864339 1.03403571 1.118998   0.99707539 0.97678476 1.13530886
 1.0744253  0.98110789 1.00233426 1.00765644 0.96977785 1.08321531
 1.03296513 1.08034478 1.12650469 1.05600891 1.01722818 1.0004918
 1.79201526 1.02025497 1.75002507 1.02600593 0.96626089 1.00365777
 1.00962042 1.14127592 1.01923237 0.99613235 0.96865145 1.15701909
 0.98789386 1.13511244 1.09912812 1.04981334 0.9630444  1.13526553
 1.18938346 1.14454339 1.43496042 1.30415521 0.99580202 0.96695479
 0.9708449  0.9386293  1.46169391 1.05381349 1.03224936 1.060824
 1.21991495 1.02554235 1.06663147 1.34007287 1.01854186 0.96869727
 1.01216517 1.17066607 0.98012135 1.03023181 0.98370918 1.10694409
 1.14350815 0.97702744 0.98057191 1.07844127 1.15798597 1.00597438
 1.30039599 0.98148941 0.98853493 1.87883393 1.20669489 1.09312942
 0.97003798 1.38443326 1.20282464]
Data outlier terdapat pada indeks: [4, 28, 39, 53, 63, 84, 85, 94, 95, 96, 101, 105, 106, 110, 111, 129, 130, 151, 165, 185, 220, 246, 248, 266, 267, 272, 276, 279, 294, 297, 301]
</code></pre>
</div>
</div>
<div class="cell markdown"
data-cell_id="64050208cca6405b8a12a234358c5f8d"
data-deepnote_app_block_visible="true"
data-deepnote_cell_type="text-cell-p"
data-formattedRanges="[{&quot;fromCodePoint&quot;:0,&quot;marks&quot;:{&quot;bold&quot;:true},&quot;toCodePoint&quot;:11,&quot;type&quot;:&quot;marks&quot;},{&quot;fromCodePoint&quot;:88,&quot;marks&quot;:{&quot;bold&quot;:true},&quot;toCodePoint&quot;:121,&quot;type&quot;:&quot;marks&quot;}]">
<p>KESIMPULAN: Disini asumsinya adakah 0.1(10%) dari seluruh data
dianggap outlier. output -1 adalah ciri-ciri dari outlier. dan output
yang menunjukkan angka-angka desimal yang lebih tinggi dari angka-angka
desimal lainnya merupakan outliernya. hal ini ditunjukkan pada indeks ke
[4, 28, 39, 53, 63, 84, 85, 94, 95, 96, 101, 105, 106, 110, 111, 129,
130, 151, 165, 185, 220, 246, 248, 266, 267, 272, 276, 279, 294, 297,
301]</p>
</div>
<section id="2-preprocessing" class="cell markdown"
data-cell_id="ac5728a143db4a3586062ca1eba561fd"
data-deepnote_app_block_visible="true"
data-deepnote_cell_type="text-cell-h2" data-formattedRanges="[]">
<h2>2. Preprocessing</h2>
</section>
<section id="menghapus-outlier" class="cell markdown"
data-cell_id="c2c5761ea60a42efafa5452188ce4d6e"
data-deepnote_app_block_visible="true"
data-deepnote_cell_type="text-cell-h3" data-formattedRanges="[]">
<h3>Menghapus Outlier</h3>
</section>
<div class="cell code" data-cell_id="01d8f93e399f4a1cbf5216b3abf4521a"
data-deepnote_app_block_visible="true" data-deepnote_cell_type="code"
data-deepnote_to_be_reexecuted="true" data-execution_millis="1090"
data-execution_start="1717592966404" data-source_hash="null">
<div class="sourceCode" id="cb11"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Mengimpor pustaka pandas dengan alias &#39;pd&#39;.</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Mengimpor kelas LocalOutlierFactor dari modul neighbors di pustaka Scikit-learn (sklearn).</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.neighbors <span class="im">import</span> LocalOutlierFactor</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Membaca dataset dari file CSV (&quot;dataset.csv&quot;) ke dalam DataFrame X menggunakan Pandas.</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> pd.read_csv(<span class="st">&quot;dataset.csv&quot;</span>)</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Membuat objek LocalOutlierFactor (LOF).</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="co"># n_neighbors=5 menentukan jumlah tetangga yang akan digunakan dalam perhitungan LOF.</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a><span class="co"># contamination=0.1 menentukan tingkat kontaminasi atau persentase outlier yang diharapkan dalam data.</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>lof <span class="op">=</span> LocalOutlierFactor(n_neighbors<span class="op">=</span><span class="dv">5</span>, contamination<span class="op">=</span><span class="fl">0.1</span>)</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Menggunakan metode fit_predict() dari objek LOF untuk menentukan status outlier (outlier atau bukan) untuk setiap sampel dalam data.</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Hasilnya akan berupa array yang berisi prediksi status outlier untuk setiap sampel.</span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>y_pred <span class="op">=</span> lof.fit_predict(X)</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Cari indeks dari nilai -1 dalam array y_pred</span></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>outlier_indices <span class="op">=</span> [index <span class="cf">for</span> index, value <span class="kw">in</span> <span class="bu">enumerate</span>(y_pred) <span class="cf">if</span> value <span class="op">==</span> <span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Cetak indeks dari nilai -1 untuk mengetahui data ke berapa yang dianggap sebagai outlier</span></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Data outlier terdapat pada indeks:&quot;</span>, outlier_indices)</span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Menghapus baris yang mengandung outlier dari DataFrame</span></span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>X_cleaned <span class="op">=</span> X.drop(outlier_indices)</span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Menyimpan DataFrame yang telah dibersihkan ke file CSV baru</span></span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>X_cleaned.to_csv(<span class="st">&quot;dataset_tanpa_outlier.csv&quot;</span>, index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Menampilkan jumlah baris asli dan jumlah baris setelah outlier dihapus</span></span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Jumlah baris asli:&quot;</span>, <span class="bu">len</span>(X))</span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Jumlah baris setelah outlier dihapus:&quot;</span>, <span class="bu">len</span>(X_cleaned))</span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Dataset tanpa outlier telah disimpan ke &#39;dataset_tanpa_outlier.csv&#39;&quot;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Data outlier terdapat pada indeks: [4, 28, 39, 53, 63, 84, 85, 94, 95, 96, 101, 105, 106, 110, 111, 129, 130, 151, 165, 185, 220, 246, 248, 266, 267, 272, 276, 279, 294, 297, 301]
Jumlah baris asli: 303
Jumlah baris setelah outlier dihapus: 272
Dataset tanpa outlier telah disimpan ke &#39;dataset_tanpa_outlier.csv&#39;
</code></pre>
</div>
</div>
<div class="cell markdown"
data-cell_id="86479a8158ec4a75a59fda0df77d8b9f"
data-deepnote_app_block_visible="true"
data-deepnote_cell_type="text-cell-p"
data-formattedRanges="[{&quot;fromCodePoint&quot;:0,&quot;marks&quot;:{&quot;bold&quot;:true},&quot;toCodePoint&quot;:11,&quot;type&quot;:&quot;marks&quot;}]">
<p>Kesimpulan : Kode ini membaca dataset, mendeteksi outlier menggunakan
metode Local Outlier Factor, menghapus baris yang mengandung outlier,
dan menyimpan dataset yang telah dibersihkan ke file baru.</p>
</div>
<section id="memisahkan-data-numeric-dan-categorical"
class="cell markdown" data-cell_id="4fd467e8d5a34fed82a8a5c34988cc0f"
data-deepnote_app_block_visible="true"
data-deepnote_cell_type="text-cell-h3" data-formattedRanges="[]">
<h3>Memisahkan data Numeric dan Categorical</h3>
</section>
<div class="cell markdown"
data-cell_id="67b076d241d44030854a05c8c58b0c48"
data-deepnote_app_block_visible="true"
data-deepnote_cell_type="text-cell-p"
data-formattedRanges="[{&quot;fromCodePoint&quot;:0,&quot;marks&quot;:{&quot;bold&quot;:true},&quot;toCodePoint&quot;:7,&quot;type&quot;:&quot;marks&quot;}]">
<p>Numeric</p>
</div>
<div class="cell markdown"
data-cell_id="f2bc024a329f461485c648cdd0ffb71c"
data-deepnote_app_block_visible="true" data-deepnote_cell_type="image"
data-deepnote_img_src="image-20240605-203240.png">
<p><img src="_images/image-20240605-203240.png" width="" align="" /></p>
</div>
<div class="cell markdown"
data-cell_id="09bef57ffea848cead4265d9b0bbc759"
data-deepnote_app_block_visible="true"
data-deepnote_cell_type="text-cell-p"
data-formattedRanges="[{&quot;fromCodePoint&quot;:0,&quot;marks&quot;:{&quot;bold&quot;:true},&quot;toCodePoint&quot;:11,&quot;type&quot;:&quot;marks&quot;}]">
<p>Categorical</p>
</div>
<div class="cell markdown"
data-cell_id="a3e727c6f72b4992830b8833a8fded70"
data-deepnote_app_block_visible="true" data-deepnote_cell_type="image"
data-deepnote_img_src="image-20240605-203039.png">
<p><img src="_images/image-20240605-203039.png" width="" align="" /></p>
</div>
<section id="min-max" class="cell markdown"
data-cell_id="d81dfd88e81c46e4ae41d470861b689b"
data-deepnote_app_block_visible="true"
data-deepnote_cell_type="text-cell-h3" data-formattedRanges="[]">
<h3>Min Max</h3>
</section>
<div class="cell markdown"
data-cell_id="0a478f9c51ca4066b9ead8febefb3a54"
data-deepnote_app_block_visible="true" data-deepnote_cell_type="image"
data-deepnote_img_src="rumus.jpg">
<p><img src="_images/rumus.jpg" width="" align="" /></p>
</div>
<div class="cell markdown"
data-cell_id="9dd71551228b45468cf6fb55a534227b"
data-deepnote_app_block_visible="true" data-deepnote_cell_type="image"
data-deepnote_img_src="image-20240605-211357.png">
<p><img src="_images/image-20240605-211357.png" width="" align="" /></p>
</div>
<section id="normalisasi-data" class="cell markdown"
data-cell_id="d795ca1078d44735b74a0b52d0001561"
data-deepnote_app_block_visible="true"
data-deepnote_cell_type="text-cell-h3" data-formattedRanges="[]">
<h3>Normalisasi Data</h3>
</section>
<div class="cell markdown"
data-cell_id="66a63a6a8d484f6ba014b66847b8da19"
data-deepnote_app_block_visible="true"
data-deepnote_cell_type="text-cell-p" data-formattedRanges="[]">
<p>Normalization adalah proses mengubah nilai-nilai dalam dataset
sehingga mereka memiliki skala yang seragam. Min-max normalization
adalah salah satu teknik normalization yang umum digunakan. Dalam
min-max normalization, nilai-nilai dalam dataset diubah sedemikian rupa
sehingga mereka berada dalam rentang tertentu, biasanya 0 hingga 1.</p>
</div>
<div class="cell markdown"
data-cell_id="4995b934fd87487ab5e2ef1d7ba69ec2"
data-deepnote_app_block_visible="true" data-deepnote_cell_type="image"
data-deepnote_img_src="image-20240605-211514.png">
<p><img src="_images/image-20240605-211514.png" width="" align="" /></p>
</div>
<section id="3-pemodelan" class="cell markdown"
data-cell_id="9b852dca0e4943a38eaab93de59d2b49"
data-deepnote_app_block_visible="true"
data-deepnote_cell_type="text-cell-h2" data-formattedRanges="[]">
<h2>3. Pemodelan</h2>
</section>
<section id="pengujian-dan-percobaan-dataset" class="cell markdown"
data-cell_id="fc8e39b43ba04dba89625478f9e766d5"
data-deepnote_app_block_visible="true"
data-deepnote_cell_type="text-cell-h3" data-formattedRanges="[]">
<h3>Pengujian dan Percobaan Dataset</h3>
</section>
<div class="cell markdown"
data-cell_id="fc916c1e84a041b5b0325871ea73a776"
data-deepnote_app_block_visible="true"
data-deepnote_cell_type="text-cell-p" data-formattedRanges="[]">
<p>Dataset dibagi menjadi 80% sebagai data training dan 20% sebagai data
testing</p>
</div>
<div class="cell code" data-cell_id="83555145cbc74479bc97501c979be7f4"
data-deepnote_app_block_visible="true" data-deepnote_cell_type="code"
data-deepnote_to_be_reexecuted="true" data-execution_millis="362"
data-execution_start="1717604964597" data-source_hash="null">
<div class="sourceCode" id="cb13"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Membaca data dari file CSV</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> pd.read_csv(<span class="st">&#39;dataset_normalization.csv&#39;</span>)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Memisahkan data menjadi fitur (X) dan target (y)</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> data.drop(<span class="st">&#39;target&#39;</span>, axis<span class="op">=</span><span class="dv">1</span>)  <span class="co"># Sesuaikan dengan nama kolom target</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> data[<span class="st">&#39;target&#39;</span>]</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Membagi data menjadi data pelatihan (80%) dan data pengujian (20%)</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X, y, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Menampilkan jumlah data pada data pelatihan dan data pengujian</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Jumlah data pelatihan:&quot;</span>, <span class="bu">len</span>(X_train))</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Jumlah data pengujian:&quot;</span>, <span class="bu">len</span>(X_test))</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Menyimpan data pengujian ke dalam file CSV</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>testing_data <span class="op">=</span> pd.concat([X_test, y_test], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>testing_data.to_csv(<span class="st">&#39;testing_data_Heart_Disease.csv&#39;</span>, index<span class="op">=</span><span class="va">False</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Jumlah data pelatihan: 217
Jumlah data pengujian: 55
</code></pre>
</div>
</div>
<section id="menyimpan-data-training-dan-data-testing-ke-csv"
class="cell markdown" data-cell_id="a9064cf54f5d42698f9ccc74257f8e8c"
data-deepnote_app_block_visible="true"
data-deepnote_cell_type="text-cell-h3" data-formattedRanges="[]">
<h3>Menyimpan Data Training dan Data Testing ke CSV</h3>
</section>
<div class="cell code" data-cell_id="44f5814793ad4a9c86ca2b81f3526d4d"
data-deepnote_app_block_visible="true" data-deepnote_cell_type="code"
data-deepnote_to_be_reexecuted="true" data-execution_millis="734"
data-execution_start="1717605273957" data-source_hash="null">
<div class="sourceCode" id="cb15"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Membaca data dari file CSV</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>file_path <span class="op">=</span> <span class="st">&#39;dataset_normalization.csv&#39;</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(file_path)</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Membagi data menjadi 80% untuk training dan 20% untuk testing</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>train_df, test_df <span class="op">=</span> train_test_split(df, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Menyimpan data training ke file CSV</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>train_file_path <span class="op">=</span> <span class="st">&#39;hd_training_80.csv&#39;</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>train_df.to_csv(train_file_path, index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Menyimpan data testing ke file CSV</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>test_file_path <span class="op">=</span> <span class="st">&#39;hd_testing_20.csv&#39;</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>test_df.to_csv(test_file_path, index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Data training telah disimpan ke </span><span class="sc">{</span>train_file_path<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Data testing telah disimpan ke </span><span class="sc">{</span>test_file_path<span class="sc">}</span><span class="ss">&quot;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Data training telah disimpan ke hd_training_80.csv
Data testing telah disimpan ke hd_testing_20.csv
</code></pre>
</div>
</div>
<div class="cell markdown"
data-cell_id="058b8a00568843ad9c7b06a1eec85671"
data-deepnote_app_block_visible="true"
data-deepnote_cell_type="text-cell-p"
data-formattedRanges="[{&quot;fromCodePoint&quot;:0,&quot;marks&quot;:{&quot;bold&quot;:true},&quot;toCodePoint&quot;:10,&quot;type&quot;:&quot;marks&quot;}]">
<p>Kesimpulan: Hal ini berfungsi untuk membagi dataset yang tersedia
menjadi dua bagian, yaitu data training dan data testing, dengan
proporsi masing-masing 80% dan 20%. Data yang telah dibagi kemudian
disimpan ke file CSV yang terpisah untuk keperluan lebih lanjut.</p>
</div>
<section
id="prediksi-penyakit-jantung-menggunakan-klasifikasi-k-nearest-neighboars-knn"
class="cell markdown" data-cell_id="a300fe08d7184a249216fe8f1495c4df"
data-deepnote_app_block_visible="true"
data-deepnote_cell_type="text-cell-h3" data-formattedRanges="[]"
data-is_collapsed="false">
<h3>Prediksi Penyakit jantung Menggunakan Klasifikasi K-Nearest
Neighboars (KNN)</h3>
</section>
<div class="cell markdown"
data-cell_id="aae7e3bf5423428fb7ab4ed4a887f577"
data-deepnote_app_block_visible="true"
data-deepnote_cell_type="text-cell-p" data-formattedRanges="[]"
data-is_collapsed="false">
<p>K-Nearest Neighbors (KNN) adalah sebuah algoritma yang digunakan
untuk memprediksi atau mengklasifikasikan data berdasarkan kesamaan
dengan data yang sudah ada. Angka "K" dalam KNN mengacu pada jumlah
tetangga terdekat yang akan dipertimbangkan untuk membuat prediksi.
Misalnya, jika K = 3, maka KNN akan melihat 3 tetangga terdekat dari
titik baru tersebut untuk membuat prediksi kelasnya.</p>
</div>
<section id="menampilkan-data" class="cell markdown"
data-cell_id="458709fb9527408d8afc3853b8048390"
data-deepnote_app_block_visible="true"
data-deepnote_cell_type="text-cell-h3" data-formattedRanges="[]"
data-is_collapsed="false">
<h3>Menampilkan data</h3>
</section>
<div class="cell markdown"
data-cell_id="5c85a99f31c946d99d624748111dde2d"
data-deepnote_app_block_visible="true"
data-deepnote_cell_type="text-cell-p" data-formattedRanges="[]"
data-is_collapsed="false">
<ol>
<li>Menampilkan jumlah baris dan kolom, yakni 272 baris dan 14 kolom (13
Fitur dan 1 Target)</li>
</ol>
</div>
<div class="cell code" data-cell_id="8c87faf7f6d945778b062d98b97c63aa"
data-deepnote_app_block_visible="true" data-deepnote_cell_type="code"
data-deepnote_to_be_reexecuted="true" data-execution_millis="207"
data-execution_start="1717605300916" data-source_hash="null">
<div class="sourceCode" id="cb17"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np  <span class="co"># Import library numpy</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd  <span class="co"># Import library pandas</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">&#39;dataset_normalization.csv&#39;</span>)  <span class="co"># Membaca file dataset.csv dan menyimpannya ke dalam DataFrame df</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>df.shape  <span class="co"># Menampilkan bentuk (jumlah baris dan kolom) dari DataFrame df</span></span></code></pre></div>
<div class="output execute_result" data-execution_count="5">
<pre><code>(272, 14)</code></pre>
</div>
</div>
<div class="cell markdown"
data-cell_id="1ec18b43008a4a36b909d9268781257a"
data-deepnote_app_block_visible="true"
data-deepnote_cell_type="text-cell-p" data-formattedRanges="[]">
<ol>
<li>Menampilkan data</li>
</ol>
</div>
<div class="cell code" data-cell_id="4207bdcadaab4c748a2e91128172711a"
data-deepnote_app_block_visible="true" data-deepnote_cell_type="code"
data-deepnote_to_be_reexecuted="true" data-execution_millis="35"
data-execution_start="1717593008018" data-source_hash="null">
<div class="sourceCode" id="cb19"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>df.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="6">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>age</th>
      <th>sex</th>
      <th>cp</th>
      <th>trestbps</th>
      <th>chol</th>
      <th>fbs</th>
      <th>restecg</th>
      <th>thalach</th>
      <th>exang</th>
      <th>oldpeak</th>
      <th>slope</th>
      <th>ca</th>
      <th>thal</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>63</td>
      <td>1</td>
      <td>3</td>
      <td>145</td>
      <td>233</td>
      <td>1</td>
      <td>0</td>
      <td>150</td>
      <td>0</td>
      <td>2.3</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>37</td>
      <td>1</td>
      <td>2</td>
      <td>130</td>
      <td>250</td>
      <td>0</td>
      <td>1</td>
      <td>187</td>
      <td>0</td>
      <td>3.5</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>41</td>
      <td>0</td>
      <td>1</td>
      <td>130</td>
      <td>204</td>
      <td>0</td>
      <td>0</td>
      <td>172</td>
      <td>0</td>
      <td>1.4</td>
      <td>2</td>
      <td>0</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>56</td>
      <td>1</td>
      <td>1</td>
      <td>120</td>
      <td>236</td>
      <td>0</td>
      <td>1</td>
      <td>178</td>
      <td>0</td>
      <td>0.8</td>
      <td>2</td>
      <td>0</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>57</td>
      <td>0</td>
      <td>0</td>
      <td>120</td>
      <td>354</td>
      <td>0</td>
      <td>1</td>
      <td>163</td>
      <td>1</td>
      <td>0.6</td>
      <td>2</td>
      <td>0</td>
      <td>2</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<section id="menampilkan-grafik-data" class="cell markdown"
data-cell_id="6af333f5cbbd494e9a56c48fff5a07bd"
data-deepnote_app_block_visible="true"
data-deepnote_cell_type="text-cell-h3" data-formattedRanges="[]">
<h3>Menampilkan grafik data</h3>
</section>
<div class="cell code" data-cell_id="660c84468b6b4ecc877cb1795f97ceb4"
data-deepnote_app_block_visible="true" data-deepnote_cell_type="code"
data-deepnote_to_be_reexecuted="true" data-execution_millis="3368"
data-execution_start="1717593054585" data-source_hash="null">
<div class="sourceCode" id="cb20"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt  <span class="co"># Import library matplotlib untuk visualisasi data</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>matplotlib inline  </span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns  <span class="co"># Import library seaborn untuk visualisasi data statistik</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>,<span class="dv">15</span>))  <span class="co"># Membuat objek figure dengan ukuran 15x15 inci</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> fig.gca()  <span class="co"># Mengambil sumbu saat ini (axes) dari objek figure</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>g <span class="op">=</span> df.hist(ax<span class="op">=</span>ax)  <span class="co"># Membuat histogram dari DataFrame df dan menampilkannya di axes ax</span></span></code></pre></div>
<div class="output stream stderr">
<pre><code>/tmp/ipykernel_87/707982571.py:6: UserWarning: To output multiple subplots, the figure containing the passed axes is being cleared.
  g = df.hist(ax=ax)  # Membuat histogram dari DataFrame df dan menampilkannya di axes ax
</code></pre>
</div>
<div class="output display_data">
<p><img
src="_images/1b6b2d4feff5d8a128a5e5dc6a5e33db58f86e7b.png"
width="1218" height="1221" /></p>
</div>
</div>
<section id="menentukan-nilai-k" class="cell markdown"
data-cell_id="07814d87d725483498e65f0b1e11609b"
data-deepnote_app_block_visible="true"
data-deepnote_cell_type="text-cell-h3" data-formattedRanges="[]">
<h3>Menentukan nilai K</h3>
</section>
<div class="cell markdown"
data-cell_id="b40f6df77af548208d9f52e1770f661f"
data-deepnote_app_block_visible="true"
data-deepnote_cell_type="text-cell-p" data-formattedRanges="[]">
<p>Program ini digunakan untuk melakukan evaluasi dan membandingkan
kinerja model K-Nearest Neighbors (K-NN) dengan jumlah tetangga (k) yang
berbeda untuk memilih nilai k yang optimal untuk model. Kami menggunakan
teknik Cross Validation. Cross-Validation adalah metode yang digunakan
untuk mengevaluasi kinerja model dengan cara membagi data menjadi subset
training dan subset testing secara berulang-ulang.</p>
</div>
<div class="cell code" data-cell_id="97b3404738154803a6d402677db88c64"
data-deepnote_app_block_visible="true" data-deepnote_cell_type="code"
data-deepnote_to_be_reexecuted="true" data-execution_millis="906"
data-execution_start="1718120279594" data-source_hash="null">
<div class="sourceCode" id="cb22"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import library yang dibutuhkan</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pickle</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split, GridSearchCV</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> MinMaxScaler</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.neighbors <span class="im">import</span> KNeighborsClassifier</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> accuracy_score</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Membaca data dari file CSV</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> pd.read_csv(<span class="st">&#39;dataset_normalization.csv&#39;</span>)</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Memisahkan data menjadi fitur (X) dan target (y)</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> data.drop(<span class="st">&#39;target&#39;</span>, axis<span class="op">=</span><span class="dv">1</span>)  <span class="co"># Jika targetnya disebut &#39;target&#39;</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> data[<span class="st">&#39;target&#39;</span>]</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Normalisasi data menggunakan MinMaxScaler</span></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>scaler <span class="op">=</span> MinMaxScaler()</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>X_scaled <span class="op">=</span> scaler.fit_transform(X)</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Menyimpan scaler ke file pickle</span></span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>scaler_filename <span class="op">=</span> <span class="st">&quot;preprocessing.pickle&quot;</span></span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>pickle.dump(scaler, <span class="bu">open</span>(scaler_filename, <span class="st">&quot;wb&quot;</span>))</span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Membagi data menjadi data pelatihan dan data pengujian</span></span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X_scaled, y, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Menentukan kisaran nilai K yang ingin diuji</span></span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a>param_grid <span class="op">=</span> {<span class="st">&#39;n_neighbors&#39;</span>: [<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">9</span>, <span class="dv">11</span>, <span class="dv">13</span>, <span class="dv">15</span>]}</span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Inisialisasi model KNN</span></span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a>knn <span class="op">=</span> KNeighborsClassifier()</span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-33"><a href="#cb22-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Inisialisasi Grid Search Cross-Validation</span></span>
<span id="cb22-34"><a href="#cb22-34" aria-hidden="true" tabindex="-1"></a>grid_search <span class="op">=</span> GridSearchCV(estimator<span class="op">=</span>knn, param_grid<span class="op">=</span>param_grid, cv<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb22-35"><a href="#cb22-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-36"><a href="#cb22-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Melatih model menggunakan Grid Search Cross-Validation</span></span>
<span id="cb22-37"><a href="#cb22-37" aria-hidden="true" tabindex="-1"></a>grid_search.fit(X_train, y_train)</span>
<span id="cb22-38"><a href="#cb22-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-39"><a href="#cb22-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Menampilkan hasil Grid Search</span></span>
<span id="cb22-40"><a href="#cb22-40" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;K optimal: &quot;</span>, grid_search.best_params_)</span>
<span id="cb22-41"><a href="#cb22-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-42"><a href="#cb22-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Menggunakan model terbaik untuk prediksi pada data uji</span></span>
<span id="cb22-43"><a href="#cb22-43" aria-hidden="true" tabindex="-1"></a>best_knn <span class="op">=</span> grid_search.best_estimator_</span>
<span id="cb22-44"><a href="#cb22-44" aria-hidden="true" tabindex="-1"></a>y_pred <span class="op">=</span> best_knn.predict(X_test)</span>
<span id="cb22-45"><a href="#cb22-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-46"><a href="#cb22-46" aria-hidden="true" tabindex="-1"></a><span class="co"># Menghitung dan menampilkan akurasi model</span></span>
<span id="cb22-47"><a href="#cb22-47" aria-hidden="true" tabindex="-1"></a>accuracy <span class="op">=</span> accuracy_score(y_test, y_pred)</span>
<span id="cb22-48"><a href="#cb22-48" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Akurasi pada data uji: &quot;</span>, accuracy)</span>
<span id="cb22-49"><a href="#cb22-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-50"><a href="#cb22-50" aria-hidden="true" tabindex="-1"></a><span class="co"># Menyimpan model yang sudah dilatih ke file pickle</span></span>
<span id="cb22-51"><a href="#cb22-51" aria-hidden="true" tabindex="-1"></a>model_filename <span class="op">=</span> <span class="st">&quot;knn_model.pickle&quot;</span></span>
<span id="cb22-52"><a href="#cb22-52" aria-hidden="true" tabindex="-1"></a>pickle.dump(best_knn, <span class="bu">open</span>(model_filename, <span class="st">&quot;wb&quot;</span>))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>K optimal:  {&#39;n_neighbors&#39;: 5}
Akurasi pada data uji:  0.8363636363636363
</code></pre>
</div>
</div>
<div class="cell markdown"
data-cell_id="d772e708c4cb4c2882df0b97c4be5e12"
data-deepnote_app_block_visible="true"
data-deepnote_cell_type="text-cell-p"
data-formattedRanges="[{&quot;fromCodePoint&quot;:0,&quot;marks&quot;:{&quot;bold&quot;:true},&quot;toCodePoint&quot;:13,&quot;type&quot;:&quot;marks&quot;}]">
<p>KESIMPULAN : dari grafik diatas dapat disimpulkan bahwa nilai K yang
optimal adalah K=3</p>
</div>
<section id="menghitung-knn" class="cell markdown"
data-cell_id="c622dddf1aff432a9ae824a81bb6dbda"
data-deepnote_app_block_visible="true"
data-deepnote_cell_type="text-cell-h3" data-formattedRanges="[]">
<h3>Menghitung KNN</h3>
</section>
<div class="cell markdown"
data-cell_id="73a2db5c934740c69949f7418f4e9d68"
data-deepnote_app_block_visible="true"
data-deepnote_cell_type="text-cell-p" data-formattedRanges="[]">
<p>Setelah menormalisasi data, dan mengubah data categorical menjadi
data numeric, kini maka langkah selanjutnya adalah menghitung akurasi
KNN dengan nilai K yang telah dihitung</p>
</div>
<div class="cell code" data-cell_id="7fba03d56e4b41a9841a0a56b6f48c68"
data-deepnote_app_block_visible="true" data-deepnote_cell_type="code"
data-deepnote_to_be_reexecuted="true" data-execution_millis="248"
data-execution_start="1717629186246" data-source_hash="null">
<div class="sourceCode" id="cb24"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import library yang dibutuhkan</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> MinMaxScaler</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.neighbors <span class="im">import</span> KNeighborsClassifier</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> accuracy_score</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Membaca data dari file CSV</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> pd.read_csv(<span class="st">&#39;dataset_normalization.csv&#39;</span>)</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Memisahkan data menjadi fitur (X) dan target (y)</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> data.drop(<span class="st">&#39;target&#39;</span>, axis<span class="op">=</span><span class="dv">1</span>)  <span class="co"># Jika targetnya disebut &#39;target&#39;</span></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> data[<span class="st">&#39;target&#39;</span>]</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Normalisasi data menggunakan MinMaxScaler</span></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>scaler <span class="op">=</span> MinMaxScaler()</span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>X_scaled <span class="op">=</span> scaler.fit_transform(X)</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Membagi data menjadi data pelatihan dan data pengujian</span></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X_scaled, y, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Menginisialisasi model KNN</span></span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>knn <span class="op">=</span> KNeighborsClassifier(n_neighbors<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Melatih model KNN</span></span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a>knn.fit(X_train, y_train)</span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Melakukan prediksi dengan data pengujian</span></span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a>y_pred <span class="op">=</span> knn.predict(X_test)</span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Menghitung akurasi model</span></span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a>accuracy <span class="op">=</span> accuracy_score(y_test, y_pred)</span>
<span id="cb24-33"><a href="#cb24-33" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Akurasi model KNN:&quot;</span>, accuracy)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Akurasi model KNN: 0.8363636363636363
</code></pre>
</div>
</div>
<div class="cell markdown"
data-cell_id="846321cbe3fe46f1a4b25329a49c9721"
data-deepnote_app_block_visible="true"
data-deepnote_cell_type="text-cell-p"
data-formattedRanges="[{&quot;fromCodePoint&quot;:0,&quot;marks&quot;:{&quot;bold&quot;:true},&quot;toCodePoint&quot;:10,&quot;type&quot;:&quot;marks&quot;},{&quot;fromCodePoint&quot;:18,&quot;marks&quot;:{&quot;bold&quot;:true},&quot;toCodePoint&quot;:36,&quot;type&quot;:&quot;marks&quot;},{&quot;fromCodePoint&quot;:49,&quot;marks&quot;:{&quot;bold&quot;:true},&quot;toCodePoint&quot;:79,&quot;type&quot;:&quot;marks&quot;}]">
<p>KESIMPULAN: Nilai 0.8363636363636363 menunjukkan nilai akurasi dari
model K-NN pada dataset yang digunakan. Akurasi adalah ukuran seberapa
baik model dapat memprediksi kelas yang benar dari data uji yang belum
pernah dilihat sebelumnya. Semakin tinggi nilai output ini (mendekati
1), semakin baik model K-NN bekerja dalam memprediksi kelas yang
benar.</p>
</div>
<section id="stacking-ensemble" class="cell markdown"
data-cell_id="725b6413ef994f96a170be72bfb7e1fb"
data-deepnote_app_block_visible="true"
data-deepnote_cell_type="text-cell-h2" data-formattedRanges="[]">
<h2>Stacking Ensemble</h2>
</section>
<div class="cell markdown"
data-cell_id="50c75d4ee1924474a277f0e156ba1fca"
data-deepnote_app_block_visible="true"
data-deepnote_cell_type="text-cell-p" data-formattedRanges="[]">
<p>Stacking Ensemble adalah teknik machine learning yang menggabungkan
prediksi dari beberapa model dasar (base models) untuk membangun model
yang lebih kuat. Pendekatan ini melibatkan dua tingkat model: tingkat
pertama terdiri dari beberapa model dasar yang dilatih menggunakan data
pelatihan asli, dan tingkat kedua adalah model meta yang dilatih
menggunakan prediksi dari model dasar sebagai fitur.</p>
</div>
<div class="cell code" data-cell_id="3a3b3ed0472646f5b66a8d83842e780c"
data-deepnote_app_block_visible="true" data-deepnote_cell_type="code"
data-deepnote_to_be_reexecuted="true" data-execution_millis="3446"
data-execution_start="1717606998719" data-source_hash="null">
<div class="sourceCode" id="cb26"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>pip install scikit<span class="op">-</span>learn</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Requirement already satisfied: scikit-learn in /shared-libs/python3.9/py/lib/python3.9/site-packages (1.1.2)
Requirement already satisfied: numpy&gt;=1.17.3 in /shared-libs/python3.9/py/lib/python3.9/site-packages (from scikit-learn) (1.23.4)
Requirement already satisfied: joblib&gt;=1.0.0 in /shared-libs/python3.9/py/lib/python3.9/site-packages (from scikit-learn) (1.2.0)
Requirement already satisfied: threadpoolctl&gt;=2.0.0 in /shared-libs/python3.9/py/lib/python3.9/site-packages (from scikit-learn) (3.1.0)
Requirement already satisfied: scipy&gt;=1.3.2 in /shared-libs/python3.9/py/lib/python3.9/site-packages (from scikit-learn) (1.9.3)
WARNING: Running pip as the &#39;root&#39; user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv

[notice] A new release of pip is available: 23.0.1 -&gt; 24.0
[notice] To update, run: python -m pip install --upgrade pip
Note: you may need to restart the kernel to use updated packages.
</code></pre>
</div>
</div>
<div class="cell code" data-cell_id="14231016f678496eac819493bab83cd6"
data-deepnote_app_block_visible="true" data-deepnote_cell_type="code"
data-deepnote_to_be_reexecuted="true" data-execution_millis="3710"
data-execution_start="1717607110922" data-source_hash="null">
<div class="sourceCode" id="cb28"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip install mlxtend</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Collecting mlxtend
  Downloading mlxtend-0.23.1-py3-none-any.whl (1.4 MB)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 1.4/1.4 MB 47.2 MB/s eta 0:00:00
ent already satisfied: scipy&gt;=1.2.1 in /shared-libs/python3.9/py/lib/python3.9/site-packages (from mlxtend) (1.9.3)
Requirement already satisfied: numpy&gt;=1.16.2 in /shared-libs/python3.9/py/lib/python3.9/site-packages (from mlxtend) (1.23.4)
Requirement already satisfied: matplotlib&gt;=3.0.0 in /shared-libs/python3.9/py/lib/python3.9/site-packages (from mlxtend) (3.6.0)
Requirement already satisfied: scikit-learn&gt;=1.0.2 in /shared-libs/python3.9/py/lib/python3.9/site-packages (from mlxtend) (1.1.2)
Requirement already satisfied: pandas&gt;=0.24.2 in /shared-libs/python3.9/py/lib/python3.9/site-packages (from mlxtend) (2.1.4)
Requirement already satisfied: joblib&gt;=0.13.2 in /shared-libs/python3.9/py/lib/python3.9/site-packages (from mlxtend) (1.2.0)
Requirement already satisfied: contourpy&gt;=1.0.1 in /shared-libs/python3.9/py/lib/python3.9/site-packages (from matplotlib&gt;=3.0.0-&gt;mlxtend) (1.0.5)
Requirement already satisfied: pillow&gt;=6.2.0 in /shared-libs/python3.9/py/lib/python3.9/site-packages (from matplotlib&gt;=3.0.0-&gt;mlxtend) (9.2.0)
Requirement already satisfied: kiwisolver&gt;=1.0.1 in /shared-libs/python3.9/py/lib/python3.9/site-packages (from matplotlib&gt;=3.0.0-&gt;mlxtend) (1.4.4)
Requirement already satisfied: packaging&gt;=20.0 in /shared-libs/python3.9/py-core/lib/python3.9/site-packages (from matplotlib&gt;=3.0.0-&gt;mlxtend) (21.3)
Requirement already satisfied: python-dateutil&gt;=2.7 in /shared-libs/python3.9/py-core/lib/python3.9/site-packages (from matplotlib&gt;=3.0.0-&gt;mlxtend) (2.8.2)
Requirement already satisfied: cycler&gt;=0.10 in /shared-libs/python3.9/py/lib/python3.9/site-packages (from matplotlib&gt;=3.0.0-&gt;mlxtend) (0.11.0)
Requirement already satisfied: fonttools&gt;=4.22.0 in /shared-libs/python3.9/py/lib/python3.9/site-packages (from matplotlib&gt;=3.0.0-&gt;mlxtend) (4.37.4)
Requirement already satisfied: pyparsing&gt;=2.2.1 in /shared-libs/python3.9/py-core/lib/python3.9/site-packages (from matplotlib&gt;=3.0.0-&gt;mlxtend) (3.0.9)
Requirement already satisfied: tzdata&gt;=2022.1 in /shared-libs/python3.9/py/lib/python3.9/site-packages (from pandas&gt;=0.24.2-&gt;mlxtend) (2022.5)
Requirement already satisfied: pytz&gt;=2020.1 in /shared-libs/python3.9/py/lib/python3.9/site-packages (from pandas&gt;=0.24.2-&gt;mlxtend) (2022.5)
Requirement already satisfied: threadpoolctl&gt;=2.0.0 in /shared-libs/python3.9/py/lib/python3.9/site-packages (from scikit-learn&gt;=1.0.2-&gt;mlxtend) (3.1.0)
Requirement already satisfied: six&gt;=1.5 in /shared-libs/python3.9/py-core/lib/python3.9/site-packages (from python-dateutil&gt;=2.7-&gt;matplotlib&gt;=3.0.0-&gt;mlxtend) (1.16.0)
Installing collected packages: mlxtend
Successfully installed mlxtend-0.23.1

[notice] A new release of pip is available: 23.0.1 -&gt; 24.0
[notice] To update, run: pip install --upgrade pip
</code></pre>
</div>
</div>
<div class="cell code" data-cell_id="9ed63ec9d7214519aaa9550aa138db80"
data-deepnote_app_block_visible="true" data-deepnote_cell_type="code"
data-deepnote_to_be_reexecuted="true" data-execution_millis="365"
data-execution_start="1717607142707" data-source_hash="null">
<div class="sourceCode" id="cb30"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn <span class="im">import</span> model_selection</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LogisticRegression</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.neighbors <span class="im">import</span> KNeighborsClassifier</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.naive_bayes <span class="im">import</span> GaussianNB</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> RandomForestClassifier</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> mlxtend.classifier <span class="im">import</span> StackingClassifier</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>warnings.simplefilter(<span class="st">&#39;ignore&#39;</span>)</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the dataset</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> pd.read_csv(<span class="st">&#39;hd_training_80.csv&#39;</span>)</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Assuming the last column is the target variable</span></span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> data.iloc[:, :<span class="op">-</span><span class="dv">1</span>].values</span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> data.iloc[:, <span class="op">-</span><span class="dv">1</span>].values</span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the classifiers</span></span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>clf1 <span class="op">=</span> KNeighborsClassifier(n_neighbors<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>clf2 <span class="op">=</span>  KNeighborsClassifier(n_neighbors<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>lr <span class="op">=</span>  KNeighborsClassifier(n_neighbors<span class="op">=</span><span class="dv">4</span>)</span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a>sclf <span class="op">=</span> StackingClassifier(classifiers<span class="op">=</span>[clf1, clf2], meta_classifier<span class="op">=</span>lr)</span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;3-fold cross validation:</span><span class="ch">\n</span><span class="st">&#39;</span>)</span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> clf, label <span class="kw">in</span> <span class="bu">zip</span>([clf1, clf2,sclf], </span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a>                      [<span class="st">&#39;KNN K = 3&#39;</span>,  </span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&#39;KNN K = 5&#39;</span>,</span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&#39;StackingClassifier&#39;</span>]):</span>
<span id="cb30-31"><a href="#cb30-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-32"><a href="#cb30-32" aria-hidden="true" tabindex="-1"></a>    scores <span class="op">=</span> model_selection.cross_val_score(clf, X, y, </span>
<span id="cb30-33"><a href="#cb30-33" aria-hidden="true" tabindex="-1"></a>                                             cv<span class="op">=</span><span class="dv">3</span>, scoring<span class="op">=</span><span class="st">&#39;accuracy&#39;</span>)</span>
<span id="cb30-34"><a href="#cb30-34" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;Accuracy: </span><span class="sc">%0.2f</span><span class="st"> (+/- </span><span class="sc">%0.2f</span><span class="st">) [</span><span class="sc">%s</span><span class="st">]&quot;</span> </span>
<span id="cb30-35"><a href="#cb30-35" aria-hidden="true" tabindex="-1"></a>          <span class="op">%</span> (scores.mean(), scores.std(), label))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>3-fold cross validation:

Accuracy: 0.65 (+/- 0.02) [KNN K = 3]
Accuracy: 0.59 (+/- 0.01) [KNN K = 5]
Accuracy: 0.62 (+/- 0.03) [StackingClassifier]
</code></pre>
</div>
</div>
<section id="data-training" class="cell markdown"
data-cell_id="31be2d45b7674a93af98ef6f36df1aeb"
data-deepnote_app_block_visible="true"
data-deepnote_cell_type="text-cell-h3" data-formattedRanges="[]">
<h3>Data Training</h3>
</section>
<div class="cell markdown"
data-cell_id="063db1866b044febb0d891b38b8055fc"
data-deepnote_app_block_visible="true"
data-deepnote_cell_type="text-cell-p"
data-formattedRanges="[{&quot;fromCodePoint&quot;:0,&quot;marks&quot;:{&quot;bold&quot;:true},&quot;toCodePoint&quot;:22,&quot;type&quot;:&quot;marks&quot;}]">
<p>k=3 untuk model dasar:</p>
</div>
<div class="cell markdown"
data-cell_id="7b7608e5beae4977b0170bde2f50ef02"
data-deepnote_app_block_visible="true"
data-deepnote_cell_type="text-cell-p" data-formattedRanges="[]">
<p>Bagi data menjadi 3 bagian (fold). Latih model dasar pada 2 fold dan
validasi pada 1 fold. Ulangi untuk setiap fold. Kumpulkan prediksi dari
model dasar untuk membuat dataset baru.</p>
</div>
<div class="cell markdown"
data-cell_id="e7119b6510e04fdfb61753d60d837371"
data-deepnote_app_block_visible="true"
data-deepnote_cell_type="text-cell-p"
data-formattedRanges="[{&quot;fromCodePoint&quot;:1,&quot;marks&quot;:{&quot;bold&quot;:true},&quot;toCodePoint&quot;:23,&quot;type&quot;:&quot;marks&quot;}]">
<p>k=5 untuk model dasar:</p>
</div>
<div class="cell markdown"
data-cell_id="a8a3981e1cbf4e508ec9f640053e05cd"
data-deepnote_app_block_visible="true"
data-deepnote_cell_type="text-cell-p" data-formattedRanges="[]">
<p>Bagi data menjadi 5 bagian (fold). Latih model dasar pada 4 fold dan
validasi pada 1 fold. Ulangi untuk setiap fold. Kumpulkan prediksi dari
model dasar untuk membuat dataset baru.</p>
</div>
<div class="cell markdown"
data-cell_id="0ddfa586425d43aabda72836a12469a6"
data-deepnote_app_block_visible="true"
data-deepnote_cell_type="text-cell-p"
data-formattedRanges="[{&quot;fromCodePoint&quot;:1,&quot;marks&quot;:{&quot;bold&quot;:true},&quot;toCodePoint&quot;:27,&quot;type&quot;:&quot;marks&quot;}]">
<p>Meta k=7 untuk model meta:</p>
</div>
<div class="cell markdown"
data-cell_id="39f0b6c225c94873a8c1c059593f8e07"
data-deepnote_app_block_visible="true"
data-deepnote_cell_type="text-cell-p" data-formattedRanges="[]">
<p>Bagi dataset baru (prediksi dari model dasar) menjadi 7 bagian
(fold). Latih model meta pada 6 fold dan validasi pada 1 fold. Ulangi
untuk setiap fold.</p>
</div>
<div class="cell markdown"
data-cell_id="6e5481300af245d7a9ea497976414ca9"
data-deepnote_app_block_visible="true"
data-deepnote_cell_type="text-cell-p" data-formattedRanges="[]">
<p>Berikut adalah progrram untuk enseble stacking menggunakan knn:</p>
</div>
<div class="cell markdown"
data-cell_id="1e8d1ddb8c694c4bbff2fd50dc302359"
data-deepnote_app_block_visible="true"
data-deepnote_cell_type="text-cell-p"
data-formattedRanges="[{&quot;fromCodePoint&quot;:0,&quot;marks&quot;:{&quot;bold&quot;:true},&quot;toCodePoint&quot;:33,&quot;type&quot;:&quot;marks&quot;}]">
<p>PREDIKSI MENGGUNAKAN KNN K=3, K=5</p>
</div>
<div class="cell code" data-cell_id="92549071290341dcb5e040f77bfed4ad"
data-deepnote_app_block_visible="true" data-deepnote_cell_type="code"
data-deepnote_to_be_reexecuted="true" data-execution_millis="634"
data-execution_start="1717607317359" data-source_hash="null">
<div class="sourceCode" id="cb32"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import library yang dibutuhkan</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> IPython.display <span class="im">import</span> display</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> MinMaxScaler</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.neighbors <span class="im">import</span> KNeighborsClassifier</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Membaca data dari file CSV</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> pd.read_csv(<span class="st">&#39;dataset_normalization.csv&#39;</span>)</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Memisahkan data menjadi fitur (X) dan target (y)</span></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> data.drop(<span class="st">&#39;target&#39;</span>, axis<span class="op">=</span><span class="dv">1</span>)  <span class="co"># Jika targetnya disebut &#39;target&#39;</span></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> data[<span class="st">&#39;target&#39;</span>]</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Normalisasi data menggunakan MinMaxScaler</span></span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>scaler <span class="op">=</span> MinMaxScaler()</span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>X_scaled <span class="op">=</span> scaler.fit_transform(X)</span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Membagi data menjadi data pelatihan dan data pengujian</span></span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X_scaled, y, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Menampilkan data awal</span></span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Data Awal:&quot;</span>)</span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>display(data.head())</span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Menampilkan data yang telah dinormalisasi</span></span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a>X_scaled_df <span class="op">=</span> pd.DataFrame(X_scaled, columns<span class="op">=</span>X.columns)</span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Data yang telah dinormalisasi:&quot;</span>)</span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a>display(X_scaled_df.head())</span>
<span id="cb32-30"><a href="#cb32-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-31"><a href="#cb32-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Menampilkan data pelatihan dan pengujian</span></span>
<span id="cb32-32"><a href="#cb32-32" aria-hidden="true" tabindex="-1"></a>X_train_df <span class="op">=</span> pd.DataFrame(X_train, columns<span class="op">=</span>X.columns)</span>
<span id="cb32-33"><a href="#cb32-33" aria-hidden="true" tabindex="-1"></a>X_test_df <span class="op">=</span> pd.DataFrame(X_test, columns<span class="op">=</span>X.columns)</span>
<span id="cb32-34"><a href="#cb32-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-35"><a href="#cb32-35" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Data Pelatihan:&quot;</span>)</span>
<span id="cb32-36"><a href="#cb32-36" aria-hidden="true" tabindex="-1"></a>display(X_train_df.head())</span>
<span id="cb32-37"><a href="#cb32-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-38"><a href="#cb32-38" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Data Pengujian:&quot;</span>)</span>
<span id="cb32-39"><a href="#cb32-39" aria-hidden="true" tabindex="-1"></a>display(X_test_df.head())</span>
<span id="cb32-40"><a href="#cb32-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-41"><a href="#cb32-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Melatih model KNN dengan k=3 dan k=5</span></span>
<span id="cb32-42"><a href="#cb32-42" aria-hidden="true" tabindex="-1"></a>knn_3 <span class="op">=</span> KNeighborsClassifier(n_neighbors<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb32-43"><a href="#cb32-43" aria-hidden="true" tabindex="-1"></a>knn_5 <span class="op">=</span> KNeighborsClassifier(n_neighbors<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb32-44"><a href="#cb32-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-45"><a href="#cb32-45" aria-hidden="true" tabindex="-1"></a>knn_3.fit(X_train, y_train)</span>
<span id="cb32-46"><a href="#cb32-46" aria-hidden="true" tabindex="-1"></a>knn_5.fit(X_train, y_train)</span>
<span id="cb32-47"><a href="#cb32-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-48"><a href="#cb32-48" aria-hidden="true" tabindex="-1"></a><span class="co"># Membuat prediksi untuk data pelatihan</span></span>
<span id="cb32-49"><a href="#cb32-49" aria-hidden="true" tabindex="-1"></a>knn_3_predictions <span class="op">=</span> knn_3.predict(X_train)</span>
<span id="cb32-50"><a href="#cb32-50" aria-hidden="true" tabindex="-1"></a>knn_5_predictions <span class="op">=</span> knn_5.predict(X_train)</span>
<span id="cb32-51"><a href="#cb32-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-52"><a href="#cb32-52" aria-hidden="true" tabindex="-1"></a><span class="co"># Membuat DataFrame yang terdiri dari X_train, prediksi KNN k=3, prediksi KNN k=5, dan y_train</span></span>
<span id="cb32-53"><a href="#cb32-53" aria-hidden="true" tabindex="-1"></a>hd_training_80 <span class="op">=</span> X_train_df.copy()</span>
<span id="cb32-54"><a href="#cb32-54" aria-hidden="true" tabindex="-1"></a>hd_training_80[<span class="st">&#39;knn_k3&#39;</span>] <span class="op">=</span> knn_3_predictions</span>
<span id="cb32-55"><a href="#cb32-55" aria-hidden="true" tabindex="-1"></a>hd_training_80[<span class="st">&#39;knn_k5&#39;</span>] <span class="op">=</span> knn_5_predictions</span>
<span id="cb32-56"><a href="#cb32-56" aria-hidden="true" tabindex="-1"></a>hd_training_80[<span class="st">&#39;y_train&#39;</span>] <span class="op">=</span> y_train.values</span>
<span id="cb32-57"><a href="#cb32-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-58"><a href="#cb32-58" aria-hidden="true" tabindex="-1"></a><span class="co"># Menampilkan DataFrame hd_training_80</span></span>
<span id="cb32-59"><a href="#cb32-59" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Data Pelatihan dengan Prediksi KNN:&quot;</span>)</span>
<span id="cb32-60"><a href="#cb32-60" aria-hidden="true" tabindex="-1"></a>display(hd_training_80.head())</span>
<span id="cb32-61"><a href="#cb32-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-62"><a href="#cb32-62" aria-hidden="true" tabindex="-1"></a><span class="co"># Menyimpan DataFrame ke file CSV</span></span>
<span id="cb32-63"><a href="#cb32-63" aria-hidden="true" tabindex="-1"></a><span class="co"># hd_training_80.to_csv(&#39;hd_training_80.csv&#39;, index=False)</span></span>
<span id="cb32-64"><a href="#cb32-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-65"><a href="#cb32-65" aria-hidden="true" tabindex="-1"></a><span class="co"># Menampilkan pesan konfirmasi</span></span>
<span id="cb32-66"><a href="#cb32-66" aria-hidden="true" tabindex="-1"></a><span class="co"># print(&quot;\nFile hd_training_80.csv telah disimpan.&quot;)</span></span></code></pre></div>
<div class="output stream stdout">
<pre><code>Data Awal:
</code></pre>
</div>
<div class="output display_data">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>sex</th>
      <th>cp</th>
      <th>trestbps</th>
      <th>chol</th>
      <th>fbs</th>
      <th>restecg</th>
      <th>thalach</th>
      <th>exang</th>
      <th>oldpeak</th>
      <th>slope</th>
      <th>ca</th>
      <th>thal</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>63</td>
      <td>1</td>
      <td>1.000000</td>
      <td>145</td>
      <td>233</td>
      <td>1</td>
      <td>0.0</td>
      <td>150</td>
      <td>0</td>
      <td>2.3</td>
      <td>0.0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>37</td>
      <td>1</td>
      <td>0.666667</td>
      <td>130</td>
      <td>250</td>
      <td>0</td>
      <td>0.5</td>
      <td>187</td>
      <td>0</td>
      <td>3.5</td>
      <td>0.0</td>
      <td>0</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>41</td>
      <td>0</td>
      <td>0.333333</td>
      <td>130</td>
      <td>204</td>
      <td>0</td>
      <td>0.0</td>
      <td>172</td>
      <td>0</td>
      <td>1.4</td>
      <td>1.0</td>
      <td>0</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>56</td>
      <td>1</td>
      <td>0.333333</td>
      <td>120</td>
      <td>236</td>
      <td>0</td>
      <td>0.5</td>
      <td>178</td>
      <td>0</td>
      <td>0.8</td>
      <td>1.0</td>
      <td>0</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>57</td>
      <td>1</td>
      <td>0.000000</td>
      <td>140</td>
      <td>192</td>
      <td>0</td>
      <td>0.5</td>
      <td>148</td>
      <td>0</td>
      <td>0.4</td>
      <td>0.5</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
</div>
<div class="output stream stdout">
<pre><code>
Data yang telah dinormalisasi:
</code></pre>
</div>
<div class="output display_data">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>sex</th>
      <th>cp</th>
      <th>trestbps</th>
      <th>chol</th>
      <th>fbs</th>
      <th>restecg</th>
      <th>thalach</th>
      <th>exang</th>
      <th>oldpeak</th>
      <th>slope</th>
      <th>ca</th>
      <th>thal</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.708333</td>
      <td>1.0</td>
      <td>1.000000</td>
      <td>0.481132</td>
      <td>0.387755</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.543860</td>
      <td>0.0</td>
      <td>0.370968</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.333333</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.166667</td>
      <td>1.0</td>
      <td>0.666667</td>
      <td>0.339623</td>
      <td>0.474490</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>0.868421</td>
      <td>0.0</td>
      <td>0.564516</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.666667</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.250000</td>
      <td>0.0</td>
      <td>0.333333</td>
      <td>0.339623</td>
      <td>0.239796</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.736842</td>
      <td>0.0</td>
      <td>0.225806</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.666667</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.562500</td>
      <td>1.0</td>
      <td>0.333333</td>
      <td>0.245283</td>
      <td>0.403061</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>0.789474</td>
      <td>0.0</td>
      <td>0.129032</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.666667</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.583333</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>0.433962</td>
      <td>0.178571</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>0.526316</td>
      <td>0.0</td>
      <td>0.064516</td>
      <td>0.5</td>
      <td>0.0</td>
      <td>0.333333</td>
    </tr>
  </tbody>
</table>
</div>
</div>
<div class="output stream stdout">
<pre><code>
Data Pelatihan:
</code></pre>
</div>
<div class="output display_data">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>sex</th>
      <th>cp</th>
      <th>trestbps</th>
      <th>chol</th>
      <th>fbs</th>
      <th>restecg</th>
      <th>thalach</th>
      <th>exang</th>
      <th>oldpeak</th>
      <th>slope</th>
      <th>ca</th>
      <th>thal</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.354167</td>
      <td>0.0</td>
      <td>0.666667</td>
      <td>0.452830</td>
      <td>0.102041</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.631579</td>
      <td>1.0</td>
      <td>0.225806</td>
      <td>0.0</td>
      <td>0.00</td>
      <td>0.666667</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.687500</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.622642</td>
      <td>0.035714</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.500000</td>
      <td>0.0</td>
      <td>1.000000</td>
      <td>0.0</td>
      <td>0.75</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.562500</td>
      <td>1.0</td>
      <td>0.333333</td>
      <td>0.245283</td>
      <td>0.423469</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>0.710526</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.00</td>
      <td>0.666667</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.708333</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>0.339623</td>
      <td>0.882653</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.385965</td>
      <td>1.0</td>
      <td>0.290323</td>
      <td>1.0</td>
      <td>0.75</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.458333</td>
      <td>0.0</td>
      <td>0.666667</td>
      <td>0.433962</td>
      <td>0.770408</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.473684</td>
      <td>0.0</td>
      <td>0.241935</td>
      <td>1.0</td>
      <td>0.25</td>
      <td>0.666667</td>
    </tr>
  </tbody>
</table>
</div>
</div>
<div class="output stream stdout">
<pre><code>
Data Pengujian:
</code></pre>
</div>
<div class="output display_data">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>sex</th>
      <th>cp</th>
      <th>trestbps</th>
      <th>chol</th>
      <th>fbs</th>
      <th>restecg</th>
      <th>thalach</th>
      <th>exang</th>
      <th>oldpeak</th>
      <th>slope</th>
      <th>ca</th>
      <th>thal</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.312500</td>
      <td>1.0</td>
      <td>0.333333</td>
      <td>0.339623</td>
      <td>0.316327</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.877193</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.00</td>
      <td>0.666667</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.250000</td>
      <td>1.0</td>
      <td>0.333333</td>
      <td>0.150943</td>
      <td>0.397959</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>0.570175</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.00</td>
      <td>0.666667</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.812500</td>
      <td>1.0</td>
      <td>0.666667</td>
      <td>0.226415</td>
      <td>0.612245</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>0.552632</td>
      <td>0.0</td>
      <td>0.161290</td>
      <td>1.0</td>
      <td>0.25</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.979167</td>
      <td>0.0</td>
      <td>0.666667</td>
      <td>0.433962</td>
      <td>0.204082</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.245614</td>
      <td>0.0</td>
      <td>0.177419</td>
      <td>0.5</td>
      <td>0.00</td>
      <td>0.666667</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.687500</td>
      <td>0.0</td>
      <td>0.666667</td>
      <td>0.339623</td>
      <td>0.540816</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>0.078947</td>
      <td>0.0</td>
      <td>0.193548</td>
      <td>0.5</td>
      <td>0.25</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div>
</div>
<div class="output stream stdout">
<pre><code>
Data Pelatihan dengan Prediksi KNN:
</code></pre>
</div>
<div class="output display_data">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>sex</th>
      <th>cp</th>
      <th>trestbps</th>
      <th>chol</th>
      <th>fbs</th>
      <th>restecg</th>
      <th>thalach</th>
      <th>exang</th>
      <th>oldpeak</th>
      <th>slope</th>
      <th>ca</th>
      <th>thal</th>
      <th>knn_k3</th>
      <th>knn_k5</th>
      <th>y_train</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.354167</td>
      <td>0.0</td>
      <td>0.666667</td>
      <td>0.452830</td>
      <td>0.102041</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.631579</td>
      <td>1.0</td>
      <td>0.225806</td>
      <td>0.0</td>
      <td>0.00</td>
      <td>0.666667</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.687500</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.622642</td>
      <td>0.035714</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.500000</td>
      <td>0.0</td>
      <td>1.000000</td>
      <td>0.0</td>
      <td>0.75</td>
      <td>1.000000</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.562500</td>
      <td>1.0</td>
      <td>0.333333</td>
      <td>0.245283</td>
      <td>0.423469</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>0.710526</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.00</td>
      <td>0.666667</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.708333</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>0.339623</td>
      <td>0.882653</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.385965</td>
      <td>1.0</td>
      <td>0.290323</td>
      <td>1.0</td>
      <td>0.75</td>
      <td>1.000000</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.458333</td>
      <td>0.0</td>
      <td>0.666667</td>
      <td>0.433962</td>
      <td>0.770408</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.473684</td>
      <td>0.0</td>
      <td>0.241935</td>
      <td>1.0</td>
      <td>0.25</td>
      <td>0.666667</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell markdown"
data-cell_id="1532584aeb044d9eb36842f2819de35e"
data-deepnote_app_block_visible="true"
data-deepnote_cell_type="text-cell-p"
data-formattedRanges="[{&quot;fromCodePoint&quot;:0,&quot;marks&quot;:{&quot;bold&quot;:true},&quot;toCodePoint&quot;:12,&quot;type&quot;:&quot;marks&quot;}]">
<p>KESIMPULAN: pada tabel Data Pelatihan dengan Prediksi KNN, kolom
knn_k3 dan knn_k5 sebagai x_train dan diprediksi targetnya (menghasilkan
prediksi dari K=3 dan prediksi dari k=5)dan y_train adalah target asli
dari dataset</p>
</div>
<div class="cell markdown"
data-cell_id="63935139fbcd4cee8b4875200321dcd8"
data-deepnote_app_block_visible="true"
data-deepnote_cell_type="text-cell-p"
data-formattedRanges="[{&quot;fromCodePoint&quot;:0,&quot;marks&quot;:{&quot;bold&quot;:true},&quot;toCodePoint&quot;:8,&quot;type&quot;:&quot;marks&quot;}]">
<p>META K=7</p>
</div>
<div class="cell code" data-cell_id="74fee33080164bbc8d243619f8388653"
data-deepnote_app_block_visible="true" data-deepnote_cell_type="code"
data-deepnote_to_be_reexecuted="true" data-execution_millis="451"
data-execution_start="1717608055754" data-source_hash="null">
<div class="sourceCode" id="cb38"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import library yang dibutuhkan</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> IPython.display <span class="im">import</span> display</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> MinMaxScaler</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.neighbors <span class="im">import</span> KNeighborsClassifier</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Membaca data dari file CSV</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> pd.read_csv(<span class="st">&#39;hd_training_80.csv&#39;</span>)</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Memisahkan data menjadi fitur (X) dan target (y)</span></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> data.drop(<span class="st">&#39;target&#39;</span>, axis<span class="op">=</span><span class="dv">1</span>)  <span class="co"># Jika targetnya disebut &#39;target&#39;</span></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> data[<span class="st">&#39;target&#39;</span>]</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Normalisasi data menggunakan MinMaxScaler</span></span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>scaler <span class="op">=</span> MinMaxScaler()</span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>X_scaled <span class="op">=</span> scaler.fit_transform(X)</span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Membagi data menjadi data pelatihan dan data pengujian</span></span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X_scaled, y, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Menampilkan data awal</span></span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Data Awal:&quot;</span>)</span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a>display(data.head())</span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-26"><a href="#cb38-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Menampilkan data yang telah dinormalisasi</span></span>
<span id="cb38-27"><a href="#cb38-27" aria-hidden="true" tabindex="-1"></a>X_scaled_df <span class="op">=</span> pd.DataFrame(X_scaled, columns<span class="op">=</span>X.columns)</span>
<span id="cb38-28"><a href="#cb38-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Data yang telah dinormalisasi:&quot;</span>)</span>
<span id="cb38-29"><a href="#cb38-29" aria-hidden="true" tabindex="-1"></a>display(X_scaled_df.head())</span>
<span id="cb38-30"><a href="#cb38-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-31"><a href="#cb38-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Menampilkan data pelatihan dan pengujian</span></span>
<span id="cb38-32"><a href="#cb38-32" aria-hidden="true" tabindex="-1"></a>X_train_df <span class="op">=</span> pd.DataFrame(X_train, columns<span class="op">=</span>X.columns)</span>
<span id="cb38-33"><a href="#cb38-33" aria-hidden="true" tabindex="-1"></a>X_test_df <span class="op">=</span> pd.DataFrame(X_test, columns<span class="op">=</span>X.columns)</span>
<span id="cb38-34"><a href="#cb38-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-35"><a href="#cb38-35" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Data Pelatihan:&quot;</span>)</span>
<span id="cb38-36"><a href="#cb38-36" aria-hidden="true" tabindex="-1"></a>display(X_train_df.head())</span>
<span id="cb38-37"><a href="#cb38-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-38"><a href="#cb38-38" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Data Pengujian:&quot;</span>)</span>
<span id="cb38-39"><a href="#cb38-39" aria-hidden="true" tabindex="-1"></a>display(X_test_df.head())</span>
<span id="cb38-40"><a href="#cb38-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-41"><a href="#cb38-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Melatih model KNN dengan k=7</span></span>
<span id="cb38-42"><a href="#cb38-42" aria-hidden="true" tabindex="-1"></a>knn_7 <span class="op">=</span> KNeighborsClassifier(n_neighbors<span class="op">=</span><span class="dv">7</span>)</span>
<span id="cb38-43"><a href="#cb38-43" aria-hidden="true" tabindex="-1"></a>knn_7.fit(X_train, y_train)</span>
<span id="cb38-44"><a href="#cb38-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-45"><a href="#cb38-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Membuat prediksi untuk data pelatihan dengan k=7</span></span>
<span id="cb38-46"><a href="#cb38-46" aria-hidden="true" tabindex="-1"></a>knn_7_predictions <span class="op">=</span> knn_7.predict(X_train)</span>
<span id="cb38-47"><a href="#cb38-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-48"><a href="#cb38-48" aria-hidden="true" tabindex="-1"></a><span class="co"># Membuat DataFrame yang terdiri dari X_train, prediksi KNN k=7, dan y_train</span></span>
<span id="cb38-49"><a href="#cb38-49" aria-hidden="true" tabindex="-1"></a>hd_meta <span class="op">=</span> X_train_df.copy()</span>
<span id="cb38-50"><a href="#cb38-50" aria-hidden="true" tabindex="-1"></a>hd_meta[<span class="st">&#39;knn_k7&#39;</span>] <span class="op">=</span> knn_7_predictions</span>
<span id="cb38-51"><a href="#cb38-51" aria-hidden="true" tabindex="-1"></a>hd_meta[<span class="st">&#39;y_train&#39;</span>] <span class="op">=</span> y_train.values</span>
<span id="cb38-52"><a href="#cb38-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-53"><a href="#cb38-53" aria-hidden="true" tabindex="-1"></a><span class="co"># Menampilkan DataFrame hd_meta</span></span>
<span id="cb38-54"><a href="#cb38-54" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Data Pelatihan dengan Prediksi KNN k=7:&quot;</span>)</span>
<span id="cb38-55"><a href="#cb38-55" aria-hidden="true" tabindex="-1"></a>display(hd_meta.head())</span>
<span id="cb38-56"><a href="#cb38-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-57"><a href="#cb38-57" aria-hidden="true" tabindex="-1"></a><span class="co"># Menyimpan DataFrame ke file CSV</span></span>
<span id="cb38-58"><a href="#cb38-58" aria-hidden="true" tabindex="-1"></a><span class="co"># hd_meta.to_csv(&#39;hd_meta.csv&#39;, index=False)</span></span>
<span id="cb38-59"><a href="#cb38-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-60"><a href="#cb38-60" aria-hidden="true" tabindex="-1"></a><span class="co"># # Menampilkan pesan konfirmasi</span></span>
<span id="cb38-61"><a href="#cb38-61" aria-hidden="true" tabindex="-1"></a><span class="co"># print(&quot;\nFile hd_meta.csv telah disimpan.&quot;)</span></span></code></pre></div>
<div class="output stream stdout">
<pre><code>Data Awal:
</code></pre>
</div>
<div class="output display_data">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>sex</th>
      <th>cp</th>
      <th>trestbps</th>
      <th>chol</th>
      <th>fbs</th>
      <th>restecg</th>
      <th>thalach</th>
      <th>exang</th>
      <th>oldpeak</th>
      <th>slope</th>
      <th>ca</th>
      <th>thal</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>46</td>
      <td>0</td>
      <td>0.666667</td>
      <td>142</td>
      <td>177</td>
      <td>0</td>
      <td>0.0</td>
      <td>160</td>
      <td>1</td>
      <td>1.4</td>
      <td>0.0</td>
      <td>0</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>62</td>
      <td>0</td>
      <td>0.000000</td>
      <td>160</td>
      <td>164</td>
      <td>0</td>
      <td>0.0</td>
      <td>145</td>
      <td>0</td>
      <td>6.2</td>
      <td>0.0</td>
      <td>3</td>
      <td>3</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>56</td>
      <td>1</td>
      <td>0.333333</td>
      <td>120</td>
      <td>240</td>
      <td>0</td>
      <td>0.5</td>
      <td>169</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>63</td>
      <td>1</td>
      <td>0.000000</td>
      <td>130</td>
      <td>330</td>
      <td>1</td>
      <td>0.0</td>
      <td>132</td>
      <td>1</td>
      <td>1.8</td>
      <td>1.0</td>
      <td>3</td>
      <td>3</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>51</td>
      <td>0</td>
      <td>0.666667</td>
      <td>140</td>
      <td>308</td>
      <td>0</td>
      <td>0.0</td>
      <td>142</td>
      <td>0</td>
      <td>1.5</td>
      <td>1.0</td>
      <td>1</td>
      <td>2</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
</div>
<div class="output stream stdout">
<pre><code>
Data yang telah dinormalisasi:
</code></pre>
</div>
<div class="output display_data">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>sex</th>
      <th>cp</th>
      <th>trestbps</th>
      <th>chol</th>
      <th>fbs</th>
      <th>restecg</th>
      <th>thalach</th>
      <th>exang</th>
      <th>oldpeak</th>
      <th>slope</th>
      <th>ca</th>
      <th>thal</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.279070</td>
      <td>0.0</td>
      <td>0.666667</td>
      <td>0.452830</td>
      <td>0.068783</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.679245</td>
      <td>1.0</td>
      <td>0.225806</td>
      <td>0.0</td>
      <td>0.00</td>
      <td>0.666667</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.651163</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.622642</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.537736</td>
      <td>0.0</td>
      <td>1.000000</td>
      <td>0.0</td>
      <td>0.75</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.511628</td>
      <td>1.0</td>
      <td>0.333333</td>
      <td>0.245283</td>
      <td>0.402116</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>0.764151</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.00</td>
      <td>0.666667</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.674419</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>0.339623</td>
      <td>0.878307</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.415094</td>
      <td>1.0</td>
      <td>0.290323</td>
      <td>1.0</td>
      <td>0.75</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.395349</td>
      <td>0.0</td>
      <td>0.666667</td>
      <td>0.433962</td>
      <td>0.761905</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.509434</td>
      <td>0.0</td>
      <td>0.241935</td>
      <td>1.0</td>
      <td>0.25</td>
      <td>0.666667</td>
    </tr>
  </tbody>
</table>
</div>
</div>
<div class="output stream stdout">
<pre><code>
Data Pelatihan:
</code></pre>
</div>
<div class="output display_data">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>sex</th>
      <th>cp</th>
      <th>trestbps</th>
      <th>chol</th>
      <th>fbs</th>
      <th>restecg</th>
      <th>thalach</th>
      <th>exang</th>
      <th>oldpeak</th>
      <th>slope</th>
      <th>ca</th>
      <th>thal</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.395349</td>
      <td>1.0</td>
      <td>0.666667</td>
      <td>0.150943</td>
      <td>0.058201</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>0.330189</td>
      <td>0.0</td>
      <td>0.096774</td>
      <td>1.0</td>
      <td>0.00</td>
      <td>0.666667</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.395349</td>
      <td>1.0</td>
      <td>0.666667</td>
      <td>0.056604</td>
      <td>0.306878</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>0.518868</td>
      <td>1.0</td>
      <td>0.193548</td>
      <td>0.5</td>
      <td>0.00</td>
      <td>0.666667</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.232558</td>
      <td>1.0</td>
      <td>0.666667</td>
      <td>0.433962</td>
      <td>0.375661</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.867925</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.00</td>
      <td>0.666667</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.348837</td>
      <td>1.0</td>
      <td>0.666667</td>
      <td>0.245283</td>
      <td>0.126984</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>0.481132</td>
      <td>0.0</td>
      <td>0.322581</td>
      <td>0.5</td>
      <td>0.75</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.511628</td>
      <td>1.0</td>
      <td>0.333333</td>
      <td>0.339623</td>
      <td>0.301587</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.707547</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.00</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div>
</div>
<div class="output stream stdout">
<pre><code>
Data Pengujian:
</code></pre>
</div>
<div class="output display_data">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>sex</th>
      <th>cp</th>
      <th>trestbps</th>
      <th>chol</th>
      <th>fbs</th>
      <th>restecg</th>
      <th>thalach</th>
      <th>exang</th>
      <th>oldpeak</th>
      <th>slope</th>
      <th>ca</th>
      <th>thal</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.511628</td>
      <td>1.0</td>
      <td>0.666667</td>
      <td>0.339623</td>
      <td>0.486772</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.509434</td>
      <td>1.0</td>
      <td>0.096774</td>
      <td>0.5</td>
      <td>0.25</td>
      <td>0.333333</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.581395</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>0.415094</td>
      <td>0.566138</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.886792</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.00</td>
      <td>0.666667</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.093023</td>
      <td>1.0</td>
      <td>0.666667</td>
      <td>0.415094</td>
      <td>0.058201</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>0.801887</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>1.00</td>
      <td>0.666667</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.232558</td>
      <td>1.0</td>
      <td>0.333333</td>
      <td>0.245283</td>
      <td>0.296296</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>0.773585</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.00</td>
      <td>0.666667</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.813953</td>
      <td>0.0</td>
      <td>1.000000</td>
      <td>0.433962</td>
      <td>0.396825</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>0.594340</td>
      <td>0.0</td>
      <td>0.290323</td>
      <td>1.0</td>
      <td>0.50</td>
      <td>0.666667</td>
    </tr>
  </tbody>
</table>
</div>
</div>
<div class="output stream stdout">
<pre><code>
Data Pelatihan dengan Prediksi KNN k=7:
</code></pre>
</div>
<div class="output display_data">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>sex</th>
      <th>cp</th>
      <th>trestbps</th>
      <th>chol</th>
      <th>fbs</th>
      <th>restecg</th>
      <th>thalach</th>
      <th>exang</th>
      <th>oldpeak</th>
      <th>slope</th>
      <th>ca</th>
      <th>thal</th>
      <th>knn_k7</th>
      <th>y_train</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.395349</td>
      <td>1.0</td>
      <td>0.666667</td>
      <td>0.150943</td>
      <td>0.058201</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>0.330189</td>
      <td>0.0</td>
      <td>0.096774</td>
      <td>1.0</td>
      <td>0.00</td>
      <td>0.666667</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.395349</td>
      <td>1.0</td>
      <td>0.666667</td>
      <td>0.056604</td>
      <td>0.306878</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>0.518868</td>
      <td>1.0</td>
      <td>0.193548</td>
      <td>0.5</td>
      <td>0.00</td>
      <td>0.666667</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.232558</td>
      <td>1.0</td>
      <td>0.666667</td>
      <td>0.433962</td>
      <td>0.375661</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.867925</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.00</td>
      <td>0.666667</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.348837</td>
      <td>1.0</td>
      <td>0.666667</td>
      <td>0.245283</td>
      <td>0.126984</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>0.481132</td>
      <td>0.0</td>
      <td>0.322581</td>
      <td>0.5</td>
      <td>0.75</td>
      <td>1.000000</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.511628</td>
      <td>1.0</td>
      <td>0.333333</td>
      <td>0.339623</td>
      <td>0.301587</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.707547</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.00</td>
      <td>1.000000</td>
      <td>1</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<section id="data-testing" class="cell markdown"
data-cell_id="531f9e2502af498ab7121c72e8672e8c"
data-deepnote_app_block_visible="true"
data-deepnote_cell_type="text-cell-h3" data-formattedRanges="[]"
data-is_collapsed="false">
<h3>Data Testing</h3>
</section>
<div class="cell code" data-cell_id="cfad8e4b1f604c28bb17cb534d444c1b"
data-deepnote_app_block_visible="true" data-deepnote_cell_type="code"
data-deepnote_to_be_reexecuted="true" data-execution_millis="563"
data-execution_start="1717608139843" data-source_hash="null">
<div class="sourceCode" id="cb44"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import library yang dibutuhkan</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> IPython.display <span class="im">import</span> display</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> MinMaxScaler</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.neighbors <span class="im">import</span> KNeighborsClassifier</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Membaca data dari file CSV</span></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> pd.read_csv(<span class="st">&#39;hd_training_80.csv&#39;</span>)</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Memisahkan data menjadi fitur (X) dan target (y)</span></span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> data.drop(<span class="st">&#39;target&#39;</span>, axis<span class="op">=</span><span class="dv">1</span>)  <span class="co"># Jika targetnya disebut &#39;target&#39;</span></span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> data[<span class="st">&#39;target&#39;</span>]</span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Normalisasi data menggunakan MinMaxScaler</span></span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a>scaler <span class="op">=</span> MinMaxScaler()</span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a>X_scaled <span class="op">=</span> scaler.fit_transform(X)</span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Membagi data menjadi data pelatihan dan data pengujian</span></span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X_scaled, y, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-22"><a href="#cb44-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Menampilkan data awal</span></span>
<span id="cb44-23"><a href="#cb44-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Data Awal:&quot;</span>)</span>
<span id="cb44-24"><a href="#cb44-24" aria-hidden="true" tabindex="-1"></a>display(data.head())</span>
<span id="cb44-25"><a href="#cb44-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-26"><a href="#cb44-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Menampilkan data yang telah dinormalisasi</span></span>
<span id="cb44-27"><a href="#cb44-27" aria-hidden="true" tabindex="-1"></a>X_scaled_df <span class="op">=</span> pd.DataFrame(X_scaled, columns<span class="op">=</span>X.columns)</span>
<span id="cb44-28"><a href="#cb44-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Data yang telah dinormalisasi:&quot;</span>)</span>
<span id="cb44-29"><a href="#cb44-29" aria-hidden="true" tabindex="-1"></a>display(X_scaled_df.head())</span>
<span id="cb44-30"><a href="#cb44-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-31"><a href="#cb44-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Menampilkan data pelatihan dan pengujian</span></span>
<span id="cb44-32"><a href="#cb44-32" aria-hidden="true" tabindex="-1"></a>X_train_df <span class="op">=</span> pd.DataFrame(X_train, columns<span class="op">=</span>X.columns)</span>
<span id="cb44-33"><a href="#cb44-33" aria-hidden="true" tabindex="-1"></a>X_test_df <span class="op">=</span> pd.DataFrame(X_test, columns<span class="op">=</span>X.columns)</span>
<span id="cb44-34"><a href="#cb44-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-35"><a href="#cb44-35" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Data Pelatihan:&quot;</span>)</span>
<span id="cb44-36"><a href="#cb44-36" aria-hidden="true" tabindex="-1"></a>display(X_train_df.head())</span>
<span id="cb44-37"><a href="#cb44-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-38"><a href="#cb44-38" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Data Pengujian:&quot;</span>)</span>
<span id="cb44-39"><a href="#cb44-39" aria-hidden="true" tabindex="-1"></a>display(X_test_df.head())</span>
<span id="cb44-40"><a href="#cb44-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-41"><a href="#cb44-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Melatih model KNN dengan k=7</span></span>
<span id="cb44-42"><a href="#cb44-42" aria-hidden="true" tabindex="-1"></a>knn_7 <span class="op">=</span> KNeighborsClassifier(n_neighbors<span class="op">=</span><span class="dv">7</span>)</span>
<span id="cb44-43"><a href="#cb44-43" aria-hidden="true" tabindex="-1"></a>knn_7.fit(X_train, y_train)</span>
<span id="cb44-44"><a href="#cb44-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-45"><a href="#cb44-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Membuat prediksi untuk data pelatihan dan data pengujian dengan k=7</span></span>
<span id="cb44-46"><a href="#cb44-46" aria-hidden="true" tabindex="-1"></a>knn_7_predictions_train <span class="op">=</span> knn_7.predict(X_train)</span>
<span id="cb44-47"><a href="#cb44-47" aria-hidden="true" tabindex="-1"></a>knn_7_predictions_test <span class="op">=</span> knn_7.predict(X_test)</span>
<span id="cb44-48"><a href="#cb44-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-49"><a href="#cb44-49" aria-hidden="true" tabindex="-1"></a><span class="co"># Membuat DataFrame yang terdiri dari X_train, prediksi KNN k=7 untuk pelatihan, dan y_train</span></span>
<span id="cb44-50"><a href="#cb44-50" aria-hidden="true" tabindex="-1"></a>hd_meta_train <span class="op">=</span> X_train_df.copy()</span>
<span id="cb44-51"><a href="#cb44-51" aria-hidden="true" tabindex="-1"></a>hd_meta_train[<span class="st">&#39;knn_k7_train&#39;</span>] <span class="op">=</span> knn_7_predictions_train</span>
<span id="cb44-52"><a href="#cb44-52" aria-hidden="true" tabindex="-1"></a>hd_meta_train[<span class="st">&#39;y_train&#39;</span>] <span class="op">=</span> y_train.values</span>
<span id="cb44-53"><a href="#cb44-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-54"><a href="#cb44-54" aria-hidden="true" tabindex="-1"></a><span class="co"># Membuat DataFrame yang terdiri dari X_test, prediksi KNN k=7 untuk pengujian, dan y_test</span></span>
<span id="cb44-55"><a href="#cb44-55" aria-hidden="true" tabindex="-1"></a>hd_meta_test <span class="op">=</span> X_test_df.copy()</span>
<span id="cb44-56"><a href="#cb44-56" aria-hidden="true" tabindex="-1"></a>hd_meta_test[<span class="st">&#39;knn_k7_test&#39;</span>] <span class="op">=</span> knn_7_predictions_test</span>
<span id="cb44-57"><a href="#cb44-57" aria-hidden="true" tabindex="-1"></a>hd_meta_test[<span class="st">&#39;y_test&#39;</span>] <span class="op">=</span> y_test.values</span>
<span id="cb44-58"><a href="#cb44-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-59"><a href="#cb44-59" aria-hidden="true" tabindex="-1"></a><span class="co"># Menampilkan DataFrame hd_meta_train untuk pelatihan</span></span>
<span id="cb44-60"><a href="#cb44-60" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Data Pelatihan dengan Prediksi KNN k=7:&quot;</span>)</span>
<span id="cb44-61"><a href="#cb44-61" aria-hidden="true" tabindex="-1"></a>display(hd_meta_train.head())</span>
<span id="cb44-62"><a href="#cb44-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-63"><a href="#cb44-63" aria-hidden="true" tabindex="-1"></a><span class="co"># Menampilkan DataFrame hd_meta_test untuk pengujian</span></span>
<span id="cb44-64"><a href="#cb44-64" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Data Pengujian dengan Prediksi KNN k=7:&quot;</span>)</span>
<span id="cb44-65"><a href="#cb44-65" aria-hidden="true" tabindex="-1"></a>display(hd_meta_test.head())</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Data Awal:
</code></pre>
</div>
<div class="output display_data">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>sex</th>
      <th>cp</th>
      <th>trestbps</th>
      <th>chol</th>
      <th>fbs</th>
      <th>restecg</th>
      <th>thalach</th>
      <th>exang</th>
      <th>oldpeak</th>
      <th>slope</th>
      <th>ca</th>
      <th>thal</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>46</td>
      <td>0</td>
      <td>0.666667</td>
      <td>142</td>
      <td>177</td>
      <td>0</td>
      <td>0.0</td>
      <td>160</td>
      <td>1</td>
      <td>1.4</td>
      <td>0.0</td>
      <td>0</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>62</td>
      <td>0</td>
      <td>0.000000</td>
      <td>160</td>
      <td>164</td>
      <td>0</td>
      <td>0.0</td>
      <td>145</td>
      <td>0</td>
      <td>6.2</td>
      <td>0.0</td>
      <td>3</td>
      <td>3</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>56</td>
      <td>1</td>
      <td>0.333333</td>
      <td>120</td>
      <td>240</td>
      <td>0</td>
      <td>0.5</td>
      <td>169</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>63</td>
      <td>1</td>
      <td>0.000000</td>
      <td>130</td>
      <td>330</td>
      <td>1</td>
      <td>0.0</td>
      <td>132</td>
      <td>1</td>
      <td>1.8</td>
      <td>1.0</td>
      <td>3</td>
      <td>3</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>51</td>
      <td>0</td>
      <td>0.666667</td>
      <td>140</td>
      <td>308</td>
      <td>0</td>
      <td>0.0</td>
      <td>142</td>
      <td>0</td>
      <td>1.5</td>
      <td>1.0</td>
      <td>1</td>
      <td>2</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
</div>
<div class="output stream stdout">
<pre><code>
Data yang telah dinormalisasi:
</code></pre>
</div>
<div class="output display_data">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>sex</th>
      <th>cp</th>
      <th>trestbps</th>
      <th>chol</th>
      <th>fbs</th>
      <th>restecg</th>
      <th>thalach</th>
      <th>exang</th>
      <th>oldpeak</th>
      <th>slope</th>
      <th>ca</th>
      <th>thal</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.279070</td>
      <td>0.0</td>
      <td>0.666667</td>
      <td>0.452830</td>
      <td>0.068783</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.679245</td>
      <td>1.0</td>
      <td>0.225806</td>
      <td>0.0</td>
      <td>0.00</td>
      <td>0.666667</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.651163</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.622642</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.537736</td>
      <td>0.0</td>
      <td>1.000000</td>
      <td>0.0</td>
      <td>0.75</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.511628</td>
      <td>1.0</td>
      <td>0.333333</td>
      <td>0.245283</td>
      <td>0.402116</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>0.764151</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.00</td>
      <td>0.666667</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.674419</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>0.339623</td>
      <td>0.878307</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.415094</td>
      <td>1.0</td>
      <td>0.290323</td>
      <td>1.0</td>
      <td>0.75</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.395349</td>
      <td>0.0</td>
      <td>0.666667</td>
      <td>0.433962</td>
      <td>0.761905</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.509434</td>
      <td>0.0</td>
      <td>0.241935</td>
      <td>1.0</td>
      <td>0.25</td>
      <td>0.666667</td>
    </tr>
  </tbody>
</table>
</div>
</div>
<div class="output stream stdout">
<pre><code>
Data Pelatihan:
</code></pre>
</div>
<div class="output display_data">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>sex</th>
      <th>cp</th>
      <th>trestbps</th>
      <th>chol</th>
      <th>fbs</th>
      <th>restecg</th>
      <th>thalach</th>
      <th>exang</th>
      <th>oldpeak</th>
      <th>slope</th>
      <th>ca</th>
      <th>thal</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.395349</td>
      <td>1.0</td>
      <td>0.666667</td>
      <td>0.150943</td>
      <td>0.058201</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>0.330189</td>
      <td>0.0</td>
      <td>0.096774</td>
      <td>1.0</td>
      <td>0.00</td>
      <td>0.666667</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.395349</td>
      <td>1.0</td>
      <td>0.666667</td>
      <td>0.056604</td>
      <td>0.306878</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>0.518868</td>
      <td>1.0</td>
      <td>0.193548</td>
      <td>0.5</td>
      <td>0.00</td>
      <td>0.666667</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.232558</td>
      <td>1.0</td>
      <td>0.666667</td>
      <td>0.433962</td>
      <td>0.375661</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.867925</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.00</td>
      <td>0.666667</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.348837</td>
      <td>1.0</td>
      <td>0.666667</td>
      <td>0.245283</td>
      <td>0.126984</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>0.481132</td>
      <td>0.0</td>
      <td>0.322581</td>
      <td>0.5</td>
      <td>0.75</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.511628</td>
      <td>1.0</td>
      <td>0.333333</td>
      <td>0.339623</td>
      <td>0.301587</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.707547</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.00</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div>
</div>
<div class="output stream stdout">
<pre><code>
Data Pengujian:
</code></pre>
</div>
<div class="output display_data">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>sex</th>
      <th>cp</th>
      <th>trestbps</th>
      <th>chol</th>
      <th>fbs</th>
      <th>restecg</th>
      <th>thalach</th>
      <th>exang</th>
      <th>oldpeak</th>
      <th>slope</th>
      <th>ca</th>
      <th>thal</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.511628</td>
      <td>1.0</td>
      <td>0.666667</td>
      <td>0.339623</td>
      <td>0.486772</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.509434</td>
      <td>1.0</td>
      <td>0.096774</td>
      <td>0.5</td>
      <td>0.25</td>
      <td>0.333333</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.581395</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>0.415094</td>
      <td>0.566138</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.886792</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.00</td>
      <td>0.666667</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.093023</td>
      <td>1.0</td>
      <td>0.666667</td>
      <td>0.415094</td>
      <td>0.058201</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>0.801887</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>1.00</td>
      <td>0.666667</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.232558</td>
      <td>1.0</td>
      <td>0.333333</td>
      <td>0.245283</td>
      <td>0.296296</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>0.773585</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.00</td>
      <td>0.666667</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.813953</td>
      <td>0.0</td>
      <td>1.000000</td>
      <td>0.433962</td>
      <td>0.396825</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>0.594340</td>
      <td>0.0</td>
      <td>0.290323</td>
      <td>1.0</td>
      <td>0.50</td>
      <td>0.666667</td>
    </tr>
  </tbody>
</table>
</div>
</div>
<div class="output stream stdout">
<pre><code>
Data Pelatihan dengan Prediksi KNN k=7:
</code></pre>
</div>
<div class="output display_data">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>sex</th>
      <th>cp</th>
      <th>trestbps</th>
      <th>chol</th>
      <th>fbs</th>
      <th>restecg</th>
      <th>thalach</th>
      <th>exang</th>
      <th>oldpeak</th>
      <th>slope</th>
      <th>ca</th>
      <th>thal</th>
      <th>knn_k7_train</th>
      <th>y_train</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.395349</td>
      <td>1.0</td>
      <td>0.666667</td>
      <td>0.150943</td>
      <td>0.058201</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>0.330189</td>
      <td>0.0</td>
      <td>0.096774</td>
      <td>1.0</td>
      <td>0.00</td>
      <td>0.666667</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.395349</td>
      <td>1.0</td>
      <td>0.666667</td>
      <td>0.056604</td>
      <td>0.306878</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>0.518868</td>
      <td>1.0</td>
      <td>0.193548</td>
      <td>0.5</td>
      <td>0.00</td>
      <td>0.666667</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.232558</td>
      <td>1.0</td>
      <td>0.666667</td>
      <td>0.433962</td>
      <td>0.375661</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.867925</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.00</td>
      <td>0.666667</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.348837</td>
      <td>1.0</td>
      <td>0.666667</td>
      <td>0.245283</td>
      <td>0.126984</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>0.481132</td>
      <td>0.0</td>
      <td>0.322581</td>
      <td>0.5</td>
      <td>0.75</td>
      <td>1.000000</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.511628</td>
      <td>1.0</td>
      <td>0.333333</td>
      <td>0.339623</td>
      <td>0.301587</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.707547</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.00</td>
      <td>1.000000</td>
      <td>1</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
</div>
<div class="output stream stdout">
<pre><code>
Data Pengujian dengan Prediksi KNN k=7:
</code></pre>
</div>
<div class="output display_data">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>sex</th>
      <th>cp</th>
      <th>trestbps</th>
      <th>chol</th>
      <th>fbs</th>
      <th>restecg</th>
      <th>thalach</th>
      <th>exang</th>
      <th>oldpeak</th>
      <th>slope</th>
      <th>ca</th>
      <th>thal</th>
      <th>knn_k7_test</th>
      <th>y_test</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.511628</td>
      <td>1.0</td>
      <td>0.666667</td>
      <td>0.339623</td>
      <td>0.486772</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.509434</td>
      <td>1.0</td>
      <td>0.096774</td>
      <td>0.5</td>
      <td>0.25</td>
      <td>0.333333</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.581395</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>0.415094</td>
      <td>0.566138</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.886792</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.00</td>
      <td>0.666667</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.093023</td>
      <td>1.0</td>
      <td>0.666667</td>
      <td>0.415094</td>
      <td>0.058201</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>0.801887</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>1.00</td>
      <td>0.666667</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.232558</td>
      <td>1.0</td>
      <td>0.333333</td>
      <td>0.245283</td>
      <td>0.296296</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>0.773585</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.00</td>
      <td>0.666667</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.813953</td>
      <td>0.0</td>
      <td>1.000000</td>
      <td>0.433962</td>
      <td>0.396825</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>0.594340</td>
      <td>0.0</td>
      <td>0.290323</td>
      <td>1.0</td>
      <td>0.50</td>
      <td>0.666667</td>
      <td>1</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell code" data-cell_id="a0f8c350bda9409faf27f34fc6c3749f"
data-deepnote_app_block_visible="true" data-deepnote_cell_type="code"
data-deepnote_to_be_reexecuted="true" data-execution_millis="69"
data-execution_start="1717608229004" data-source_hash="null">
<div class="sourceCode" id="cb51"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> accuracy_score</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Melatih model KNN dengan k=7</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>knn_7 <span class="op">=</span> KNeighborsClassifier(n_neighbors<span class="op">=</span><span class="dv">7</span>)</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>knn_7.fit(X_train, y_train)</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Membuat prediksi untuk data training dan data testing dengan k=7</span></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>knn_7_predictions_train <span class="op">=</span> knn_7.predict(X_train)</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>knn_7_predictions_test <span class="op">=</span> knn_7.predict(X_test)</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Menghitung keakuratan untuk data training</span></span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>accuracy_train <span class="op">=</span> accuracy_score(y_train, knn_7_predictions_train)</span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Menghitung keakuratan untuk data testing</span></span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>accuracy_test <span class="op">=</span> accuracy_score(y_test, knn_7_predictions_test)</span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Menampilkan keakuratan</span></span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&#39;Akurasi Data Training: </span><span class="sc">{</span>accuracy_train<span class="sc">:.2f}</span><span class="ss">&#39;</span>)</span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&#39;Akurasi Data Testing: </span><span class="sc">{</span>accuracy_test<span class="sc">:.2f}</span><span class="ss">&#39;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Akurasi Data Training: 0.83
Akurasi Data Testing: 0.70
</code></pre>
</div>
</div>
<section id="ensemble-bagging" class="cell markdown"
data-cell_id="1dd984944e024858acde2f3fe762089a"
data-deepnote_app_block_visible="true"
data-deepnote_cell_type="text-cell-h2" data-formattedRanges="[]">
<h2>Ensemble Bagging</h2>
</section>
<div class="cell markdown"
data-cell_id="03d295bbdd65429babe2ae763900475c"
data-deepnote_app_block_visible="true"
data-deepnote_cell_type="text-cell-p" data-formattedRanges="[]">
<p>Ensemble bagging, yang merupakan singkatan dari Bootstrap
Aggregating, adalah teknik ensemble dalam pembelajaran mesin yang
dirancang untuk meningkatkan akurasi dan ketahanan model dengan
menggabungkan beberapa instance dari algoritma pembelajaran yang sama.
Dengan menggabungkan prediksi dari beberapa model yang dilatih pada
subset data yang berbeda, teknik ini dapat secara signifikan mengurangi
overfitting dan meningkatkan akurasi prediksi.</p>
</div>
<section id="menampilkan-data" class="cell markdown"
data-cell_id="f20758bc271d4ea08c2875d2a838a608"
data-deepnote_app_block_visible="true"
data-deepnote_cell_type="text-cell-h3" data-formattedRanges="[]">
<h3>Menampilkan Data</h3>
</section>
<div class="cell code" data-cell_id="14d322cd0bcc4a23a9448d504648cd4d"
data-deepnote_app_block_visible="true" data-deepnote_cell_type="code"
data-deepnote_to_be_reexecuted="true" data-execution_millis="12170"
data-execution_start="1717634588124" data-source_hash="null">
<div class="sourceCode" id="cb53"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import library yang dibutuhkan</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> IPython.display <span class="im">import</span> display</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> MinMaxScaler</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.neighbors <span class="im">import</span> KNeighborsClassifier</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Membaca data dari file CSV</span></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> pd.read_csv(<span class="st">&#39;hd_training_80.csv&#39;</span>)</span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Memisahkan data menjadi fitur (X) dan target (y)</span></span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> data.drop(<span class="st">&#39;target&#39;</span>, axis<span class="op">=</span><span class="dv">1</span>)  <span class="co"># Jika targetnya disebut &#39;target&#39;</span></span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> data[<span class="st">&#39;target&#39;</span>]</span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Normalisasi data menggunakan MinMaxScaler</span></span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a>scaler <span class="op">=</span> MinMaxScaler()</span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a>X_scaled <span class="op">=</span> scaler.fit_transform(X)</span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-19"><a href="#cb53-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Membagi data menjadi data pelatihan dan data pengujian</span></span>
<span id="cb53-20"><a href="#cb53-20" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X_scaled, y, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb53-21"><a href="#cb53-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-22"><a href="#cb53-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Menampilkan data awal</span></span>
<span id="cb53-23"><a href="#cb53-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Data Awal:&quot;</span>)</span>
<span id="cb53-24"><a href="#cb53-24" aria-hidden="true" tabindex="-1"></a>display(data.head())</span>
<span id="cb53-25"><a href="#cb53-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-26"><a href="#cb53-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Menampilkan data yang telah dinormalisasi</span></span>
<span id="cb53-27"><a href="#cb53-27" aria-hidden="true" tabindex="-1"></a>X_scaled_df <span class="op">=</span> pd.DataFrame(X_scaled, columns<span class="op">=</span>X.columns)</span>
<span id="cb53-28"><a href="#cb53-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Data yang telah dinormalisasi:&quot;</span>)</span>
<span id="cb53-29"><a href="#cb53-29" aria-hidden="true" tabindex="-1"></a>display(X_scaled_df.head())</span>
<span id="cb53-30"><a href="#cb53-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-31"><a href="#cb53-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Menampilkan data pelatihan dan pengujian</span></span>
<span id="cb53-32"><a href="#cb53-32" aria-hidden="true" tabindex="-1"></a>X_train_df <span class="op">=</span> pd.DataFrame(X_train, columns<span class="op">=</span>X.columns)</span>
<span id="cb53-33"><a href="#cb53-33" aria-hidden="true" tabindex="-1"></a>X_test_df <span class="op">=</span> pd.DataFrame(X_test, columns<span class="op">=</span>X.columns)</span>
<span id="cb53-34"><a href="#cb53-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-35"><a href="#cb53-35" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Data Pelatihan:&quot;</span>)</span>
<span id="cb53-36"><a href="#cb53-36" aria-hidden="true" tabindex="-1"></a>display(X_train_df.head())</span>
<span id="cb53-37"><a href="#cb53-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-38"><a href="#cb53-38" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Data Pengujian:&quot;</span>)</span>
<span id="cb53-39"><a href="#cb53-39" aria-hidden="true" tabindex="-1"></a>display(X_test_df.head())</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Data Awal:
</code></pre>
</div>
<div class="output display_data">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>sex</th>
      <th>cp</th>
      <th>trestbps</th>
      <th>chol</th>
      <th>fbs</th>
      <th>restecg</th>
      <th>thalach</th>
      <th>exang</th>
      <th>oldpeak</th>
      <th>slope</th>
      <th>ca</th>
      <th>thal</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>46</td>
      <td>0</td>
      <td>0.666667</td>
      <td>142</td>
      <td>177</td>
      <td>0</td>
      <td>0.0</td>
      <td>160</td>
      <td>1</td>
      <td>1.4</td>
      <td>0.0</td>
      <td>0</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>62</td>
      <td>0</td>
      <td>0.000000</td>
      <td>160</td>
      <td>164</td>
      <td>0</td>
      <td>0.0</td>
      <td>145</td>
      <td>0</td>
      <td>6.2</td>
      <td>0.0</td>
      <td>3</td>
      <td>3</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>56</td>
      <td>1</td>
      <td>0.333333</td>
      <td>120</td>
      <td>240</td>
      <td>0</td>
      <td>0.5</td>
      <td>169</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>63</td>
      <td>1</td>
      <td>0.000000</td>
      <td>130</td>
      <td>330</td>
      <td>1</td>
      <td>0.0</td>
      <td>132</td>
      <td>1</td>
      <td>1.8</td>
      <td>1.0</td>
      <td>3</td>
      <td>3</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>51</td>
      <td>0</td>
      <td>0.666667</td>
      <td>140</td>
      <td>308</td>
      <td>0</td>
      <td>0.0</td>
      <td>142</td>
      <td>0</td>
      <td>1.5</td>
      <td>1.0</td>
      <td>1</td>
      <td>2</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
</div>
<div class="output stream stdout">
<pre><code>
Data yang telah dinormalisasi:
</code></pre>
</div>
<div class="output display_data">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>sex</th>
      <th>cp</th>
      <th>trestbps</th>
      <th>chol</th>
      <th>fbs</th>
      <th>restecg</th>
      <th>thalach</th>
      <th>exang</th>
      <th>oldpeak</th>
      <th>slope</th>
      <th>ca</th>
      <th>thal</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.279070</td>
      <td>0.0</td>
      <td>0.666667</td>
      <td>0.452830</td>
      <td>0.068783</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.679245</td>
      <td>1.0</td>
      <td>0.225806</td>
      <td>0.0</td>
      <td>0.00</td>
      <td>0.666667</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.651163</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.622642</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.537736</td>
      <td>0.0</td>
      <td>1.000000</td>
      <td>0.0</td>
      <td>0.75</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.511628</td>
      <td>1.0</td>
      <td>0.333333</td>
      <td>0.245283</td>
      <td>0.402116</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>0.764151</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.00</td>
      <td>0.666667</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.674419</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>0.339623</td>
      <td>0.878307</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.415094</td>
      <td>1.0</td>
      <td>0.290323</td>
      <td>1.0</td>
      <td>0.75</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.395349</td>
      <td>0.0</td>
      <td>0.666667</td>
      <td>0.433962</td>
      <td>0.761905</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.509434</td>
      <td>0.0</td>
      <td>0.241935</td>
      <td>1.0</td>
      <td>0.25</td>
      <td>0.666667</td>
    </tr>
  </tbody>
</table>
</div>
</div>
<div class="output stream stdout">
<pre><code>
Data Pelatihan:
</code></pre>
</div>
<div class="output display_data">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>sex</th>
      <th>cp</th>
      <th>trestbps</th>
      <th>chol</th>
      <th>fbs</th>
      <th>restecg</th>
      <th>thalach</th>
      <th>exang</th>
      <th>oldpeak</th>
      <th>slope</th>
      <th>ca</th>
      <th>thal</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.395349</td>
      <td>1.0</td>
      <td>0.666667</td>
      <td>0.150943</td>
      <td>0.058201</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>0.330189</td>
      <td>0.0</td>
      <td>0.096774</td>
      <td>1.0</td>
      <td>0.00</td>
      <td>0.666667</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.395349</td>
      <td>1.0</td>
      <td>0.666667</td>
      <td>0.056604</td>
      <td>0.306878</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>0.518868</td>
      <td>1.0</td>
      <td>0.193548</td>
      <td>0.5</td>
      <td>0.00</td>
      <td>0.666667</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.232558</td>
      <td>1.0</td>
      <td>0.666667</td>
      <td>0.433962</td>
      <td>0.375661</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.867925</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.00</td>
      <td>0.666667</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.348837</td>
      <td>1.0</td>
      <td>0.666667</td>
      <td>0.245283</td>
      <td>0.126984</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>0.481132</td>
      <td>0.0</td>
      <td>0.322581</td>
      <td>0.5</td>
      <td>0.75</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.511628</td>
      <td>1.0</td>
      <td>0.333333</td>
      <td>0.339623</td>
      <td>0.301587</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.707547</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.00</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div>
</div>
<div class="output stream stdout">
<pre><code>
Data Pengujian:
</code></pre>
</div>
<div class="output display_data">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>sex</th>
      <th>cp</th>
      <th>trestbps</th>
      <th>chol</th>
      <th>fbs</th>
      <th>restecg</th>
      <th>thalach</th>
      <th>exang</th>
      <th>oldpeak</th>
      <th>slope</th>
      <th>ca</th>
      <th>thal</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.511628</td>
      <td>1.0</td>
      <td>0.666667</td>
      <td>0.339623</td>
      <td>0.486772</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.509434</td>
      <td>1.0</td>
      <td>0.096774</td>
      <td>0.5</td>
      <td>0.25</td>
      <td>0.333333</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.581395</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>0.415094</td>
      <td>0.566138</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.886792</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.00</td>
      <td>0.666667</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.093023</td>
      <td>1.0</td>
      <td>0.666667</td>
      <td>0.415094</td>
      <td>0.058201</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>0.801887</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>1.00</td>
      <td>0.666667</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.232558</td>
      <td>1.0</td>
      <td>0.333333</td>
      <td>0.245283</td>
      <td>0.296296</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>0.773585</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.00</td>
      <td>0.666667</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.813953</td>
      <td>0.0</td>
      <td>1.000000</td>
      <td>0.433962</td>
      <td>0.396825</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>0.594340</td>
      <td>0.0</td>
      <td>0.290323</td>
      <td>1.0</td>
      <td>0.50</td>
      <td>0.666667</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<section
id="memprediksi-menggunakan-ensemble-bagging-n_estimators-in-range-3-10"
class="cell markdown" data-cell_id="abcf577353f44e82b7f66dc00ed6b52a"
data-deepnote_app_block_visible="true"
data-deepnote_cell_type="text-cell-h3" data-formattedRanges="[]">
<h3>Memprediksi Menggunakan Ensemble Bagging (n_estimators in range
3-10)</h3>
</section>
<div class="cell code" data-cell_id="d1bedd3a4ae1406eafc53f331f5a6140"
data-deepnote_app_block_visible="true" data-deepnote_cell_type="code"
data-deepnote_to_be_reexecuted="true" data-execution_millis="204"
data-execution_start="1717635643064" data-source_hash="null">
<div class="sourceCode" id="cb58"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd  <span class="co"># Import pandas untuk manipulasi data</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.naive_bayes <span class="im">import</span> GaussianNB  <span class="co"># Import Gaussian Naive Bayes dari scikit-learn</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> BaggingClassifier  <span class="co"># Import BaggingClassifier dari scikit-learn</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the dataset</span></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> pd.read_csv(<span class="st">&#39;hd_training_80.csv&#39;</span>)  <span class="co"># Membaca dataset dari file CSV</span></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Assuming the last column is the target</span></span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> data.iloc[:, :<span class="op">-</span><span class="dv">1</span>]  <span class="co"># Memisahkan fitur (semua kolom kecuali kolom terakhir)</span></span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> data.iloc[:, <span class="op">-</span><span class="dv">1</span>]  <span class="co"># Memisahkan target (kolom terakhir)</span></span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Check if the dataset loaded correctly</span></span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Dataset head:</span><span class="ch">\n</span><span class="st">&quot;</span>, data.head())  <span class="co"># Menampilkan 5 baris pertama dataset untuk memeriksa apakah data dimuat dengan benar</span></span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Features shape:&quot;</span>, X.shape)  <span class="co"># Menampilkan bentuk (shape) dari fitur</span></span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Target shape:&quot;</span>, y.shape)  <span class="co"># Menampilkan bentuk (shape) dari target</span></span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-17"><a href="#cb58-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input for prediction (with placeholders for the remaining features)</span></span>
<span id="cb58-18"><a href="#cb58-18" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> [[<span class="fl">0.0582010582</span>, <span class="dv">0</span>, <span class="fl">0.5</span>, <span class="fl">0.3301886792</span>, <span class="dv">0</span>, <span class="fl">0.09677419355</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="fl">0.6666666667</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>]]  <span class="co"># Input sampel untuk prediksi</span></span>
<span id="cb58-19"><a href="#cb58-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-20"><a href="#cb58-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure the sample input has the correct number of features</span></span>
<span id="cb58-21"><a href="#cb58-21" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="bu">len</span>(sample_input[<span class="dv">0</span>]) <span class="op">!=</span> X.shape[<span class="dv">1</span>]:  <span class="co"># Memastikan jumlah fitur dalam input sampel sesuai dengan jumlah fitur dalam dataset</span></span>
<span id="cb58-22"><a href="#cb58-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="ss">f&quot;Sample input must have </span><span class="sc">{</span>X<span class="sc">.</span>shape[<span class="dv">1</span>]<span class="sc">}</span><span class="ss"> features, but got </span><span class="sc">{</span><span class="bu">len</span>(sample_input[<span class="dv">0</span>])<span class="sc">}</span><span class="ss"> features.&quot;</span>)  <span class="co"># Mengangkat error jika jumlah fitur tidak sesuai</span></span>
<span id="cb58-23"><a href="#cb58-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-24"><a href="#cb58-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert sample_input to DataFrame with same columns as X</span></span>
<span id="cb58-25"><a href="#cb58-25" aria-hidden="true" tabindex="-1"></a>sample_input_df <span class="op">=</span> pd.DataFrame(sample_input, columns<span class="op">=</span>X.columns)  <span class="co"># Mengonversi input sampel menjadi DataFrame dengan kolom yang sama seperti X</span></span>
<span id="cb58-26"><a href="#cb58-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-27"><a href="#cb58-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through n_estimators from 3 to 10</span></span>
<span id="cb58-28"><a href="#cb58-28" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> n_estimators <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">3</span>, <span class="dv">11</span>):  <span class="co"># Melakukan loop untuk jumlah estimator dari 3 hingga 10</span></span>
<span id="cb58-29"><a href="#cb58-29" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create and train the BaggingClassifier with a Naive Bayes estimator</span></span>
<span id="cb58-30"><a href="#cb58-30" aria-hidden="true" tabindex="-1"></a>    clf <span class="op">=</span> BaggingClassifier(base_estimator<span class="op">=</span>GaussianNB(),  <span class="co"># Membuat BaggingClassifier dengan GaussianNB sebagai estimator dasar</span></span>
<span id="cb58-31"><a href="#cb58-31" aria-hidden="true" tabindex="-1"></a>                            n_estimators<span class="op">=</span>n_estimators,  <span class="co"># Mengatur jumlah estimator</span></span>
<span id="cb58-32"><a href="#cb58-32" aria-hidden="true" tabindex="-1"></a>                            random_state<span class="op">=</span><span class="dv">0</span>).fit(X, y)  <span class="co"># Melatih model dengan data</span></span>
<span id="cb58-33"><a href="#cb58-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-34"><a href="#cb58-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Make a prediction</span></span>
<span id="cb58-35"><a href="#cb58-35" aria-hidden="true" tabindex="-1"></a>    prediction <span class="op">=</span> clf.predict(sample_input_df)  <span class="co"># Membuat prediksi berdasarkan input sampel</span></span>
<span id="cb58-36"><a href="#cb58-36" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&#39;Prediction with n_estimators=</span><span class="sc">{</span>n_estimators<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>prediction<span class="sc">}</span><span class="ss">&#39;</span>)  <span class="co"># Mencetak prediksi untuk jumlah estimator tertentu</span></span></code></pre></div>
<div class="output stream stdout">
<pre><code>Dataset head:
    age  sex        cp  trestbps  chol  fbs  restecg  thalach  exang  oldpeak  \
0   46    0  0.666667       142   177    0      0.0      160      1      1.4   
1   62    0  0.000000       160   164    0      0.0      145      0      6.2   
2   56    1  0.333333       120   240    0      0.5      169      0      0.0   
3   63    1  0.000000       130   330    1      0.0      132      1      1.8   
4   51    0  0.666667       140   308    0      0.0      142      0      1.5   

   slope  ca  thal  target  
0    0.0   0     2       1  
1    0.0   3     3       0  
2    0.0   0     2       1  
3    1.0   3     3       0  
4    1.0   1     2       1  
Features shape: (217, 13)
Target shape: (217,)
Prediction with n_estimators=3: [0]
Prediction with n_estimators=4: [0]
Prediction with n_estimators=5: [0]
Prediction with n_estimators=6: [0]
Prediction with n_estimators=7: [0]
Prediction with n_estimators=8: [0]
Prediction with n_estimators=9: [0]
Prediction with n_estimators=10: [0]
</code></pre>
</div>
</div>
<div class="cell code" data-cell_id="752efa432ca3497c86f851a5c90c5865"
data-deepnote_app_block_visible="true" data-deepnote_cell_type="code"
data-deepnote_to_be_reexecuted="true" data-execution_millis="572"
data-execution_start="1717635496324" data-source_hash="null">
<div class="sourceCode" id="cb60"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd  <span class="co"># Import pandas untuk manipulasi data</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.naive_bayes <span class="im">import</span> GaussianNB  <span class="co"># Import Gaussian Naive Bayes dari scikit-learn</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> BaggingClassifier  <span class="co"># Import BaggingClassifier dari scikit-learn</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split  <span class="co"># Import train_test_split untuk membagi dataset</span></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> accuracy_score  <span class="co"># Import accuracy_score untuk menghitung akurasi</span></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt  <span class="co"># Import matplotlib untuk visualisasi</span></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the dataset</span></span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> pd.read_csv(<span class="st">&#39;hd_training_80.csv&#39;</span>)  <span class="co"># Membaca dataset dari file CSV</span></span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Assuming the last column is the target</span></span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> data.iloc[:, :<span class="op">-</span><span class="dv">1</span>]  <span class="co"># Memisahkan fitur (semua kolom kecuali kolom terakhir)</span></span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> data.iloc[:, <span class="op">-</span><span class="dv">1</span>]  <span class="co"># Memisahkan target (kolom terakhir)</span></span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Split the dataset into training and testing sets</span></span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X, y, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">0</span>)  <span class="co"># Membagi dataset menjadi set pelatihan dan pengujian dengan rasio 80:20</span></span>
<span id="cb60-17"><a href="#cb60-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-18"><a href="#cb60-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize lists to store the number of estimators and corresponding accuracies</span></span>
<span id="cb60-19"><a href="#cb60-19" aria-hidden="true" tabindex="-1"></a>estimators <span class="op">=</span> <span class="bu">list</span>(<span class="bu">range</span>(<span class="dv">3</span>, <span class="dv">11</span>))  <span class="co"># Membuat daftar jumlah estimator dari 3 hingga 10</span></span>
<span id="cb60-20"><a href="#cb60-20" aria-hidden="true" tabindex="-1"></a>accuracies <span class="op">=</span> []  <span class="co"># Inisialisasi list untuk menyimpan akurasi</span></span>
<span id="cb60-21"><a href="#cb60-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-22"><a href="#cb60-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through n_estimators from 3 to 10</span></span>
<span id="cb60-23"><a href="#cb60-23" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> n_estimators <span class="kw">in</span> estimators:  <span class="co"># Loop melalui jumlah estimator dari 3 hingga 10</span></span>
<span id="cb60-24"><a href="#cb60-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create and train the BaggingClassifier with a Naive Bayes estimator</span></span>
<span id="cb60-25"><a href="#cb60-25" aria-hidden="true" tabindex="-1"></a>    clf <span class="op">=</span> BaggingClassifier(base_estimator<span class="op">=</span>GaussianNB(),  <span class="co"># Membuat BaggingClassifier dengan GaussianNB sebagai estimator dasar</span></span>
<span id="cb60-26"><a href="#cb60-26" aria-hidden="true" tabindex="-1"></a>                            n_estimators<span class="op">=</span>n_estimators,  <span class="co"># Mengatur jumlah estimator</span></span>
<span id="cb60-27"><a href="#cb60-27" aria-hidden="true" tabindex="-1"></a>                            random_state<span class="op">=</span><span class="dv">0</span>).fit(X_train, y_train)  <span class="co"># Melatih model dengan data pelatihan</span></span>
<span id="cb60-28"><a href="#cb60-28" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb60-29"><a href="#cb60-29" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Make predictions on the testing set</span></span>
<span id="cb60-30"><a href="#cb60-30" aria-hidden="true" tabindex="-1"></a>    y_pred <span class="op">=</span> clf.predict(X_test)  <span class="co"># Membuat prediksi pada data pengujian</span></span>
<span id="cb60-31"><a href="#cb60-31" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb60-32"><a href="#cb60-32" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate accuracy and store it</span></span>
<span id="cb60-33"><a href="#cb60-33" aria-hidden="true" tabindex="-1"></a>    accuracy <span class="op">=</span> accuracy_score(y_test, y_pred)  <span class="co"># Menghitung akurasi prediksi</span></span>
<span id="cb60-34"><a href="#cb60-34" aria-hidden="true" tabindex="-1"></a>    accuracies.append(accuracy)  <span class="co"># Menyimpan akurasi ke dalam list</span></span>
<span id="cb60-35"><a href="#cb60-35" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&#39;Accuracy with n_estimators=</span><span class="sc">{</span>n_estimators<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>accuracy<span class="sc">:.4f}</span><span class="ss">&#39;</span>)  <span class="co"># Mencetak akurasi untuk jumlah estimator tertentu</span></span>
<span id="cb60-36"><a href="#cb60-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-37"><a href="#cb60-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the accuracies</span></span>
<span id="cb60-38"><a href="#cb60-38" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))  <span class="co"># Membuat figure dengan ukuran tertentu</span></span>
<span id="cb60-39"><a href="#cb60-39" aria-hidden="true" tabindex="-1"></a>plt.plot(estimators, accuracies, marker<span class="op">=</span><span class="st">&#39;o&#39;</span>)  <span class="co"># Membuat plot akurasi vs jumlah estimator</span></span>
<span id="cb60-40"><a href="#cb60-40" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Number of Estimators&#39;</span>)  <span class="co"># Menambahkan label sumbu x</span></span>
<span id="cb60-41"><a href="#cb60-41" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Accuracy&#39;</span>)  <span class="co"># Menambahkan label sumbu y</span></span>
<span id="cb60-42"><a href="#cb60-42" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Bagging Classifier Accuracy vs. Number of Estimators&#39;</span>)  <span class="co"># Menambahkan judul plot</span></span>
<span id="cb60-43"><a href="#cb60-43" aria-hidden="true" tabindex="-1"></a>plt.ylim(<span class="dv">0</span>, <span class="dv">1</span>)  <span class="co"># Mengatur batas sumbu y dari 0 hingga 1</span></span>
<span id="cb60-44"><a href="#cb60-44" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>)  <span class="co"># Menambahkan grid pada plot</span></span>
<span id="cb60-45"><a href="#cb60-45" aria-hidden="true" tabindex="-1"></a>plt.show()  <span class="co"># Menampilkan plot</span></span></code></pre></div>
<div class="output stream stdout">
<pre><code>Accuracy with n_estimators=3: 0.8864
Accuracy with n_estimators=4: 0.8636
Accuracy with n_estimators=5: 0.8864
Accuracy with n_estimators=6: 0.9318
Accuracy with n_estimators=7: 0.9318
Accuracy with n_estimators=8: 0.9318
Accuracy with n_estimators=9: 0.9318
Accuracy with n_estimators=10: 0.8864
</code></pre>
</div>
<div class="output display_data">
<p><img
src="_images/03d2821746f51e966aeda8e8dad804ba3b62f9a7.png"
width="846" height="547" /></p>
</div>
</div>
<div class="cell markdown"
data-cell_id="e8f0ed8f32774db585bcec4cdf0d2790"
data-deepnote_app_block_visible="true"
data-deepnote_cell_type="text-cell-p"
data-formattedRanges="[{&quot;fromCodePoint&quot;:0,&quot;marks&quot;:{&quot;bold&quot;:true},&quot;toCodePoint&quot;:29,&quot;type&quot;:&quot;marks&quot;}]">
<p>Menggunakan Data Testing 20%</p>
</div>
<div class="cell code" data-cell_id="1a029da0e8e2401b911fc8083b6d75f1"
data-deepnote_app_block_visible="true" data-deepnote_cell_type="code"
data-deepnote_to_be_reexecuted="true" data-execution_millis="929"
data-execution_start="1717637364364" data-source_hash="null">
<div class="sourceCode" id="cb62"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.naive_bayes <span class="im">import</span> GaussianNB</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> BaggingClassifier</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> accuracy_score</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the training and testing datasets</span></span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>train_data <span class="op">=</span> pd.read_csv(<span class="st">&#39;hd_training_80.csv&#39;</span>)</span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>test_data <span class="op">=</span> pd.read_csv(<span class="st">&#39;hd_testing_20.csv&#39;</span>)</span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Assuming the last column is the target</span></span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a>X_train <span class="op">=</span> train_data.iloc[:, :<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a>y_train <span class="op">=</span> train_data.iloc[:, <span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a>X_test <span class="op">=</span> test_data.iloc[:, :<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a>y_test <span class="op">=</span> test_data.iloc[:, <span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-17"><a href="#cb62-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract feature names</span></span>
<span id="cb62-18"><a href="#cb62-18" aria-hidden="true" tabindex="-1"></a>feature_names <span class="op">=</span> X_train.columns</span>
<span id="cb62-19"><a href="#cb62-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-20"><a href="#cb62-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input for prediction with correct feature names</span></span>
<span id="cb62-21"><a href="#cb62-21" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> pd.DataFrame([[<span class="fl">0.0582010582</span>, <span class="dv">0</span>, <span class="fl">0.5</span>, <span class="fl">0.3301886792</span>, <span class="dv">0</span>, <span class="fl">0.09677419355</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="fl">0.6666666667</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>]], columns<span class="op">=</span>feature_names)</span>
<span id="cb62-22"><a href="#cb62-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-23"><a href="#cb62-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize lists to store the number of estimators and corresponding accuracies</span></span>
<span id="cb62-24"><a href="#cb62-24" aria-hidden="true" tabindex="-1"></a>estimators <span class="op">=</span> <span class="bu">list</span>(<span class="bu">range</span>(<span class="dv">3</span>, <span class="dv">20</span>))</span>
<span id="cb62-25"><a href="#cb62-25" aria-hidden="true" tabindex="-1"></a>accuracies <span class="op">=</span> []</span>
<span id="cb62-26"><a href="#cb62-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-27"><a href="#cb62-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through n_estimators from 3 to 10</span></span>
<span id="cb62-28"><a href="#cb62-28" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> n_estimators <span class="kw">in</span> estimators:</span>
<span id="cb62-29"><a href="#cb62-29" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create and train the BaggingClassifier with a Naive Bayes estimator</span></span>
<span id="cb62-30"><a href="#cb62-30" aria-hidden="true" tabindex="-1"></a>    clf <span class="op">=</span> BaggingClassifier(base_estimator<span class="op">=</span>GaussianNB(),</span>
<span id="cb62-31"><a href="#cb62-31" aria-hidden="true" tabindex="-1"></a>                            n_estimators<span class="op">=</span>n_estimators,</span>
<span id="cb62-32"><a href="#cb62-32" aria-hidden="true" tabindex="-1"></a>                            random_state<span class="op">=</span><span class="dv">0</span>).fit(X_train, y_train)</span>
<span id="cb62-33"><a href="#cb62-33" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb62-34"><a href="#cb62-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Make a prediction</span></span>
<span id="cb62-35"><a href="#cb62-35" aria-hidden="true" tabindex="-1"></a>    prediction <span class="op">=</span> clf.predict(sample_input)</span>
<span id="cb62-36"><a href="#cb62-36" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&#39;Prediction with n_estimators=</span><span class="sc">{</span>n_estimators<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>prediction<span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb62-37"><a href="#cb62-37" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb62-38"><a href="#cb62-38" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Evaluate the model on the testing set</span></span>
<span id="cb62-39"><a href="#cb62-39" aria-hidden="true" tabindex="-1"></a>    y_pred <span class="op">=</span> clf.predict(X_test)</span>
<span id="cb62-40"><a href="#cb62-40" aria-hidden="true" tabindex="-1"></a>    accuracy <span class="op">=</span> accuracy_score(y_test, y_pred)</span>
<span id="cb62-41"><a href="#cb62-41" aria-hidden="true" tabindex="-1"></a>    accuracies.append(accuracy)</span>
<span id="cb62-42"><a href="#cb62-42" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&#39;Accuracy with n_estimators=</span><span class="sc">{</span>n_estimators<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>accuracy<span class="sc">:.4f}</span><span class="ss">&#39;</span>)</span>
<span id="cb62-43"><a href="#cb62-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-44"><a href="#cb62-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the accuracies</span></span>
<span id="cb62-45"><a href="#cb62-45" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb62-46"><a href="#cb62-46" aria-hidden="true" tabindex="-1"></a>plt.plot(estimators, accuracies, marker<span class="op">=</span><span class="st">&#39;o&#39;</span>)</span>
<span id="cb62-47"><a href="#cb62-47" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Number of Estimators&#39;</span>)</span>
<span id="cb62-48"><a href="#cb62-48" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Accuracy&#39;</span>)</span>
<span id="cb62-49"><a href="#cb62-49" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Bagging Classifier Accuracy vs. Number of Estimators&#39;</span>)</span>
<span id="cb62-50"><a href="#cb62-50" aria-hidden="true" tabindex="-1"></a>plt.ylim(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb62-51"><a href="#cb62-51" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb62-52"><a href="#cb62-52" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Prediction with n_estimators=3: [0]
Accuracy with n_estimators=3: 0.8000
Prediction with n_estimators=4: [0]
Accuracy with n_estimators=4: 0.8000
Prediction with n_estimators=5: [0]
Accuracy with n_estimators=5: 0.8000
Prediction with n_estimators=6: [0]
Accuracy with n_estimators=6: 0.8000
Prediction with n_estimators=7: [0]
Accuracy with n_estimators=7: 0.8182
Prediction with n_estimators=8: [0]
Accuracy with n_estimators=8: 0.8182
Prediction with n_estimators=9: [0]
Accuracy with n_estimators=9: 0.8182
Prediction with n_estimators=10: [0]
Accuracy with n_estimators=10: 0.8364
Prediction with n_estimators=11: [0]
Accuracy with n_estimators=11: 0.8182
Prediction with n_estimators=12: [0]
Accuracy with n_estimators=12: 0.8182
Prediction with n_estimators=13: [0]
Accuracy with n_estimators=13: 0.8364
Prediction with n_estimators=14: [0]
Accuracy with n_estimators=14: 0.8364
Prediction with n_estimators=15: [0]
Accuracy with n_estimators=15: 0.8364
Prediction with n_estimators=16: [0]
Accuracy with n_estimators=16: 0.8364
Prediction with n_estimators=17: [0]
Accuracy with n_estimators=17: 0.8364
Prediction with n_estimators=18: [0]
Accuracy with n_estimators=18: 0.8364
Prediction with n_estimators=19: [0]
Accuracy with n_estimators=19: 0.8364
</code></pre>
</div>
<div class="output display_data">
<p><img
src="_images/16c7ddaf4c5cefd8d1ad8367f6427108fd3d7724.png"
width="846" height="547" /></p>
</div>
</div>
<div class="cell markdown"
data-cell_id="b0f0e46d946f41bca27f66c32d98cf76"
data-deepnote_app_block_visible="true"
data-deepnote_cell_type="text-cell-p"
data-formattedRanges="[{&quot;fromCodePoint&quot;:0,&quot;marks&quot;:{&quot;bold&quot;:true},&quot;toCodePoint&quot;:10,&quot;type&quot;:&quot;marks&quot;}]">
<p>Kesimpulan: prediksi tertinggi itu menggunakan n_estimator= 10,
dimana nilai yang dihasilkan paling tinggi dari n_enstimator
sebelum-sebelumnya.</p>
</div>
<section id="pembuatan-website-atau-aplikasi" class="cell markdown"
data-cell_id="0b8d51e8c12045e693b6fab7f22d0b0a"
data-deepnote_app_block_visible="true"
data-deepnote_cell_type="text-cell-h2" data-formattedRanges="[]">
<h2>Pembuatan Website atau Aplikasi</h2>
</section>
<div class="cell markdown"
data-cell_id="7661f4a29fca4800bfd4a4868b89a88a"
data-deepnote_app_block_visible="true"
data-deepnote_cell_type="text-cell-p" data-formattedRanges="[]">
<p>Untuk pembuatan website kami menggunakan pickle, yang setelah data
ditraining dapat disimpan ke dalam file menggunakan library Pickle. Maka
dapatlah website yang dapat memprediksi diagnosa penyakit jantung.</p>
</div>
<section id="pickle" class="cell markdown"
data-cell_id="965dd803ed634c7da1262a6d8c211797"
data-deepnote_app_block_visible="true"
data-deepnote_cell_type="text-cell-h3" data-formattedRanges="[]">
<h3>Pickle</h3>
</section>
<div class="cell code" data-cell_id="e063e13f20af49099a3a8b02361062f8"
data-deepnote_app_block_visible="true" data-deepnote_cell_type="code"
data-deepnote_to_be_reexecuted="true" data-execution_millis="552"
data-execution_start="1718244522548" data-source_hash="null">
<div class="sourceCode" id="cb64"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import library yang dibutuhkan</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pickle</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split, GridSearchCV</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> MinMaxScaler</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.neighbors <span class="im">import</span> KNeighborsClassifier</span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> accuracy_score</span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Membaca data dari file CSV</span></span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> pd.read_csv(<span class="st">&#39;dataset_normalization.csv&#39;</span>)</span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Memisahkan data menjadi fitur (X) dan target (y)</span></span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> data.drop(<span class="st">&#39;target&#39;</span>, axis<span class="op">=</span><span class="dv">1</span>)  <span class="co"># Jika targetnya disebut &#39;target&#39;</span></span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> data[<span class="st">&#39;target&#39;</span>]</span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-16"><a href="#cb64-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Normalisasi data menggunakan MinMaxScaler</span></span>
<span id="cb64-17"><a href="#cb64-17" aria-hidden="true" tabindex="-1"></a>scaler <span class="op">=</span> MinMaxScaler()</span>
<span id="cb64-18"><a href="#cb64-18" aria-hidden="true" tabindex="-1"></a>X_scaled <span class="op">=</span> scaler.fit_transform(X)</span>
<span id="cb64-19"><a href="#cb64-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-20"><a href="#cb64-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Menyimpan scaler ke file pickle</span></span>
<span id="cb64-21"><a href="#cb64-21" aria-hidden="true" tabindex="-1"></a>scaler_filename <span class="op">=</span> <span class="st">&quot;preprocessing.pickle&quot;</span></span>
<span id="cb64-22"><a href="#cb64-22" aria-hidden="true" tabindex="-1"></a>pickle.dump(scaler, <span class="bu">open</span>(scaler_filename, <span class="st">&quot;wb&quot;</span>))</span>
<span id="cb64-23"><a href="#cb64-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-24"><a href="#cb64-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Membagi data menjadi data pelatihan dan data pengujian</span></span>
<span id="cb64-25"><a href="#cb64-25" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X_scaled, y, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb64-26"><a href="#cb64-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-27"><a href="#cb64-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Menentukan kisaran nilai K yang ingin diuji</span></span>
<span id="cb64-28"><a href="#cb64-28" aria-hidden="true" tabindex="-1"></a>param_grid <span class="op">=</span> {<span class="st">&#39;n_neighbors&#39;</span>: [<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">9</span>, <span class="dv">11</span>, <span class="dv">13</span>, <span class="dv">15</span>]}</span>
<span id="cb64-29"><a href="#cb64-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-30"><a href="#cb64-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Inisialisasi model KNN</span></span>
<span id="cb64-31"><a href="#cb64-31" aria-hidden="true" tabindex="-1"></a>knn <span class="op">=</span> KNeighborsClassifier()</span>
<span id="cb64-32"><a href="#cb64-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-33"><a href="#cb64-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Inisialisasi Grid Search Cross-Validation</span></span>
<span id="cb64-34"><a href="#cb64-34" aria-hidden="true" tabindex="-1"></a>grid_search <span class="op">=</span> GridSearchCV(estimator<span class="op">=</span>knn, param_grid<span class="op">=</span>param_grid, cv<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb64-35"><a href="#cb64-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-36"><a href="#cb64-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Melatih model menggunakan Grid Search Cross-Validation</span></span>
<span id="cb64-37"><a href="#cb64-37" aria-hidden="true" tabindex="-1"></a>grid_search.fit(X_train, y_train)</span>
<span id="cb64-38"><a href="#cb64-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-39"><a href="#cb64-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Menampilkan hasil Grid Search</span></span>
<span id="cb64-40"><a href="#cb64-40" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;K optimal: &quot;</span>, grid_search.best_params_)</span>
<span id="cb64-41"><a href="#cb64-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-42"><a href="#cb64-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Menggunakan model terbaik untuk prediksi pada data uji</span></span>
<span id="cb64-43"><a href="#cb64-43" aria-hidden="true" tabindex="-1"></a>best_knn <span class="op">=</span> grid_search.best_estimator_</span>
<span id="cb64-44"><a href="#cb64-44" aria-hidden="true" tabindex="-1"></a>y_pred <span class="op">=</span> best_knn.predict(X_test)</span>
<span id="cb64-45"><a href="#cb64-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-46"><a href="#cb64-46" aria-hidden="true" tabindex="-1"></a><span class="co"># Menghitung dan menampilkan akurasi model</span></span>
<span id="cb64-47"><a href="#cb64-47" aria-hidden="true" tabindex="-1"></a>accuracy <span class="op">=</span> accuracy_score(y_test, y_pred)</span>
<span id="cb64-48"><a href="#cb64-48" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Akurasi pada data uji: &quot;</span>, accuracy)</span>
<span id="cb64-49"><a href="#cb64-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-50"><a href="#cb64-50" aria-hidden="true" tabindex="-1"></a><span class="co"># Menyimpan model yang sudah dilatih ke file pickle</span></span>
<span id="cb64-51"><a href="#cb64-51" aria-hidden="true" tabindex="-1"></a>model_filename <span class="op">=</span> <span class="st">&quot;knn_model.pickle&quot;</span></span>
<span id="cb64-52"><a href="#cb64-52" aria-hidden="true" tabindex="-1"></a>pickle.dump(best_knn, <span class="bu">open</span>(model_filename, <span class="st">&quot;wb&quot;</span>))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>K optimal:  {&#39;n_neighbors&#39;: 5}
Akurasi pada data uji:  0.8363636363636363
</code></pre>
</div>
</div>
<div class="cell code" data-cell_id="05243c5f89534558a01efde0091eeb52"
data-deepnote_app_block_visible="true" data-deepnote_cell_type="code"
data-deepnote_to_be_reexecuted="true" data-execution_millis="1175"
data-execution_start="1718244552692" data-source_hash="null">
<div class="sourceCode" id="cb66"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.naive_bayes <span class="im">import</span> GaussianNB</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> BaggingClassifier</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> accuracy_score, classification_report</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pickle</span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the training and testing datasets</span></span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>train_data <span class="op">=</span> pd.read_csv(<span class="st">&#39;hd_training_80.csv&#39;</span>)</span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>test_data <span class="op">=</span> pd.read_csv(<span class="st">&#39;hd_testing_20.csv&#39;</span>)</span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Assuming the last column is the target</span></span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a>X_train <span class="op">=</span> train_data.iloc[:, :<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a>y_train <span class="op">=</span> train_data.iloc[:, <span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true" tabindex="-1"></a>X_test <span class="op">=</span> test_data.iloc[:, :<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb66-17"><a href="#cb66-17" aria-hidden="true" tabindex="-1"></a>y_test <span class="op">=</span> test_data.iloc[:, <span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb66-18"><a href="#cb66-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-19"><a href="#cb66-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Check class balance</span></span>
<span id="cb66-20"><a href="#cb66-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Class distribution in training set:&quot;</span>)</span>
<span id="cb66-21"><a href="#cb66-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(y_train.value_counts())</span>
<span id="cb66-22"><a href="#cb66-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-23"><a href="#cb66-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Class distribution in test set:&quot;</span>)</span>
<span id="cb66-24"><a href="#cb66-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(y_test.value_counts())</span>
<span id="cb66-25"><a href="#cb66-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-26"><a href="#cb66-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Scale features</span></span>
<span id="cb66-27"><a href="#cb66-27" aria-hidden="true" tabindex="-1"></a>scaler <span class="op">=</span> StandardScaler()</span>
<span id="cb66-28"><a href="#cb66-28" aria-hidden="true" tabindex="-1"></a>X_train_scaled <span class="op">=</span> scaler.fit_transform(X_train)</span>
<span id="cb66-29"><a href="#cb66-29" aria-hidden="true" tabindex="-1"></a>X_test_scaled <span class="op">=</span> scaler.transform(X_test)</span>
<span id="cb66-30"><a href="#cb66-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-31"><a href="#cb66-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Save the scaler</span></span>
<span id="cb66-32"><a href="#cb66-32" aria-hidden="true" tabindex="-1"></a>scaler_filename <span class="op">=</span> <span class="st">&quot;preprocessing.pickle&quot;</span></span>
<span id="cb66-33"><a href="#cb66-33" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(scaler_filename, <span class="st">&#39;wb&#39;</span>) <span class="im">as</span> scaler_file:</span>
<span id="cb66-34"><a href="#cb66-34" aria-hidden="true" tabindex="-1"></a>    pickle.dump(scaler, scaler_file)</span>
<span id="cb66-35"><a href="#cb66-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-36"><a href="#cb66-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of estimators</span></span>
<span id="cb66-37"><a href="#cb66-37" aria-hidden="true" tabindex="-1"></a>n_estimators <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb66-38"><a href="#cb66-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-39"><a href="#cb66-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Create and train the BaggingClassifier with a Naive Bayes estimator</span></span>
<span id="cb66-40"><a href="#cb66-40" aria-hidden="true" tabindex="-1"></a>clf <span class="op">=</span> BaggingClassifier(base_estimator<span class="op">=</span>GaussianNB(), n_estimators<span class="op">=</span>n_estimators, random_state<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb66-41"><a href="#cb66-41" aria-hidden="true" tabindex="-1"></a>clf.fit(X_train_scaled, y_train)</span>
<span id="cb66-42"><a href="#cb66-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-43"><a href="#cb66-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Save the trained model to a pickle file</span></span>
<span id="cb66-44"><a href="#cb66-44" aria-hidden="true" tabindex="-1"></a>model_filename <span class="op">=</span> <span class="st">&quot;bagging_classifier_model.pickle&quot;</span></span>
<span id="cb66-45"><a href="#cb66-45" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(model_filename, <span class="st">&#39;wb&#39;</span>) <span class="im">as</span> model_file:</span>
<span id="cb66-46"><a href="#cb66-46" aria-hidden="true" tabindex="-1"></a>    pickle.dump(clf, model_file)</span>
<span id="cb66-47"><a href="#cb66-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-48"><a href="#cb66-48" aria-hidden="true" tabindex="-1"></a><span class="co"># Make a prediction on the sample input from the training data</span></span>
<span id="cb66-49"><a href="#cb66-49" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> X_train.iloc[<span class="dv">0</span>].values.reshape(<span class="dv">1</span>, <span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb66-50"><a href="#cb66-50" aria-hidden="true" tabindex="-1"></a>sample_input_scaled <span class="op">=</span> scaler.transform(sample_input)</span>
<span id="cb66-51"><a href="#cb66-51" aria-hidden="true" tabindex="-1"></a>prediction <span class="op">=</span> clf.predict(sample_input_scaled)</span>
<span id="cb66-52"><a href="#cb66-52" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&#39;Prediction with n_estimators=</span><span class="sc">{</span>n_estimators<span class="sc">}</span><span class="ss"> for sample input: </span><span class="sc">{</span>prediction<span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb66-53"><a href="#cb66-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-54"><a href="#cb66-54" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluate the model on the testing set</span></span>
<span id="cb66-55"><a href="#cb66-55" aria-hidden="true" tabindex="-1"></a>y_pred <span class="op">=</span> clf.predict(X_test_scaled)</span>
<span id="cb66-56"><a href="#cb66-56" aria-hidden="true" tabindex="-1"></a>accuracy <span class="op">=</span> accuracy_score(y_test, y_pred)</span>
<span id="cb66-57"><a href="#cb66-57" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&#39;Accuracy with n_estimators=</span><span class="sc">{</span>n_estimators<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>accuracy<span class="sc">:.4f}</span><span class="ss">&#39;</span>)</span>
<span id="cb66-58"><a href="#cb66-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-59"><a href="#cb66-59" aria-hidden="true" tabindex="-1"></a><span class="co"># Classification report for detailed analysis</span></span>
<span id="cb66-60"><a href="#cb66-60" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Classification Report:&quot;</span>)</span>
<span id="cb66-61"><a href="#cb66-61" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classification_report(y_test, y_pred))</span>
<span id="cb66-62"><a href="#cb66-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-63"><a href="#cb66-63" aria-hidden="true" tabindex="-1"></a><span class="co"># Save the results to a DataFrame and then to a CSV file</span></span>
<span id="cb66-64"><a href="#cb66-64" aria-hidden="true" tabindex="-1"></a>results_df <span class="op">=</span> pd.DataFrame({</span>
<span id="cb66-65"><a href="#cb66-65" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;n_estimators&#39;</span>: [n_estimators],</span>
<span id="cb66-66"><a href="#cb66-66" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;accuracy&#39;</span>: [accuracy]</span>
<span id="cb66-67"><a href="#cb66-67" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb66-68"><a href="#cb66-68" aria-hidden="true" tabindex="-1"></a>results_df.to_csv(<span class="st">&#39;bagging.csv&#39;</span>, index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb66-69"><a href="#cb66-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-70"><a href="#cb66-70" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate random data for predictions</span></span>
<span id="cb66-71"><a href="#cb66-71" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">0</span>)  <span class="co"># Set seed for reproducibility</span></span>
<span id="cb66-72"><a href="#cb66-72" aria-hidden="true" tabindex="-1"></a>random_data <span class="op">=</span> np.random.rand(<span class="bu">len</span>(X_train), <span class="bu">len</span>(X_train.columns))</span>
<span id="cb66-73"><a href="#cb66-73" aria-hidden="true" tabindex="-1"></a>random_data_scaled <span class="op">=</span> scaler.transform(random_data)</span>
<span id="cb66-74"><a href="#cb66-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-75"><a href="#cb66-75" aria-hidden="true" tabindex="-1"></a><span class="co"># Make predictions on the random data</span></span>
<span id="cb66-76"><a href="#cb66-76" aria-hidden="true" tabindex="-1"></a>random_predictions <span class="op">=</span> clf.predict(random_data_scaled)</span>
<span id="cb66-77"><a href="#cb66-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-78"><a href="#cb66-78" aria-hidden="true" tabindex="-1"></a><span class="co"># Save the final model&#39;s predictions on the entire training set along with Bagging value</span></span>
<span id="cb66-79"><a href="#cb66-79" aria-hidden="true" tabindex="-1"></a>train_predictions_df <span class="op">=</span> pd.DataFrame({</span>
<span id="cb66-80"><a href="#cb66-80" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;bagging&#39;</span>: [n_estimators] <span class="op">*</span> <span class="bu">len</span>(random_predictions),</span>
<span id="cb66-81"><a href="#cb66-81" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;prediction&#39;</span>: random_predictions</span>
<span id="cb66-82"><a href="#cb66-82" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb66-83"><a href="#cb66-83" aria-hidden="true" tabindex="-1"></a>train_predictions_df.to_csv(<span class="st">&#39;train_predictions.csv&#39;</span>, index<span class="op">=</span><span class="va">False</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Class distribution in training set:
target
1    115
0    102
Name: count, dtype: int64
Class distribution in test set:
target
1    32
0    23
Name: count, dtype: int64
/shared-libs/python3.9/py/lib/python3.9/site-packages/sklearn/base.py:450: UserWarning: X does not have valid feature names, but StandardScaler was fitted with feature names
  warnings.warn(
Prediction with n_estimators=10 for sample input: [1]
Accuracy with n_estimators=10: 0.8364
Classification Report:
              precision    recall  f1-score   support

           0       0.94      0.65      0.77        23
           1       0.79      0.97      0.87        32

    accuracy                           0.84        55
   macro avg       0.87      0.81      0.82        55
weighted avg       0.85      0.84      0.83        55

/shared-libs/python3.9/py/lib/python3.9/site-packages/sklearn/base.py:450: UserWarning: X does not have valid feature names, but StandardScaler was fitted with feature names
  warnings.warn(
</code></pre>
</div>
</div>
<div class="cell code" data-cell_id="77903f62138b4a6cb0a2fb5e29d1b9e2"
data-deepnote_app_block_visible="true" data-deepnote_cell_type="code"
data-deepnote_to_be_reexecuted="true" data-execution_millis="154"
data-execution_start="1718244732308" data-source_hash="null">
<div class="sourceCode" id="cb68"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pickle</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the trained model</span></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>model_filename <span class="op">=</span> <span class="st">&#39;bagging_classifier_model.pickle&#39;</span></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(model_filename, <span class="st">&#39;rb&#39;</span>) <span class="im">as</span> model_file:</span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>    modelku <span class="op">=</span> pickle.load(model_file)</span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the pre-processing scaler</span></span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>scaler_filename <span class="op">=</span> <span class="st">&#39;preprocessing.pickle&#39;</span></span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(scaler_filename, <span class="st">&#39;rb&#39;</span>) <span class="im">as</span> scaler_file:</span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a>    pra_proses <span class="op">=</span> pickle.load(scaler_file)</span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample data for prediction</span></span>
<span id="cb68-15"><a href="#cb68-15" aria-hidden="true" tabindex="-1"></a>data_sample <span class="op">=</span> [<span class="fl">0.0582010582</span>, <span class="dv">0</span>, <span class="fl">0.5</span>, <span class="fl">0.3301886792</span>, <span class="dv">0</span>, <span class="fl">0.09677419355</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="fl">0.6666666667</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>]</span>
<span id="cb68-16"><a href="#cb68-16" aria-hidden="true" tabindex="-1"></a>arr <span class="op">=</span> [data_sample]</span>
<span id="cb68-17"><a href="#cb68-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-18"><a href="#cb68-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Pre-process the data sample</span></span>
<span id="cb68-19"><a href="#cb68-19" aria-hidden="true" tabindex="-1"></a>hasil <span class="op">=</span> pra_proses.transform(arr)</span>
<span id="cb68-20"><a href="#cb68-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-21"><a href="#cb68-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict using the loaded model</span></span>
<span id="cb68-22"><a href="#cb68-22" aria-hidden="true" tabindex="-1"></a>prediksi <span class="op">=</span> modelku.predict(hasil)</span>
<span id="cb68-23"><a href="#cb68-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-24"><a href="#cb68-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the prediction result</span></span>
<span id="cb68-25"><a href="#cb68-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Hasil Prediksi:&quot;</span>, prediksi)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Hasil Prediksi: [0]
/shared-libs/python3.9/py/lib/python3.9/site-packages/sklearn/base.py:450: UserWarning: X does not have valid feature names, but StandardScaler was fitted with feature names
  warnings.warn(
</code></pre>
</div>
</div>
<section id="proses-hosting" class="cell markdown"
data-cell_id="f60a7eed736542bc941b1875028c1b28"
data-deepnote_app_block_visible="true"
data-deepnote_cell_type="text-cell-h2" data-formattedRanges="[]">
<h2>Proses Hosting</h2>
</section>
<div class="cell markdown"
data-cell_id="b387c7e583fa4f7389f661325314fb89"
data-deepnote_app_block_visible="true"
data-deepnote_cell_type="text-cell-p" data-formattedRanges="[]">
<p>Setelah website yang dibuat jadi, kami menghosting wbsite tersebut
menggunakan website hosting ploomber. Untuk langkah langkah hosting
dapat disimak sebagai berikut:</p>
</div>
<div class="cell markdown"
data-cell_id="1529bb154a604aff949c8508935fe03d"
data-deepnote_app_block_visible="true"
data-deepnote_cell_type="text-cell-bullet"
data-formattedRanges="[{&quot;fromCodePoint&quot;:33,&quot;ranges&quot;:[],&quot;toCodePoint&quot;:53,&quot;type&quot;:&quot;link&quot;,&quot;url&quot;:&quot;https://ploomber.io/&quot;}]">
<ul>
<li>Buka website dari ploomber cloud <a href="https://ploomber.io/"
class="uri">https://ploomber.io/</a> , setelah itu login terlebih
dahulu</li>
</ul>
</div>
<div class="cell markdown"
data-cell_id="0b17d72d0a974ef38c8020266ffd2516"
data-deepnote_app_block_visible="true"
data-deepnote_cell_type="text-cell-bullet" data-formattedRanges="[]">
<ul>
<li>Lalu pilih fitur application, klik 'NEW' untuk memasukan file</li>
</ul>
</div>
<div class="cell markdown"
data-cell_id="cd2fca1833854b84817284d79746cd7d"
data-deepnote_app_block_visible="true"
data-deepnote_cell_type="text-cell-bullet" data-formattedRanges="[]">
<ul>
<li>Pilih framework, disini kami memakai framework Flask</li>
</ul>
</div>
<div class="cell markdown"
data-cell_id="8ef66e9409414437a0523d2c2683c255"
data-deepnote_app_block_visible="true"
data-deepnote_cell_type="text-cell-bullet" data-formattedRanges="[]">
<ul>
<li>Selanjutnya masukan file yang sudah berbentuk zip</li>
</ul>
</div>
<div class="cell markdown"
data-cell_id="87e89928eacb46038a0c305ad94b4d2b"
data-deepnote_app_block_visible="true"
data-deepnote_cell_type="text-cell-bullet" data-formattedRanges="[]">
<ul>
<li>Lalu klik 'create'</li>
</ul>
</div>
<div class="cell markdown"
data-cell_id="d873df2ffcde46f4885daf7f2efc02eb"
data-deepnote_app_block_visible="true"
data-deepnote_cell_type="text-cell-p"
data-formattedRanges="[{&quot;fromCodePoint&quot;:48,&quot;ranges&quot;:[],&quot;toCodePoint&quot;:87,&quot;type&quot;:&quot;link&quot;,&quot;url&quot;:&quot;https://misty-smoke-2369.ploomberapp.io&quot;}]">
<p>Berikut adalah aplikasi yang sudah kami hosting <a
href="https://misty-smoke-2369.ploomberapp.io"
class="uri">https://misty-smoke-2369.ploomberapp.io</a></p>
</div>
<div class="cell markdown"
data-cell_id="c404e7d2959e44c794a52a69b84eeb90"
data-deepnote_app_block_visible="true"
data-deepnote_cell_type="text-cell-p" data-formattedRanges="[]">

</div>
<div class="cell markdown" data-created_in_deepnote_cell="true"
data-deepnote_cell_type="markdown">
<p><a style='text-decoration:none;line-height:16px;display:flex;color:#5B5B62;padding:10px;justify-content:end;' href='https://deepnote.com?utm_source=created-in-deepnote-cell&projectId=22d9449c-fd95-4c2b-a4dc-b93a8c81f983' target="_blank">
<img alt='Created in deepnote.com' style='display:inline;max-height:16px;margin:0px;margin-right:7.5px;' src='data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iODBweCIgaGVpZ2h0PSI4MHB4IiB2aWV3Qm94PSIwIDAgODAgODAiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU0LjEgKDc2NDkwKSAtIGh0dHBzOi8vc2tldGNoYXBwLmNvbSAtLT4KICAgIDx0aXRsZT5Hcm91cCAzPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9IkxhbmRpbmciIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxnIGlkPSJBcnRib2FyZCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTEyMzUuMDAwMDAwLCAtNzkuMDAwMDAwKSI+CiAgICAgICAgICAgIDxnIGlkPSJHcm91cC0zIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMjM1LjAwMDAwMCwgNzkuMDAwMDAwKSI+CiAgICAgICAgICAgICAgICA8cG9seWdvbiBpZD0iUGF0aC0yMCIgZmlsbD0iIzAyNjVCNCIgcG9pbnRzPSIyLjM3NjIzNzYyIDgwIDM4LjA0NzY2NjcgODAgNTcuODIxNzgyMiA3My44MDU3NTkyIDU3LjgyMTc4MjIgMzIuNzU5MjczOSAzOS4xNDAyMjc4IDMxLjY4MzE2ODMiPjwvcG9seWdvbj4KICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0zNS4wMDc3MTgsODAgQzQyLjkwNjIwMDcsNzYuNDU0OTM1OCA0Ny41NjQ5MTY3LDcxLjU0MjI2NzEgNDguOTgzODY2LDY1LjI2MTk5MzkgQzUxLjExMjI4OTksNTUuODQxNTg0MiA0MS42NzcxNzk1LDQ5LjIxMjIyODQgMjUuNjIzOTg0Niw0OS4yMTIyMjg0IEMyNS40ODQ5Mjg5LDQ5LjEyNjg0NDggMjkuODI2MTI5Niw0My4yODM4MjQ4IDM4LjY0NzU4NjksMzEuNjgzMTY4MyBMNzIuODcxMjg3MSwzMi41NTQ0MjUgTDY1LjI4MDk3Myw2Ny42NzYzNDIxIEw1MS4xMTIyODk5LDc3LjM3NjE0NCBMMzUuMDA3NzE4LDgwIFoiIGlkPSJQYXRoLTIyIiBmaWxsPSIjMDAyODY4Ij48L3BhdGg+CiAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMCwzNy43MzA0NDA1IEwyNy4xMTQ1MzcsMC4yNTcxMTE0MzYgQzYyLjM3MTUxMjMsLTEuOTkwNzE3MDEgODAsMTAuNTAwMzkyNyA4MCwzNy43MzA0NDA1IEM4MCw2NC45NjA0ODgyIDY0Ljc3NjUwMzgsNzkuMDUwMzQxNCAzNC4zMjk1MTEzLDgwIEM0Ny4wNTUzNDg5LDc3LjU2NzA4MDggNTMuNDE4MjY3Nyw3MC4zMTM2MTAzIDUzLjQxODI2NzcsNTguMjM5NTg4NSBDNTMuNDE4MjY3Nyw0MC4xMjg1NTU3IDM2LjMwMzk1NDQsMzcuNzMwNDQwNSAyNS4yMjc0MTcsMzcuNzMwNDQwNSBDMTcuODQzMDU4NiwzNy43MzA0NDA1IDkuNDMzOTE5NjYsMzcuNzMwNDQwNSAwLDM3LjczMDQ0MDUgWiIgaWQ9IlBhdGgtMTkiIGZpbGw9IiMzNzkzRUYiPjwvcGF0aD4KICAgICAgICAgICAgPC9nPgogICAgICAgIDwvZz4KICAgIDwvZz4KPC9zdmc+' >
</img> Created in
<span style='font-weight:600;margin-left:4px;'>Deepnote</span></a></p>
</div>
</body>
</html>
