
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>PROYEK PENAMBANGAN DATA &#8212; My sample book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b76e3c8a" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=87e54e7c" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=3ee479438cf8b5e0d341" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=3ee479438cf8b5e0d341" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=3ee479438cf8b5e0d341"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'pendat';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Notebooks with MyST Markdown" href="markdown-notebooks.html" />
    <link rel="prev" title="Content with notebooks" href="notebooks.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="My sample book - Home"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="My sample book - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Welcome to your Jupyter Book
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="markdown.html">Markdown Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks.html">Content with notebooks</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">PROYEK PENAMBANGAN DATA</a></li>
<li class="toctree-l1"><a class="reference internal" href="markdown-notebooks.html">Notebooks with MyST Markdown</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fpendat.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/pendat.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>PROYEK PENAMBANGAN DATA</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-understanding-memahami-data">1. Data Understanding (memahami data)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#menampilkan-data">Menampilkan Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#menentukan-missing-value">Menentukan Missing Value</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mengeksplorasi-data-numerik">Mengeksplorasi Data (Numerik)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mengeksplorasi-data-categorical">Mengeksplorasi Data (Categorical)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#menentukan-outlier">Menentukan Outlier</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#preprocessing">2. Preprocessing</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#menghapus-outlier">Menghapus Outlier</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#memisahkan-data-numeric-dan-categorical">Memisahkan data Numeric dan Categorical</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#min-max">Min Max</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#normalisasi-data">Normalisasi Data</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pemodelan">3. Pemodelan</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pengujian-dan-percobaan-dataset">Pengujian dan Percobaan Dataset</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#menyimpan-data-training-dan-data-testing-ke-csv">Menyimpan Data Training dan Data Testing ke CSV</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#prediksi-penyakit-jantung-menggunakan-klasifikasi-k-nearest-neighboars-knn">Prediksi Penyakit jantung Menggunakan Klasifikasi K-Nearest Neighboars (KNN)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Menampilkan data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#menampilkan-grafik-data">Menampilkan grafik data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#menentukan-nilai-k">Menentukan nilai K</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#menghitung-knn">Menghitung KNN</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#stacking-ensemble">Stacking Ensemble</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-training">Data Training</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-testing">Data Testing</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ensemble-bagging">Ensemble Bagging</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Menampilkan Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#memprediksi-menggunakan-ensemble-bagging-n-estimators-in-range-3-10">Memprediksi Menggunakan Ensemble Bagging (n_estimators in range 3-10)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pembuatan-website-atau-aplikasi">Pembuatan Website atau Aplikasi</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pickle">Pickle</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#proses-hosting">Proses Hosting</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="proyek-penambangan-data">
<h1>PROYEK PENAMBANGAN DATA<a class="headerlink" href="#proyek-penambangan-data" title="Link to this heading">#</a></h1>
<p>Kami mengambil data Diagnosa Penyakit Jantung atau Heart Diasese dari website <a class="reference external" href="https://archive.ics.uci.edu/">https://archive.ics.uci.edu/</a> yang selanjutnya akan kami uji sebagai proyek dari mata matakuliah kami yaitu matakuliah Penambangan Data. Untuk lebih jelasnya dapat disimak langkah-langkah kami dalam mengerjakan proyek ini</p>
<section id="data-understanding-memahami-data">
<h2>1. Data Understanding (memahami data)<a class="headerlink" href="#data-understanding-memahami-data" title="Link to this heading">#</a></h2>
<p>Pada pekerjaan kali ini, kami akan melakukan klasifikasi untuk prediksi penyakit jantung. Tujuan dari pekerjaan ini adalah untuk membantu dalam memprediksi adanya penyakit jantung atau tidak pada individu berdasarkan berbagai fitur yang tersedia. Dataset yang kami gunakan adalah dataset ‚ÄúHeart Disease‚Äù yang kami ambil dari UCI Machine Learning Repository. Dataset ini berasal dari Cleveland Clinic Foundation.</p>
<p>Langkah pertama yang dilakukan adalah mengumpulkan data. Data tersebut berada di <a class="reference external" href="http://aiven.com">aiven.com</a>, sehingga data perlu ditarik dari sumber tersebut. Dataset ini terdiri dari 303 baris dan 13 fitur, yaitu age, sex, cp, trestbp, chol, fbs, restecg, thalach, exang, oldpeak, slope, ca, dan thal.</p>
<p>Terdapat 2 type data dalam dataset ini, yakni numeric dan categorical.</p>
<ul class="simple">
<li><p>Tipe data numeric merujuk pada nilai-nilai yang terdiri dari angka atau bilangan. Tipe data numeric terdiri dari integer (int) dan floating point (float).</p></li>
</ul>
<ul class="simple">
<li><p>Tipe data categorical, juga dikenal sebagai tipe data kategorikal, merujuk pada variabel yang menggambarkan kategori atau kelompok yang berbeda.</p></li>
</ul>
<table>
    <tbody>
        <tr>
            <td>no</td>
            <td>nama</td>
            <td>type</td>
            <td>deskripsi</td>
            <td>value</td>
        </tr>
        <tr>
            <td>1</td>
            <td>age</td>
            <td>int (numerik)</td>
            <td>Variabel Usia pasien dalam tahun.</td>
            <td></td>
        </tr>
        <tr>
            <td>2</td>
            <td>sex</td>
            <td>categorical</td>
            <td>Variabel jenis kelamin individu dalam dataset</td>
            <td>1 untuk laki-laki, 0 untuk perempuan</td>
        </tr>
        <tr>
            <td>3</td>
            <td>cp (Chest Pain Type)</td>
            <td>categorical</td>
            <td>Variabel Tipe nyeri dada yang dirasakan pasien.</td>
            <td>
                -- Value 0: typical angina<br>
                -- Value 1: atypical angina<br>
                -- Value 2: non-anginal pain<br>
                -- Value 3: asymptomatic
            </td>
        </tr>
        <tr>
            <td>4</td>
            <td>trestbps (Resting Blood Pressure)</td>
            <td>int</td>
            <td>Variabel Tekanan darah pasien saat istirahat, diukur dalam mm Hg (milimeter merkuri).</td>
            <td></td>
        </tr>
        <tr>
            <td>5</td>
            <td>chol (Serum Cholesterol)</td>
            <td>int</td>
            <td>Variabel kadar kolesterol serum. Jumlah kolesterol dalam darah pasien, diukur dalam mg/dL (miligram per desiliter).</td>
            <td></td>
        </tr>
        <tr>
            <td>6</td>
            <td>fbs (Fasting Blood Sugar)</td>
            <td>categorical</td>
            <td>Variabel kadar gula darah puasa > 120mg/dl. Kadar gula darah pasien setelah berpuasa selama 8 jam.</td>
            <td>1 = true; 0 = false</td>
        </tr>
        <tr>
            <td>7</td>
            <td>restecg (Resting Electrodiographic Result)</td>
            <td>categorical</td>
            <td>Variabel hasil elektrokardiografi(rekaman aktivitas listrik jantung) ketika istirahat</td>
            <td>
                -- Value 0: normal<br>
                -- Value 1: having ST-T wave abnormality<br>
                -- Value 2: showing probable or definite left ventricular hypertrophy by Estes' criteria
            </td>
        </tr>
        <tr>
            <td>8</td>
            <td>thalach (Maximum Heart Rate Achieved)</td>
            <td>int</td>
            <td>Variabel denyut jantung maksimal yang dicapai pasien selama tes latihan.</td>
            <td></td>
        </tr>
        <tr>
            <td>9</td>
            <td>exang (Exercise Induced Angina)</td>
            <td>categorical</td>
            <td>Variabel angina yang diinduksi latihan (nyeri dada selama latihan)</td>
            <td>1 = yes; 0 = no</td>
        </tr>
        <tr>
            <td>10</td>
            <td>oldpeak (ST Depression Induced by Exercise Relative to Rest)</td>
            <td>int</td>
            <td>Variabel depresi ST latihan relatif terhadap istirahat (Perubahan level ST pada elektrokardiogram (EKG) yang menunjukkan seberapa parah jantung terpengaruh oleh latihan fisik.)</td>
            <td></td>
        </tr>
        <tr>
            <td>11</td>
            <td>slope (Slope of the Peak Exercise ST Segment)</td>
            <td>categorical</td>
            <td>Variabel kemiringan segmen ST selama latihan (Kemiringan segmen ST pada EKG)</td>
            <td>
                -- Value 1: upsloping<br>
                -- Value 2: flat<br>
                -- Value 3: downsloping
            </td>
        </tr>
        <tr>
            <td>12</td>
            <td>ca (Number of Major Vessels Colored by Fluoroscopy)</td>
            <td>int</td>
            <td>Variabel jumlah pembuluh darah utama berwarna yang dapat dilihat dengan fluoroskopi (teknik pencitraan medis).</td>
            <td></td>
        </tr>
        <tr>
            <td>13</td>
            <td>thal (Thalassemia)</td>
            <td>categorical</td>
            <td>Variabel Kondisi darah terkait thalasemia.</td>
            <td>
                0 = normal; 1 = fixed defect; 2 = reversable defect
            </td>
        </tr>
        <tr>
            <td>Target Variable</td>
            <td>target</td>
            <td>categorical</td>
            <td>Memprediksi apakah seseorang menderita penyakit jantung atau tidak</td>
            <td>
                0 = tidak ada; 1 = ada
            </td>
        </tr>
    </tbody>
</table>
## Markdown output üõ´
[CKEditor 5](https://ckeditor.com/) can be configured to output Markdown instead of HTML. Markdown is a lightweight markup language that you can use to add formatting to plain text documents. Use the **Source** button to check and edit the Markdown source code of this content.
The editor-produced Markdown output supports most essential features, like [links](https://ckeditor.com/), **different** kinds of _emphasis_, `inline code formatting`, or code blocks:
```css
p {
    text-align: center;
    color: red;
}
```
## Markdown input üõ¨
Thanks to the [autoformatting feature](https://ckeditor.com/docs/ckeditor5/latest/features/autoformat.html), you can use Markdown syntax when writing. Try it out - use these (or any other) Markdown shortcuts in the editor to format the content on the fly üöÄ!
| Inline formatting | Shortcut |
| --- | --- |
| **Bold** | Type `**` or `__` around your text. |
| _Italic_ | Type `*` or `_` around your text. |
| `Code` | Type `Àã` around your text. |
| ~Strikethrough~ | Type `~~` around your text. |
Shh! ü§´ Markdown has very basic support for tables. Some advanced table-related features like table or cell styling were disabled in this demo.
## Block formatting
You can also use Markdown to create various text blocks, such as:
*   Block quotes - Start a line with `Ôπ•` followed by a space.
*   Headings:
    1.  Heading 1 - Start a line with `#` followed by a space.
    2.  Heading 2 - Start a line with `##` followed by a space.
    3.  Heading 3 - Start a line with `###` followed by a space.
*   Lists, including nested ones:
    *   Numbered lists - Start a line with `1.` or `1)` followed by a space.
    *   Bulleted lists - Start a line with `*` or `-` followed by a space.
    *   To-do lists - Start a line with `[ ]` or `[x]` followed by a space to insert an unchecked or checked list item.
*   Code blocks - Start a line with `ÀãÀãÀã`.
*   Horizontal lines - Start a line with `---`<section id="menampilkan-data">
<h3>Menampilkan Data<a class="headerlink" href="#menampilkan-data" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_1</span> <span class="o">=</span> <span class="n">_deepnote_execute_sql</span><span class="p">(</span><span class="s1">&#39;SELECT * FROM `defaultdb`.`dataset`&#39;</span><span class="p">,</span> <span class="s1">&#39;SQL_BC3F0200_03FA_4DF4_B292_41D7A332FCDA&#39;</span><span class="p">,</span> <span class="n">audit_sql_comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">sql_cache_mode</span><span class="o">=</span><span class="s1">&#39;cache_disabled&#39;</span><span class="p">)</span>
<span class="n">df_1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">df_1</span> <span class="o">=</span> <span class="n">_deepnote_execute_sql</span><span class="p">(</span><span class="s1">&#39;SELECT * FROM `defaultdb`.`dataset`&#39;</span><span class="p">,</span> <span class="s1">&#39;SQL_BC3F0200_03FA_4DF4_B292_41D7A332FCDA&#39;</span><span class="p">,</span> <span class="n">audit_sql_comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">sql_cache_mode</span><span class="o">=</span><span class="s1">&#39;cache_disabled&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">df_1</span>

<span class="ne">NameError</span>: name &#39;_deepnote_execute_sql&#39; is not defined
</pre></div>
</div>
</div>
</div>
</section>
<section id="menentukan-missing-value">
<h3>Menentukan Missing Value<a class="headerlink" href="#menentukan-missing-value" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>  
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span> 
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;dataset.csv&#39;</span><span class="p">)</span> 
<span class="n">df</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ID          0
age         0
sex         0
cp          0
trestbps    0
chol        0
fbs         0
restecg     0
thalach     0
exang       0
oldpeak     0
slope       0
ca          0
thal        0
target      0
dtype: int64
</pre></div>
</div>
</div>
</div>
<p>KESIMPULAN: dapat dilihat bahwa tidak terdapat missing values dalam dataset</p>
</section>
<section id="mengeksplorasi-data-numerik">
<h3>Mengeksplorasi Data (Numerik)<a class="headerlink" href="#mengeksplorasi-data-numerik" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>  <span class="c1"># Import library numpy</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>  <span class="c1"># Import library pandas</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;Numerical.csv&#39;</span><span class="p">)</span>  <span class="c1"># Membaca file dataset.csv</span>
<span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span> <span class="c1">#hanya berlaku untuk type data numerik </span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>trestbps</th>
      <th>chol</th>
      <th>thalach</th>
      <th>oldpeak</th>
      <th>ca</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>272.000000</td>
      <td>272.000000</td>
      <td>272.000000</td>
      <td>272.000000</td>
      <td>272.000000</td>
      <td>272.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>53.977941</td>
      <td>130.750000</td>
      <td>244.488971</td>
      <td>151.091912</td>
      <td>1.021324</td>
      <td>0.727941</td>
    </tr>
    <tr>
      <th>std</th>
      <td>9.005916</td>
      <td>16.414713</td>
      <td>41.800262</td>
      <td>22.017161</td>
      <td>1.152050</td>
      <td>1.030651</td>
    </tr>
    <tr>
      <th>min</th>
      <td>29.000000</td>
      <td>94.000000</td>
      <td>157.000000</td>
      <td>88.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>47.000000</td>
      <td>120.000000</td>
      <td>212.000000</td>
      <td>139.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>55.000000</td>
      <td>130.000000</td>
      <td>240.500000</td>
      <td>154.500000</td>
      <td>0.650000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>60.000000</td>
      <td>140.000000</td>
      <td>273.000000</td>
      <td>168.000000</td>
      <td>1.600000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>77.000000</td>
      <td>200.000000</td>
      <td>353.000000</td>
      <td>202.000000</td>
      <td>6.200000</td>
      <td>4.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<img src="image-20240606-061415.png" width="" align="" /><img src="image-20240606-061259.png" width="" align="" /><p>KETERANGAN :</p>
<p>df.describe() hanya digunakan untuk tipe data numerik
Count: Jumlah data dalam setiap kolom.
Mean: Rata-rata nilai dalam setiap kolom.
Std (Standard Deviation): Standar Deviasi dari nilai dalam setiap kolom.
Min: Nilai minimum dalam setiap kolom.
25%, 50%, 75% (quartiles): Nilai-nilai kuartil yang membagi data menjadi empat bagian sama besar. Kuartil ke-50 adalah median.
Max: Nilai maksimum dalam setiap kolom.</p>
</section>
<section id="mengeksplorasi-data-categorical">
<h3>Mengeksplorasi Data (Categorical)<a class="headerlink" href="#mengeksplorasi-data-categorical" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Langkah 1: Impor pustaka pandas</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># Langkah 2: Baca file CSV menggunakan pd.read_csv</span>
<span class="c1"># Ganti &#39;nama_file.csv&#39; dengan nama file CSV yang sesuai dengan data Anda</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;categorical.csv&#39;</span><span class="p">)</span>

<span class="c1"># Langkah 3: Hitung modus untuk setiap kolom kategori menggunakan mode()</span>
<span class="n">modus</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">mode</span><span class="p">()</span>

<span class="c1"># Langkah 4: Tampilkan hasil modus</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Modus untuk setiap kolom kategori:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">modus</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Modus untuk setiap kolom kategori:
   sex  cp  fbs  restecg  exang  slope  thal  target
0    1   0    0        1      0      2     2       1
</pre></div>
</div>
</div>
</div>
<img src="image-20240606-061654.png" width="" align="" /><img src="image-20240606-061613.png" width="" align="" /><p>KESIMPULAN: dapat dilihat bahwa karakteristik yang paling sering muncul adalah berjenis kelamin(sex) pria(1), jenis nyeri dada(cp) ‚Äútypical angina‚Äù(0), kadar gula darah puasa(fbs) normal(0), hasil elektrokardiogram(restecg) normal(1), (slope) jarang mengalami angina saat latihan fisik, tipe slope ‚Äúflat‚Äù(2), dan jenis thalassemia(thal) ‚Äúnormal‚Äù(2).</p>
</section>
<section id="menentukan-outlier">
<h3>Menentukan Outlier<a class="headerlink" href="#menentukan-outlier" title="Link to this heading">#</a></h3>
<p>Outlier adalah data yang berbeda secara signifikan dari data lain dalam sebuah set data. Mereka bisa menjadi nilai yang sangat kecil atau sangat besar dibandingkan dengan nilai rata-rata atau mayoritas data lainnya.</p>
<p>LOF (Local Outlier Factor) adalah metode statistik yang digunakan untuk mendeteksi outlier dalam sebuah set data. Metode ini menghitung seberapa jauh suatu titik data berada dari tetangga-tetangganya dalam konteks data tersebut. LOF memberikan nilai yang menggambarkan seberapa ‚Äúaneh‚Äù atau tidak biasa suatu titik data dibandingkan dengan tetangganya.</p>
<p>Berikut merupakan implementasi dari perhitungan LOF dengan menggunakan library Scikit Learn.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Mengimpor pustaka pandas dengan alias &#39;pd&#39;.</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># Mengimpor kelas LocalOutlierFactor dari modul neighbors di pustaka Scikit-learn (sklearn).</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">LocalOutlierFactor</span>

<span class="c1"># Membaca dataset dari file CSV (&quot;dataset.csv&quot;) ke dalam DataFrame X menggunakan Pandas.</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;dataset.csv&quot;</span><span class="p">)</span>

<span class="c1"># Membuat objek LocalOutlierFactor (LOF).</span>
<span class="c1"># n_neighbors=5 menentukan jumlah tetangga yang akan digunakan dalam perhitungan LOF.</span>
<span class="c1"># contamination=0.1 menentukan tingkat kontaminasi atau persentase outlier yang diharapkan dalam data.</span>
<span class="n">lof</span> <span class="o">=</span> <span class="n">LocalOutlierFactor</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">contamination</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>

<span class="c1"># Menggunakan metode fit_predict() dari objek LOF untuk menentukan status outlier (outlier atau bukan) untuk setiap sampel dalam data.</span>
<span class="c1"># Hasilnya akan berupa array yang berisi prediksi status outlier untuk setiap sampel.</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">lof</span><span class="o">.</span><span class="n">fit_predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

<span class="c1"># Mencetak tabel prediksi status outlier.</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Predicted table:&quot;</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>

<span class="c1"># Mencetak nilai LOF yang bersifat negatif.</span>
<span class="c1"># Negative LOF scores memberikan informasi tentang seberapa jauh setiap sampel berada dari tetangganya dalam konteks outlier detection.</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Negative LOF scores:&quot;</span><span class="p">,</span> <span class="o">-</span><span class="n">lof</span><span class="o">.</span><span class="n">negative_outlier_factor_</span><span class="p">)</span>

<span class="c1"># Cari indeks dari nilai -1 dalam array y_pred</span>
<span class="n">outlier_indices</span> <span class="o">=</span> <span class="p">[</span><span class="n">index</span> <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">y_pred</span><span class="p">)</span> <span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<span class="c1"># Cetak indeks dari nilai -1 untuk mengetahui data ke berapa yang dianggap sebagai outlier</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Data outlier terdapat pada indeks:&quot;</span><span class="p">,</span> <span class="n">outlier_indices</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Predicted table: [ 1  1  1  1 -1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
  1  1  1  1 -1  1  1  1  1  1  1  1  1  1  1 -1  1  1  1  1  1  1  1  1
  1  1  1  1  1 -1  1  1  1  1  1  1  1  1  1 -1  1  1  1  1  1  1  1  1
  1  1  1  1  1  1  1  1  1  1  1  1 -1 -1  1  1  1  1  1  1  1  1 -1 -1
 -1  1  1  1  1 -1  1  1  1 -1 -1  1  1  1 -1 -1  1  1  1  1  1  1  1  1
  1  1  1  1  1  1  1  1  1 -1 -1  1  1  1  1  1  1  1  1  1  1  1  1  1
  1  1  1  1  1  1  1 -1  1  1  1  1  1  1  1  1  1  1  1  1  1 -1  1  1
  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1 -1  1  1  1  1  1  1
  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
  1  1  1  1 -1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
  1  1  1  1  1  1 -1  1 -1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
  1  1 -1 -1  1  1  1  1 -1  1  1  1 -1  1  1 -1  1  1  1  1  1  1  1  1
  1  1  1  1  1  1 -1  1  1 -1  1  1  1 -1  1]
Negative LOF scores: [0.99710253 1.07055211 1.10317456 0.98688025 1.36179513 1.05455635
 1.04312786 1.1136824  1.17921262 1.15398158 1.03206924 1.05035766
 1.04101311 0.96893306 1.0259659  1.00672292 1.20170549 1.16204075
 0.99299785 1.01332825 0.96258321 0.98252991 0.97202749 1.1007573
 1.01658246 1.04797362 0.99476059 1.2036188  1.48184233 1.04249566
 1.0421829  1.02684687 0.99858083 0.98293505 1.04447309 1.0412997
 1.01069119 0.96707467 1.04033638 1.40193142 0.98691258 0.99328319
 1.0293164  1.00400181 1.07336052 1.03102213 0.96910093 0.98311378
 1.10154684 1.01425808 0.99747996 0.94200702 1.10996145 1.36493789
 0.95658066 0.98878571 0.99682248 1.10417253 1.15364832 0.98459891
 1.13258989 0.96627201 1.12488904 1.21448933 0.99031287 1.135565
 1.06772696 0.98363984 0.98854266 1.01290157 0.96791608 1.05713049
 1.20863332 1.08424677 0.93489975 0.98569836 1.00256745 0.94460625
 0.97656704 1.05481169 1.03734554 0.97683783 1.0514034  1.08261437
 1.23294807 2.58246148 1.15918541 1.13045496 1.03939841 1.18931183
 0.96037085 1.02899114 0.99455108 1.07552553 1.67869881 1.23283812
 1.59677269 0.94833329 1.03421357 0.98194326 1.05700081 1.50961529
 1.01286454 1.10102041 0.96928415 1.36427866 1.25722521 1.02479298
 1.00615978 0.98847364 1.3872608  2.01613413 1.16349727 1.01490499
 0.97189745 0.99086237 0.94743283 0.95683089 1.00644147 1.00539385
 1.16891397 1.05564374 0.99234096 0.98246196 1.07635857 1.03597597
 1.01266384 1.08382033 1.02807417 1.35199658 1.2682644  1.01961153
 1.02822865 1.10117625 1.03484964 0.99703712 1.2108642  1.00976572
 1.029855   1.15879677 1.03107282 1.13586852 1.00266719 1.03563209
 1.14555605 1.07510473 1.06846677 1.14320023 0.96341232 1.03409591
 1.18358389 1.31402    1.1065415  1.07520536 0.98406196 1.02250736
 1.02825083 1.04809689 0.99506433 0.97497182 0.99511088 1.13151814
 1.05623813 1.08850019 1.08850019 1.21448314 0.98842249 1.02654247
 1.06670436 1.04096515 1.05855214 0.97421618 1.0686391  0.97506281
 0.97833857 1.13097128 0.96646274 1.05977598 1.10044161 1.03839129
 1.04734386 1.09994694 1.05476225 1.00328575 1.09121023 1.25082815
 1.03573359 1.07653834 1.07933863 0.98997091 1.0198115  1.04875395
 1.0512862  1.10911279 1.09029519 1.08578839 1.07337158 0.99697676
 0.97686308 1.0059718  1.15893009 0.94904916 1.04547659 1.18320303
 1.2121696  1.02148467 0.98769852 1.11725414 0.99699389 1.02233142
 1.00352881 1.0091896  1.07851426 0.9979436  0.9709955  1.08818161
 1.08483216 1.02247129 1.0274108  0.95722325 1.67877982 1.18036081
 0.97764377 1.15721361 1.11305703 1.10126588 1.05080832 1.01227226
 1.03864339 1.03403571 1.118998   0.99707539 0.97678476 1.13530886
 1.0744253  0.98110789 1.00233426 1.00765644 0.96977785 1.08321531
 1.03296513 1.08034478 1.12650469 1.05600891 1.01722818 1.0004918
 1.79201526 1.02025497 1.75002507 1.02600593 0.96626089 1.00365777
 1.00962042 1.14127592 1.01923237 0.99613235 0.96865145 1.15701909
 0.98789386 1.13511244 1.09912812 1.04981334 0.9630444  1.13526553
 1.18938346 1.14454339 1.43496042 1.30415521 0.99580202 0.96695479
 0.9708449  0.9386293  1.46169391 1.05381349 1.03224936 1.060824
 1.21991495 1.02554235 1.06663147 1.34007287 1.01854186 0.96869727
 1.01216517 1.17066607 0.98012135 1.03023181 0.98370918 1.10694409
 1.14350815 0.97702744 0.98057191 1.07844127 1.15798597 1.00597438
 1.30039599 0.98148941 0.98853493 1.87883393 1.20669489 1.09312942
 0.97003798 1.38443326 1.20282464]
Data outlier terdapat pada indeks: [4, 28, 39, 53, 63, 84, 85, 94, 95, 96, 101, 105, 106, 110, 111, 129, 130, 151, 165, 185, 220, 246, 248, 266, 267, 272, 276, 279, 294, 297, 301]
</pre></div>
</div>
</div>
</div>
<p>KESIMPULAN: Disini asumsinya adakah 0.1(10%) dari seluruh data dianggap outlier. output -1 adalah ciri-ciri dari outlier. dan output yang menunjukkan angka-angka desimal yang lebih tinggi dari angka-angka desimal lainnya merupakan outliernya. hal ini ditunjukkan pada indeks ke [4, 28, 39, 53, 63, 84, 85, 94, 95, 96, 101, 105, 106, 110, 111, 129, 130, 151, 165, 185, 220, 246, 248, 266, 267, 272, 276, 279, 294, 297, 301]</p>
</section>
</section>
<section id="preprocessing">
<h2>2. Preprocessing<a class="headerlink" href="#preprocessing" title="Link to this heading">#</a></h2>
<section id="menghapus-outlier">
<h3>Menghapus Outlier<a class="headerlink" href="#menghapus-outlier" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Mengimpor pustaka pandas dengan alias &#39;pd&#39;.</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># Mengimpor kelas LocalOutlierFactor dari modul neighbors di pustaka Scikit-learn (sklearn).</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">LocalOutlierFactor</span>

<span class="c1"># Membaca dataset dari file CSV (&quot;dataset.csv&quot;) ke dalam DataFrame X menggunakan Pandas.</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;dataset.csv&quot;</span><span class="p">)</span>

<span class="c1"># Membuat objek LocalOutlierFactor (LOF).</span>
<span class="c1"># n_neighbors=5 menentukan jumlah tetangga yang akan digunakan dalam perhitungan LOF.</span>
<span class="c1"># contamination=0.1 menentukan tingkat kontaminasi atau persentase outlier yang diharapkan dalam data.</span>
<span class="n">lof</span> <span class="o">=</span> <span class="n">LocalOutlierFactor</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">contamination</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>

<span class="c1"># Menggunakan metode fit_predict() dari objek LOF untuk menentukan status outlier (outlier atau bukan) untuk setiap sampel dalam data.</span>
<span class="c1"># Hasilnya akan berupa array yang berisi prediksi status outlier untuk setiap sampel.</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">lof</span><span class="o">.</span><span class="n">fit_predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

<span class="c1"># Cari indeks dari nilai -1 dalam array y_pred</span>
<span class="n">outlier_indices</span> <span class="o">=</span> <span class="p">[</span><span class="n">index</span> <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">y_pred</span><span class="p">)</span> <span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<span class="c1"># Cetak indeks dari nilai -1 untuk mengetahui data ke berapa yang dianggap sebagai outlier</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Data outlier terdapat pada indeks:&quot;</span><span class="p">,</span> <span class="n">outlier_indices</span><span class="p">)</span>

<span class="c1"># Menghapus baris yang mengandung outlier dari DataFrame</span>
<span class="n">X_cleaned</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">outlier_indices</span><span class="p">)</span>

<span class="c1"># Menyimpan DataFrame yang telah dibersihkan ke file CSV baru</span>
<span class="n">X_cleaned</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;dataset_tanpa_outlier.csv&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Menampilkan jumlah baris asli dan jumlah baris setelah outlier dihapus</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Jumlah baris asli:&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Jumlah baris setelah outlier dihapus:&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">X_cleaned</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Dataset tanpa outlier telah disimpan ke &#39;dataset_tanpa_outlier.csv&#39;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Data outlier terdapat pada indeks: [4, 28, 39, 53, 63, 84, 85, 94, 95, 96, 101, 105, 106, 110, 111, 129, 130, 151, 165, 185, 220, 246, 248, 266, 267, 272, 276, 279, 294, 297, 301]
Jumlah baris asli: 303
Jumlah baris setelah outlier dihapus: 272
Dataset tanpa outlier telah disimpan ke &#39;dataset_tanpa_outlier.csv&#39;
</pre></div>
</div>
</div>
</div>
<p>Kesimpulan : Kode ini membaca dataset, mendeteksi outlier menggunakan metode Local Outlier Factor, menghapus baris yang mengandung outlier, dan menyimpan dataset yang telah dibersihkan ke file baru.</p>
</section>
<section id="memisahkan-data-numeric-dan-categorical">
<h3>Memisahkan data Numeric dan Categorical<a class="headerlink" href="#memisahkan-data-numeric-dan-categorical" title="Link to this heading">#</a></h3>
<p>Numeric</p>
<img src="image-20240605-203240.png" width="" align="" /><p>Categorical</p>
<img src="image-20240605-203039.png" width="" align="" /></section>
<section id="min-max">
<h3>Min Max<a class="headerlink" href="#min-max" title="Link to this heading">#</a></h3>
<img src="rumus.jpg" width="" align="" /><img src="image-20240605-211357.png" width="" align="" /></section>
<section id="normalisasi-data">
<h3>Normalisasi Data<a class="headerlink" href="#normalisasi-data" title="Link to this heading">#</a></h3>
<p>Normalization adalah proses mengubah nilai-nilai dalam dataset sehingga mereka memiliki skala yang seragam. Min-max normalization adalah salah satu teknik normalization yang umum digunakan.  Dalam min-max normalization, nilai-nilai dalam dataset diubah sedemikian rupa sehingga mereka berada dalam rentang tertentu, biasanya 0 hingga 1.</p>
<img src="image-20240605-211514.png" width="" align="" /></section>
</section>
<section id="pemodelan">
<h2>3. Pemodelan<a class="headerlink" href="#pemodelan" title="Link to this heading">#</a></h2>
<section id="pengujian-dan-percobaan-dataset">
<h3>Pengujian dan Percobaan Dataset<a class="headerlink" href="#pengujian-dan-percobaan-dataset" title="Link to this heading">#</a></h3>
<p>Dataset dibagi menjadi 80% sebagai data training dan 20% sebagai data testing</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>

<span class="c1"># Membaca data dari file CSV</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;dataset_normalization.csv&#39;</span><span class="p">)</span>

<span class="c1"># Memisahkan data menjadi fitur (X) dan target (y)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># Sesuaikan dengan nama kolom target</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span>

<span class="c1"># Membagi data menjadi data pelatihan (80%) dan data pengujian (20%)</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># Menampilkan jumlah data pada data pelatihan dan data pengujian</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Jumlah data pelatihan:&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">X_train</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Jumlah data pengujian:&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">X_test</span><span class="p">))</span>

<span class="c1"># Menyimpan data pengujian ke dalam file CSV</span>
<span class="n">testing_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">testing_data</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;testing_data_Heart_Disease.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Jumlah data pelatihan: 217
Jumlah data pengujian: 55
</pre></div>
</div>
</div>
</div>
</section>
<section id="menyimpan-data-training-dan-data-testing-ke-csv">
<h3>Menyimpan Data Training dan Data Testing ke CSV<a class="headerlink" href="#menyimpan-data-training-dan-data-testing-ke-csv" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>

<span class="c1"># Membaca data dari file CSV</span>
<span class="n">file_path</span> <span class="o">=</span> <span class="s1">&#39;dataset_normalization.csv&#39;</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>

<span class="c1"># Membagi data menjadi 80% untuk training dan 20% untuk testing</span>
<span class="n">train_df</span><span class="p">,</span> <span class="n">test_df</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># Menyimpan data training ke file CSV</span>
<span class="n">train_file_path</span> <span class="o">=</span> <span class="s1">&#39;hd_training_80.csv&#39;</span>
<span class="n">train_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">train_file_path</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Menyimpan data testing ke file CSV</span>
<span class="n">test_file_path</span> <span class="o">=</span> <span class="s1">&#39;hd_testing_20.csv&#39;</span>
<span class="n">test_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">test_file_path</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Data training telah disimpan ke </span><span class="si">{</span><span class="n">train_file_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Data testing telah disimpan ke </span><span class="si">{</span><span class="n">test_file_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Data training telah disimpan ke hd_training_80.csv
Data testing telah disimpan ke hd_testing_20.csv
</pre></div>
</div>
</div>
</div>
<p>Kesimpulan:
Hal ini berfungsi untuk membagi dataset yang tersedia menjadi dua bagian, yaitu data training dan data testing, dengan proporsi masing-masing 80% dan 20%. Data yang telah dibagi kemudian disimpan ke file CSV yang terpisah untuk keperluan lebih lanjut.</p>
</section>
<section id="prediksi-penyakit-jantung-menggunakan-klasifikasi-k-nearest-neighboars-knn">
<h3>Prediksi Penyakit jantung Menggunakan Klasifikasi K-Nearest Neighboars (KNN)<a class="headerlink" href="#prediksi-penyakit-jantung-menggunakan-klasifikasi-k-nearest-neighboars-knn" title="Link to this heading">#</a></h3>
<p>K-Nearest Neighbors (KNN) adalah sebuah algoritma yang digunakan untuk memprediksi atau mengklasifikasikan data berdasarkan kesamaan dengan data yang sudah ada. Angka ‚ÄúK‚Äù dalam KNN mengacu pada jumlah tetangga terdekat yang akan dipertimbangkan untuk membuat prediksi. Misalnya, jika K = 3, maka KNN akan melihat 3 tetangga terdekat dari titik baru tersebut untuk membuat prediksi kelasnya.</p>
</section>
<section id="id1">
<h3>Menampilkan data<a class="headerlink" href="#id1" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p>Menampilkan jumlah baris dan kolom, yakni 272 baris dan 14 kolom (13 Fitur dan 1 Target)</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>  <span class="c1"># Import library numpy</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>  <span class="c1"># Import library pandas</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;dataset_normalization.csv&#39;</span><span class="p">)</span>  <span class="c1"># Membaca file dataset.csv dan menyimpannya ke dalam DataFrame df</span>
<span class="n">df</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># Menampilkan bentuk (jumlah baris dan kolom) dari DataFrame df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(272, 14)
</pre></div>
</div>
</div>
</div>
<ol class="arabic simple" start="2">
<li><p>Menampilkan data</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>age</th>
      <th>sex</th>
      <th>cp</th>
      <th>trestbps</th>
      <th>chol</th>
      <th>fbs</th>
      <th>restecg</th>
      <th>thalach</th>
      <th>exang</th>
      <th>oldpeak</th>
      <th>slope</th>
      <th>ca</th>
      <th>thal</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>63</td>
      <td>1</td>
      <td>3</td>
      <td>145</td>
      <td>233</td>
      <td>1</td>
      <td>0</td>
      <td>150</td>
      <td>0</td>
      <td>2.3</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>37</td>
      <td>1</td>
      <td>2</td>
      <td>130</td>
      <td>250</td>
      <td>0</td>
      <td>1</td>
      <td>187</td>
      <td>0</td>
      <td>3.5</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>41</td>
      <td>0</td>
      <td>1</td>
      <td>130</td>
      <td>204</td>
      <td>0</td>
      <td>0</td>
      <td>172</td>
      <td>0</td>
      <td>1.4</td>
      <td>2</td>
      <td>0</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>56</td>
      <td>1</td>
      <td>1</td>
      <td>120</td>
      <td>236</td>
      <td>0</td>
      <td>1</td>
      <td>178</td>
      <td>0</td>
      <td>0.8</td>
      <td>2</td>
      <td>0</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>57</td>
      <td>0</td>
      <td>0</td>
      <td>120</td>
      <td>354</td>
      <td>0</td>
      <td>1</td>
      <td>163</td>
      <td>1</td>
      <td>0.6</td>
      <td>2</td>
      <td>0</td>
      <td>2</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="menampilkan-grafik-data">
<h3>Menampilkan grafik data<a class="headerlink" href="#menampilkan-grafik-data" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>  <span class="c1"># Import library matplotlib untuk visualisasi data</span>
<span class="o">%</span><span class="k">matplotlib</span> inline  
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>  <span class="c1"># Import library seaborn untuk visualisasi data statistik</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">15</span><span class="p">))</span>  <span class="c1"># Membuat objek figure dengan ukuran 15x15 inci</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>  <span class="c1"># Mengambil sumbu saat ini (axes) dari objek figure</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>  <span class="c1"># Membuat histogram dari DataFrame df dan menampilkannya di axes ax</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_87/707982571.py:6: UserWarning: To output multiple subplots, the figure containing the passed axes is being cleared.
  g = df.hist(ax=ax)  # Membuat histogram dari DataFrame df dan menampilkannya di axes ax
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/a8dfa511680332bd7270e8d316e3c0cfe50114bbd7094c4f66b1959af1a9e327.png"><img alt="_images/a8dfa511680332bd7270e8d316e3c0cfe50114bbd7094c4f66b1959af1a9e327.png" src="_images/a8dfa511680332bd7270e8d316e3c0cfe50114bbd7094c4f66b1959af1a9e327.png" style="width: 1218px; height: 1221px;" /></a>
</div>
</div>
</section>
<section id="menentukan-nilai-k">
<h3>Menentukan nilai K<a class="headerlink" href="#menentukan-nilai-k" title="Link to this heading">#</a></h3>
<p>Program ini digunakan untuk melakukan evaluasi dan membandingkan kinerja model K-Nearest Neighbors (K-NN) dengan jumlah tetangga (k) yang berbeda  untuk memilih nilai k yang optimal untuk model. Kami menggunakan teknik Cross Validation. Cross-Validation adalah metode yang digunakan untuk mengevaluasi kinerja model dengan cara membagi data menjadi subset training dan subset testing secara berulang-ulang.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import library yang dibutuhkan</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">pickle</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span><span class="p">,</span> <span class="n">GridSearchCV</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span>

<span class="c1"># Membaca data dari file CSV</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;dataset_normalization.csv&#39;</span><span class="p">)</span>

<span class="c1"># Memisahkan data menjadi fitur (X) dan target (y)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># Jika targetnya disebut &#39;target&#39;</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span>

<span class="c1"># Normalisasi data menggunakan MinMaxScaler</span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">()</span>
<span class="n">X_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

<span class="c1"># Menyimpan scaler ke file pickle</span>
<span class="n">scaler_filename</span> <span class="o">=</span> <span class="s2">&quot;preprocessing.pickle&quot;</span>
<span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">scaler</span><span class="p">,</span> <span class="nb">open</span><span class="p">(</span><span class="n">scaler_filename</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">))</span>

<span class="c1"># Membagi data menjadi data pelatihan dan data pengujian</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X_scaled</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># Menentukan kisaran nilai K yang ingin diuji</span>
<span class="n">param_grid</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;n_neighbors&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">15</span><span class="p">]}</span>

<span class="c1"># Inisialisasi model KNN</span>
<span class="n">knn</span> <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">()</span>

<span class="c1"># Inisialisasi Grid Search Cross-Validation</span>
<span class="n">grid_search</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="n">knn</span><span class="p">,</span> <span class="n">param_grid</span><span class="o">=</span><span class="n">param_grid</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="c1"># Melatih model menggunakan Grid Search Cross-Validation</span>
<span class="n">grid_search</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="c1"># Menampilkan hasil Grid Search</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;K optimal: &quot;</span><span class="p">,</span> <span class="n">grid_search</span><span class="o">.</span><span class="n">best_params_</span><span class="p">)</span>

<span class="c1"># Menggunakan model terbaik untuk prediksi pada data uji</span>
<span class="n">best_knn</span> <span class="o">=</span> <span class="n">grid_search</span><span class="o">.</span><span class="n">best_estimator_</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">best_knn</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="c1"># Menghitung dan menampilkan akurasi model</span>
<span class="n">accuracy</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Akurasi pada data uji: &quot;</span><span class="p">,</span> <span class="n">accuracy</span><span class="p">)</span>

<span class="c1"># Menyimpan model yang sudah dilatih ke file pickle</span>
<span class="n">model_filename</span> <span class="o">=</span> <span class="s2">&quot;knn_model.pickle&quot;</span>
<span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">best_knn</span><span class="p">,</span> <span class="nb">open</span><span class="p">(</span><span class="n">model_filename</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>K optimal:  {&#39;n_neighbors&#39;: 5}
Akurasi pada data uji:  0.8363636363636363
</pre></div>
</div>
</div>
</div>
<p>KESIMPULAN : dari grafik diatas dapat disimpulkan bahwa nilai K yang optimal adalah K=3</p>
</section>
<section id="menghitung-knn">
<h3>Menghitung KNN<a class="headerlink" href="#menghitung-knn" title="Link to this heading">#</a></h3>
<p>Setelah menormalisasi data, dan mengubah data categorical menjadi data numeric, kini maka langkah selanjutnya adalah menghitung akurasi KNN dengan nilai K yang telah dihitung</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import library yang dibutuhkan</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span>

<span class="c1"># Membaca data dari file CSV</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;dataset_normalization.csv&#39;</span><span class="p">)</span>

<span class="c1"># Memisahkan data menjadi fitur (X) dan target (y)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># Jika targetnya disebut &#39;target&#39;</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span>

<span class="c1"># Normalisasi data menggunakan MinMaxScaler</span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">()</span>
<span class="n">X_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

<span class="c1"># Membagi data menjadi data pelatihan dan data pengujian</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X_scaled</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># Menginisialisasi model KNN</span>
<span class="n">knn</span> <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="c1"># Melatih model KNN</span>
<span class="n">knn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="c1"># Melakukan prediksi dengan data pengujian</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">knn</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="c1"># Menghitung akurasi model</span>
<span class="n">accuracy</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Akurasi model KNN:&quot;</span><span class="p">,</span> <span class="n">accuracy</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Akurasi model KNN: 0.8363636363636363
</pre></div>
</div>
</div>
</div>
<p>KESIMPULAN: Nilai 0.8363636363636363 menunjukkan nilai  akurasi dari model K-NN pada dataset yang digunakan. Akurasi adalah ukuran seberapa baik model dapat memprediksi kelas yang benar dari data uji yang belum pernah dilihat sebelumnya. Semakin tinggi nilai output ini (mendekati 1), semakin baik model K-NN bekerja dalam memprediksi kelas yang benar.</p>
</section>
</section>
<section id="stacking-ensemble">
<h2>Stacking Ensemble<a class="headerlink" href="#stacking-ensemble" title="Link to this heading">#</a></h2>
<p>Stacking Ensemble adalah teknik machine learning yang menggabungkan prediksi dari beberapa model dasar (base models) untuk membangun model yang lebih kuat. Pendekatan ini melibatkan dua tingkat model: tingkat pertama terdiri dari beberapa model dasar yang dilatih menggunakan data pelatihan asli, dan tingkat kedua adalah model meta yang dilatih menggunakan prediksi dari model dasar sebagai fitur.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">scikit</span><span class="o">-</span><span class="n">learn</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: scikit-learn in /shared-libs/python3.9/py/lib/python3.9/site-packages (1.1.2)
Requirement already satisfied: numpy&gt;=1.17.3 in /shared-libs/python3.9/py/lib/python3.9/site-packages (from scikit-learn) (1.23.4)
Requirement already satisfied: joblib&gt;=1.0.0 in /shared-libs/python3.9/py/lib/python3.9/site-packages (from scikit-learn) (1.2.0)
Requirement already satisfied: threadpoolctl&gt;=2.0.0 in /shared-libs/python3.9/py/lib/python3.9/site-packages (from scikit-learn) (3.1.0)
Requirement already satisfied: scipy&gt;=1.3.2 in /shared-libs/python3.9/py/lib/python3.9/site-packages (from scikit-learn) (1.9.3)
<span class=" -Color -Color-Yellow">WARNING: Running pip as the &#39;root&#39; user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv</span>

<span class=" -Color -Color-Bold">[</span><span class=" -Color -Color-Blue">notice</span><span class=" -Color -Color-Bold">]</span> A new release of pip is available: <span class=" -Color -Color-Red">23.0.1</span> -&gt; <span class=" -Color -Color-Green">24.0</span>
<span class=" -Color -Color-Bold">[</span><span class=" -Color -Color-Blue">notice</span><span class=" -Color -Color-Bold">]</span> To update, run: <span class=" -Color -Color-Green">python -m pip install --upgrade pip</span>
Note: you may need to restart the kernel to use updated packages.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>mlxtend
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Collecting mlxtend
  Downloading mlxtend-0.23.1-py3-none-any.whl (1.4 MB)
     ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ <span class=" -Color -Color-Green">1.4/1.4 MB</span> <span class=" -Color -Color-Red">47.2 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hRequirement already satisfied: scipy&gt;=1.2.1 in /shared-libs/python3.9/py/lib/python3.9/site-packages (from mlxtend) (1.9.3)
Requirement already satisfied: numpy&gt;=1.16.2 in /shared-libs/python3.9/py/lib/python3.9/site-packages (from mlxtend) (1.23.4)
Requirement already satisfied: matplotlib&gt;=3.0.0 in /shared-libs/python3.9/py/lib/python3.9/site-packages (from mlxtend) (3.6.0)
Requirement already satisfied: scikit-learn&gt;=1.0.2 in /shared-libs/python3.9/py/lib/python3.9/site-packages (from mlxtend) (1.1.2)
Requirement already satisfied: pandas&gt;=0.24.2 in /shared-libs/python3.9/py/lib/python3.9/site-packages (from mlxtend) (2.1.4)
Requirement already satisfied: joblib&gt;=0.13.2 in /shared-libs/python3.9/py/lib/python3.9/site-packages (from mlxtend) (1.2.0)
Requirement already satisfied: contourpy&gt;=1.0.1 in /shared-libs/python3.9/py/lib/python3.9/site-packages (from matplotlib&gt;=3.0.0-&gt;mlxtend) (1.0.5)
Requirement already satisfied: pillow&gt;=6.2.0 in /shared-libs/python3.9/py/lib/python3.9/site-packages (from matplotlib&gt;=3.0.0-&gt;mlxtend) (9.2.0)
Requirement already satisfied: kiwisolver&gt;=1.0.1 in /shared-libs/python3.9/py/lib/python3.9/site-packages (from matplotlib&gt;=3.0.0-&gt;mlxtend) (1.4.4)
Requirement already satisfied: packaging&gt;=20.0 in /shared-libs/python3.9/py-core/lib/python3.9/site-packages (from matplotlib&gt;=3.0.0-&gt;mlxtend) (21.3)
Requirement already satisfied: python-dateutil&gt;=2.7 in /shared-libs/python3.9/py-core/lib/python3.9/site-packages (from matplotlib&gt;=3.0.0-&gt;mlxtend) (2.8.2)
Requirement already satisfied: cycler&gt;=0.10 in /shared-libs/python3.9/py/lib/python3.9/site-packages (from matplotlib&gt;=3.0.0-&gt;mlxtend) (0.11.0)
Requirement already satisfied: fonttools&gt;=4.22.0 in /shared-libs/python3.9/py/lib/python3.9/site-packages (from matplotlib&gt;=3.0.0-&gt;mlxtend) (4.37.4)
Requirement already satisfied: pyparsing&gt;=2.2.1 in /shared-libs/python3.9/py-core/lib/python3.9/site-packages (from matplotlib&gt;=3.0.0-&gt;mlxtend) (3.0.9)
Requirement already satisfied: tzdata&gt;=2022.1 in /shared-libs/python3.9/py/lib/python3.9/site-packages (from pandas&gt;=0.24.2-&gt;mlxtend) (2022.5)
Requirement already satisfied: pytz&gt;=2020.1 in /shared-libs/python3.9/py/lib/python3.9/site-packages (from pandas&gt;=0.24.2-&gt;mlxtend) (2022.5)
Requirement already satisfied: threadpoolctl&gt;=2.0.0 in /shared-libs/python3.9/py/lib/python3.9/site-packages (from scikit-learn&gt;=1.0.2-&gt;mlxtend) (3.1.0)
Requirement already satisfied: six&gt;=1.5 in /shared-libs/python3.9/py-core/lib/python3.9/site-packages (from python-dateutil&gt;=2.7-&gt;matplotlib&gt;=3.0.0-&gt;mlxtend) (1.16.0)
Installing collected packages: mlxtend
Successfully installed mlxtend-0.23.1

<span class=" -Color -Color-Bold">[</span><span class=" -Color -Color-Blue">notice</span><span class=" -Color -Color-Bold">]</span> A new release of pip is available: <span class=" -Color -Color-Red">23.0.1</span> -&gt; <span class=" -Color -Color-Green">24.0</span>
<span class=" -Color -Color-Bold">[</span><span class=" -Color -Color-Blue">notice</span><span class=" -Color -Color-Bold">]</span> To update, run: <span class=" -Color -Color-Green">pip install --upgrade pip</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">model_selection</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.naive_bayes</span> <span class="kn">import</span> <span class="n">GaussianNB</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestClassifier</span>
<span class="kn">from</span> <span class="nn">mlxtend.classifier</span> <span class="kn">import</span> <span class="n">StackingClassifier</span>
<span class="kn">import</span> <span class="nn">warnings</span>

<span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>

<span class="c1"># Load the dataset</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;hd_training_80.csv&#39;</span><span class="p">)</span>

<span class="c1"># Assuming the last column is the target variable</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

<span class="c1"># Define the classifiers</span>
<span class="n">clf1</span> <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">clf2</span> <span class="o">=</span>  <span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">lr</span> <span class="o">=</span>  <span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">sclf</span> <span class="o">=</span> <span class="n">StackingClassifier</span><span class="p">(</span><span class="n">classifiers</span><span class="o">=</span><span class="p">[</span><span class="n">clf1</span><span class="p">,</span> <span class="n">clf2</span><span class="p">],</span> <span class="n">meta_classifier</span><span class="o">=</span><span class="n">lr</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;3-fold cross validation:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">clf</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="n">clf1</span><span class="p">,</span> <span class="n">clf2</span><span class="p">,</span><span class="n">sclf</span><span class="p">],</span> 
                      <span class="p">[</span><span class="s1">&#39;KNN K = 3&#39;</span><span class="p">,</span>  
                       <span class="s1">&#39;KNN K = 5&#39;</span><span class="p">,</span>
                       <span class="s1">&#39;StackingClassifier&#39;</span><span class="p">]):</span>

    <span class="n">scores</span> <span class="o">=</span> <span class="n">model_selection</span><span class="o">.</span><span class="n">cross_val_score</span><span class="p">(</span><span class="n">clf</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> 
                                             <span class="n">cv</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;accuracy&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Accuracy: </span><span class="si">%0.2f</span><span class="s2"> (+/- </span><span class="si">%0.2f</span><span class="s2">) [</span><span class="si">%s</span><span class="s2">]&quot;</span> 
          <span class="o">%</span> <span class="p">(</span><span class="n">scores</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">scores</span><span class="o">.</span><span class="n">std</span><span class="p">(),</span> <span class="n">label</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3-fold cross validation:

Accuracy: 0.65 (+/- 0.02) [KNN K = 3]
Accuracy: 0.59 (+/- 0.01) [KNN K = 5]
Accuracy: 0.62 (+/- 0.03) [StackingClassifier]
</pre></div>
</div>
</div>
</div>
<section id="data-training">
<h3>Data Training<a class="headerlink" href="#data-training" title="Link to this heading">#</a></h3>
<p>k=3 untuk model dasar:</p>
<p>Bagi data menjadi 3 bagian (fold).
Latih model dasar pada 2 fold dan validasi pada 1 fold.
Ulangi untuk setiap fold.
Kumpulkan prediksi dari model dasar untuk membuat dataset baru.</p>
<p>k=5 untuk model dasar:</p>
<p>Bagi data menjadi 5 bagian (fold).
Latih model dasar pada 4 fold dan validasi pada 1 fold.
Ulangi untuk setiap fold.
Kumpulkan prediksi dari model dasar untuk membuat dataset baru.</p>
<p>Meta k=7 untuk model meta:</p>
<p>Bagi dataset baru (prediksi dari model dasar) menjadi 7 bagian (fold).
Latih model meta pada 6 fold dan validasi pada 1 fold.
Ulangi untuk setiap fold.</p>
<p>Berikut adalah progrram untuk enseble stacking menggunakan knn:</p>
<p>PREDIKSI MENGGUNAKAN KNN K=3, K=5</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import library yang dibutuhkan</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsClassifier</span>

<span class="c1"># Membaca data dari file CSV</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;dataset_normalization.csv&#39;</span><span class="p">)</span>

<span class="c1"># Memisahkan data menjadi fitur (X) dan target (y)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># Jika targetnya disebut &#39;target&#39;</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span>

<span class="c1"># Normalisasi data menggunakan MinMaxScaler</span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">()</span>
<span class="n">X_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

<span class="c1"># Membagi data menjadi data pelatihan dan data pengujian</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X_scaled</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># Menampilkan data awal</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Data Awal:&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>

<span class="c1"># Menampilkan data yang telah dinormalisasi</span>
<span class="n">X_scaled_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_scaled</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Data yang telah dinormalisasi:&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">X_scaled_df</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>

<span class="c1"># Menampilkan data pelatihan dan pengujian</span>
<span class="n">X_train_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="n">X_test_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Data Pelatihan:&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">X_train_df</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Data Pengujian:&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">X_test_df</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>

<span class="c1"># Melatih model KNN dengan k=3 dan k=5</span>
<span class="n">knn_3</span> <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">knn_5</span> <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="n">knn_3</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">knn_5</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="c1"># Membuat prediksi untuk data pelatihan</span>
<span class="n">knn_3_predictions</span> <span class="o">=</span> <span class="n">knn_3</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">knn_5_predictions</span> <span class="o">=</span> <span class="n">knn_5</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>

<span class="c1"># Membuat DataFrame yang terdiri dari X_train, prediksi KNN k=3, prediksi KNN k=5, dan y_train</span>
<span class="n">hd_training_80</span> <span class="o">=</span> <span class="n">X_train_df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">hd_training_80</span><span class="p">[</span><span class="s1">&#39;knn_k3&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">knn_3_predictions</span>
<span class="n">hd_training_80</span><span class="p">[</span><span class="s1">&#39;knn_k5&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">knn_5_predictions</span>
<span class="n">hd_training_80</span><span class="p">[</span><span class="s1">&#39;y_train&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_train</span><span class="o">.</span><span class="n">values</span>

<span class="c1"># Menampilkan DataFrame hd_training_80</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Data Pelatihan dengan Prediksi KNN:&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">hd_training_80</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>

<span class="c1"># Menyimpan DataFrame ke file CSV</span>
<span class="c1"># hd_training_80.to_csv(&#39;hd_training_80.csv&#39;, index=False)</span>

<span class="c1"># Menampilkan pesan konfirmasi</span>
<span class="c1"># print(&quot;\nFile hd_training_80.csv telah disimpan.&quot;)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Data Awal:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>sex</th>
      <th>cp</th>
      <th>trestbps</th>
      <th>chol</th>
      <th>fbs</th>
      <th>restecg</th>
      <th>thalach</th>
      <th>exang</th>
      <th>oldpeak</th>
      <th>slope</th>
      <th>ca</th>
      <th>thal</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>63</td>
      <td>1</td>
      <td>1.000000</td>
      <td>145</td>
      <td>233</td>
      <td>1</td>
      <td>0.0</td>
      <td>150</td>
      <td>0</td>
      <td>2.3</td>
      <td>0.0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>37</td>
      <td>1</td>
      <td>0.666667</td>
      <td>130</td>
      <td>250</td>
      <td>0</td>
      <td>0.5</td>
      <td>187</td>
      <td>0</td>
      <td>3.5</td>
      <td>0.0</td>
      <td>0</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>41</td>
      <td>0</td>
      <td>0.333333</td>
      <td>130</td>
      <td>204</td>
      <td>0</td>
      <td>0.0</td>
      <td>172</td>
      <td>0</td>
      <td>1.4</td>
      <td>1.0</td>
      <td>0</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>56</td>
      <td>1</td>
      <td>0.333333</td>
      <td>120</td>
      <td>236</td>
      <td>0</td>
      <td>0.5</td>
      <td>178</td>
      <td>0</td>
      <td>0.8</td>
      <td>1.0</td>
      <td>0</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>57</td>
      <td>1</td>
      <td>0.000000</td>
      <td>140</td>
      <td>192</td>
      <td>0</td>
      <td>0.5</td>
      <td>148</td>
      <td>0</td>
      <td>0.4</td>
      <td>0.5</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Data yang telah dinormalisasi:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>sex</th>
      <th>cp</th>
      <th>trestbps</th>
      <th>chol</th>
      <th>fbs</th>
      <th>restecg</th>
      <th>thalach</th>
      <th>exang</th>
      <th>oldpeak</th>
      <th>slope</th>
      <th>ca</th>
      <th>thal</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.708333</td>
      <td>1.0</td>
      <td>1.000000</td>
      <td>0.481132</td>
      <td>0.387755</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.543860</td>
      <td>0.0</td>
      <td>0.370968</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.333333</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.166667</td>
      <td>1.0</td>
      <td>0.666667</td>
      <td>0.339623</td>
      <td>0.474490</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>0.868421</td>
      <td>0.0</td>
      <td>0.564516</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.666667</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.250000</td>
      <td>0.0</td>
      <td>0.333333</td>
      <td>0.339623</td>
      <td>0.239796</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.736842</td>
      <td>0.0</td>
      <td>0.225806</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.666667</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.562500</td>
      <td>1.0</td>
      <td>0.333333</td>
      <td>0.245283</td>
      <td>0.403061</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>0.789474</td>
      <td>0.0</td>
      <td>0.129032</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.666667</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.583333</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>0.433962</td>
      <td>0.178571</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>0.526316</td>
      <td>0.0</td>
      <td>0.064516</td>
      <td>0.5</td>
      <td>0.0</td>
      <td>0.333333</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Data Pelatihan:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>sex</th>
      <th>cp</th>
      <th>trestbps</th>
      <th>chol</th>
      <th>fbs</th>
      <th>restecg</th>
      <th>thalach</th>
      <th>exang</th>
      <th>oldpeak</th>
      <th>slope</th>
      <th>ca</th>
      <th>thal</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.354167</td>
      <td>0.0</td>
      <td>0.666667</td>
      <td>0.452830</td>
      <td>0.102041</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.631579</td>
      <td>1.0</td>
      <td>0.225806</td>
      <td>0.0</td>
      <td>0.00</td>
      <td>0.666667</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.687500</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.622642</td>
      <td>0.035714</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.500000</td>
      <td>0.0</td>
      <td>1.000000</td>
      <td>0.0</td>
      <td>0.75</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.562500</td>
      <td>1.0</td>
      <td>0.333333</td>
      <td>0.245283</td>
      <td>0.423469</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>0.710526</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.00</td>
      <td>0.666667</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.708333</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>0.339623</td>
      <td>0.882653</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.385965</td>
      <td>1.0</td>
      <td>0.290323</td>
      <td>1.0</td>
      <td>0.75</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.458333</td>
      <td>0.0</td>
      <td>0.666667</td>
      <td>0.433962</td>
      <td>0.770408</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.473684</td>
      <td>0.0</td>
      <td>0.241935</td>
      <td>1.0</td>
      <td>0.25</td>
      <td>0.666667</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Data Pengujian:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>sex</th>
      <th>cp</th>
      <th>trestbps</th>
      <th>chol</th>
      <th>fbs</th>
      <th>restecg</th>
      <th>thalach</th>
      <th>exang</th>
      <th>oldpeak</th>
      <th>slope</th>
      <th>ca</th>
      <th>thal</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.312500</td>
      <td>1.0</td>
      <td>0.333333</td>
      <td>0.339623</td>
      <td>0.316327</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.877193</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.00</td>
      <td>0.666667</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.250000</td>
      <td>1.0</td>
      <td>0.333333</td>
      <td>0.150943</td>
      <td>0.397959</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>0.570175</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.00</td>
      <td>0.666667</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.812500</td>
      <td>1.0</td>
      <td>0.666667</td>
      <td>0.226415</td>
      <td>0.612245</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>0.552632</td>
      <td>0.0</td>
      <td>0.161290</td>
      <td>1.0</td>
      <td>0.25</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.979167</td>
      <td>0.0</td>
      <td>0.666667</td>
      <td>0.433962</td>
      <td>0.204082</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.245614</td>
      <td>0.0</td>
      <td>0.177419</td>
      <td>0.5</td>
      <td>0.00</td>
      <td>0.666667</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.687500</td>
      <td>0.0</td>
      <td>0.666667</td>
      <td>0.339623</td>
      <td>0.540816</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>0.078947</td>
      <td>0.0</td>
      <td>0.193548</td>
      <td>0.5</td>
      <td>0.25</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Data Pelatihan dengan Prediksi KNN:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>sex</th>
      <th>cp</th>
      <th>trestbps</th>
      <th>chol</th>
      <th>fbs</th>
      <th>restecg</th>
      <th>thalach</th>
      <th>exang</th>
      <th>oldpeak</th>
      <th>slope</th>
      <th>ca</th>
      <th>thal</th>
      <th>knn_k3</th>
      <th>knn_k5</th>
      <th>y_train</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.354167</td>
      <td>0.0</td>
      <td>0.666667</td>
      <td>0.452830</td>
      <td>0.102041</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.631579</td>
      <td>1.0</td>
      <td>0.225806</td>
      <td>0.0</td>
      <td>0.00</td>
      <td>0.666667</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.687500</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.622642</td>
      <td>0.035714</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.500000</td>
      <td>0.0</td>
      <td>1.000000</td>
      <td>0.0</td>
      <td>0.75</td>
      <td>1.000000</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.562500</td>
      <td>1.0</td>
      <td>0.333333</td>
      <td>0.245283</td>
      <td>0.423469</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>0.710526</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.00</td>
      <td>0.666667</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.708333</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>0.339623</td>
      <td>0.882653</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.385965</td>
      <td>1.0</td>
      <td>0.290323</td>
      <td>1.0</td>
      <td>0.75</td>
      <td>1.000000</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.458333</td>
      <td>0.0</td>
      <td>0.666667</td>
      <td>0.433962</td>
      <td>0.770408</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.473684</td>
      <td>0.0</td>
      <td>0.241935</td>
      <td>1.0</td>
      <td>0.25</td>
      <td>0.666667</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>KESIMPULAN: pada tabel Data Pelatihan dengan Prediksi KNN, kolom knn_k3 dan knn_k5 sebagai x_train dan diprediksi targetnya  (menghasilkan prediksi dari K=3 dan prediksi dari k=5)dan y_train adalah target asli dari dataset</p>
<p>META K=7</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import library yang dibutuhkan</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsClassifier</span>

<span class="c1"># Membaca data dari file CSV</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;hd_training_80.csv&#39;</span><span class="p">)</span>

<span class="c1"># Memisahkan data menjadi fitur (X) dan target (y)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># Jika targetnya disebut &#39;target&#39;</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span>

<span class="c1"># Normalisasi data menggunakan MinMaxScaler</span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">()</span>
<span class="n">X_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

<span class="c1"># Membagi data menjadi data pelatihan dan data pengujian</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X_scaled</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># Menampilkan data awal</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Data Awal:&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>

<span class="c1"># Menampilkan data yang telah dinormalisasi</span>
<span class="n">X_scaled_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_scaled</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Data yang telah dinormalisasi:&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">X_scaled_df</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>

<span class="c1"># Menampilkan data pelatihan dan pengujian</span>
<span class="n">X_train_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="n">X_test_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Data Pelatihan:&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">X_train_df</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Data Pengujian:&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">X_test_df</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>

<span class="c1"># Melatih model KNN dengan k=7</span>
<span class="n">knn_7</span> <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="n">knn_7</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="c1"># Membuat prediksi untuk data pelatihan dengan k=7</span>
<span class="n">knn_7_predictions</span> <span class="o">=</span> <span class="n">knn_7</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>

<span class="c1"># Membuat DataFrame yang terdiri dari X_train, prediksi KNN k=7, dan y_train</span>
<span class="n">hd_meta</span> <span class="o">=</span> <span class="n">X_train_df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">hd_meta</span><span class="p">[</span><span class="s1">&#39;knn_k7&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">knn_7_predictions</span>
<span class="n">hd_meta</span><span class="p">[</span><span class="s1">&#39;y_train&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_train</span><span class="o">.</span><span class="n">values</span>

<span class="c1"># Menampilkan DataFrame hd_meta</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Data Pelatihan dengan Prediksi KNN k=7:&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">hd_meta</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>

<span class="c1"># Menyimpan DataFrame ke file CSV</span>
<span class="c1"># hd_meta.to_csv(&#39;hd_meta.csv&#39;, index=False)</span>

<span class="c1"># # Menampilkan pesan konfirmasi</span>
<span class="c1"># print(&quot;\nFile hd_meta.csv telah disimpan.&quot;)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Data Awal:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>sex</th>
      <th>cp</th>
      <th>trestbps</th>
      <th>chol</th>
      <th>fbs</th>
      <th>restecg</th>
      <th>thalach</th>
      <th>exang</th>
      <th>oldpeak</th>
      <th>slope</th>
      <th>ca</th>
      <th>thal</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>46</td>
      <td>0</td>
      <td>0.666667</td>
      <td>142</td>
      <td>177</td>
      <td>0</td>
      <td>0.0</td>
      <td>160</td>
      <td>1</td>
      <td>1.4</td>
      <td>0.0</td>
      <td>0</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>62</td>
      <td>0</td>
      <td>0.000000</td>
      <td>160</td>
      <td>164</td>
      <td>0</td>
      <td>0.0</td>
      <td>145</td>
      <td>0</td>
      <td>6.2</td>
      <td>0.0</td>
      <td>3</td>
      <td>3</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>56</td>
      <td>1</td>
      <td>0.333333</td>
      <td>120</td>
      <td>240</td>
      <td>0</td>
      <td>0.5</td>
      <td>169</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>63</td>
      <td>1</td>
      <td>0.000000</td>
      <td>130</td>
      <td>330</td>
      <td>1</td>
      <td>0.0</td>
      <td>132</td>
      <td>1</td>
      <td>1.8</td>
      <td>1.0</td>
      <td>3</td>
      <td>3</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>51</td>
      <td>0</td>
      <td>0.666667</td>
      <td>140</td>
      <td>308</td>
      <td>0</td>
      <td>0.0</td>
      <td>142</td>
      <td>0</td>
      <td>1.5</td>
      <td>1.0</td>
      <td>1</td>
      <td>2</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Data yang telah dinormalisasi:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>sex</th>
      <th>cp</th>
      <th>trestbps</th>
      <th>chol</th>
      <th>fbs</th>
      <th>restecg</th>
      <th>thalach</th>
      <th>exang</th>
      <th>oldpeak</th>
      <th>slope</th>
      <th>ca</th>
      <th>thal</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.279070</td>
      <td>0.0</td>
      <td>0.666667</td>
      <td>0.452830</td>
      <td>0.068783</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.679245</td>
      <td>1.0</td>
      <td>0.225806</td>
      <td>0.0</td>
      <td>0.00</td>
      <td>0.666667</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.651163</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.622642</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.537736</td>
      <td>0.0</td>
      <td>1.000000</td>
      <td>0.0</td>
      <td>0.75</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.511628</td>
      <td>1.0</td>
      <td>0.333333</td>
      <td>0.245283</td>
      <td>0.402116</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>0.764151</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.00</td>
      <td>0.666667</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.674419</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>0.339623</td>
      <td>0.878307</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.415094</td>
      <td>1.0</td>
      <td>0.290323</td>
      <td>1.0</td>
      <td>0.75</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.395349</td>
      <td>0.0</td>
      <td>0.666667</td>
      <td>0.433962</td>
      <td>0.761905</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.509434</td>
      <td>0.0</td>
      <td>0.241935</td>
      <td>1.0</td>
      <td>0.25</td>
      <td>0.666667</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Data Pelatihan:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>sex</th>
      <th>cp</th>
      <th>trestbps</th>
      <th>chol</th>
      <th>fbs</th>
      <th>restecg</th>
      <th>thalach</th>
      <th>exang</th>
      <th>oldpeak</th>
      <th>slope</th>
      <th>ca</th>
      <th>thal</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.395349</td>
      <td>1.0</td>
      <td>0.666667</td>
      <td>0.150943</td>
      <td>0.058201</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>0.330189</td>
      <td>0.0</td>
      <td>0.096774</td>
      <td>1.0</td>
      <td>0.00</td>
      <td>0.666667</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.395349</td>
      <td>1.0</td>
      <td>0.666667</td>
      <td>0.056604</td>
      <td>0.306878</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>0.518868</td>
      <td>1.0</td>
      <td>0.193548</td>
      <td>0.5</td>
      <td>0.00</td>
      <td>0.666667</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.232558</td>
      <td>1.0</td>
      <td>0.666667</td>
      <td>0.433962</td>
      <td>0.375661</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.867925</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.00</td>
      <td>0.666667</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.348837</td>
      <td>1.0</td>
      <td>0.666667</td>
      <td>0.245283</td>
      <td>0.126984</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>0.481132</td>
      <td>0.0</td>
      <td>0.322581</td>
      <td>0.5</td>
      <td>0.75</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.511628</td>
      <td>1.0</td>
      <td>0.333333</td>
      <td>0.339623</td>
      <td>0.301587</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.707547</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.00</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Data Pengujian:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>sex</th>
      <th>cp</th>
      <th>trestbps</th>
      <th>chol</th>
      <th>fbs</th>
      <th>restecg</th>
      <th>thalach</th>
      <th>exang</th>
      <th>oldpeak</th>
      <th>slope</th>
      <th>ca</th>
      <th>thal</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.511628</td>
      <td>1.0</td>
      <td>0.666667</td>
      <td>0.339623</td>
      <td>0.486772</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.509434</td>
      <td>1.0</td>
      <td>0.096774</td>
      <td>0.5</td>
      <td>0.25</td>
      <td>0.333333</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.581395</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>0.415094</td>
      <td>0.566138</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.886792</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.00</td>
      <td>0.666667</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.093023</td>
      <td>1.0</td>
      <td>0.666667</td>
      <td>0.415094</td>
      <td>0.058201</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>0.801887</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>1.00</td>
      <td>0.666667</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.232558</td>
      <td>1.0</td>
      <td>0.333333</td>
      <td>0.245283</td>
      <td>0.296296</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>0.773585</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.00</td>
      <td>0.666667</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.813953</td>
      <td>0.0</td>
      <td>1.000000</td>
      <td>0.433962</td>
      <td>0.396825</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>0.594340</td>
      <td>0.0</td>
      <td>0.290323</td>
      <td>1.0</td>
      <td>0.50</td>
      <td>0.666667</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Data Pelatihan dengan Prediksi KNN k=7:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>sex</th>
      <th>cp</th>
      <th>trestbps</th>
      <th>chol</th>
      <th>fbs</th>
      <th>restecg</th>
      <th>thalach</th>
      <th>exang</th>
      <th>oldpeak</th>
      <th>slope</th>
      <th>ca</th>
      <th>thal</th>
      <th>knn_k7</th>
      <th>y_train</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.395349</td>
      <td>1.0</td>
      <td>0.666667</td>
      <td>0.150943</td>
      <td>0.058201</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>0.330189</td>
      <td>0.0</td>
      <td>0.096774</td>
      <td>1.0</td>
      <td>0.00</td>
      <td>0.666667</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.395349</td>
      <td>1.0</td>
      <td>0.666667</td>
      <td>0.056604</td>
      <td>0.306878</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>0.518868</td>
      <td>1.0</td>
      <td>0.193548</td>
      <td>0.5</td>
      <td>0.00</td>
      <td>0.666667</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.232558</td>
      <td>1.0</td>
      <td>0.666667</td>
      <td>0.433962</td>
      <td>0.375661</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.867925</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.00</td>
      <td>0.666667</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.348837</td>
      <td>1.0</td>
      <td>0.666667</td>
      <td>0.245283</td>
      <td>0.126984</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>0.481132</td>
      <td>0.0</td>
      <td>0.322581</td>
      <td>0.5</td>
      <td>0.75</td>
      <td>1.000000</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.511628</td>
      <td>1.0</td>
      <td>0.333333</td>
      <td>0.339623</td>
      <td>0.301587</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.707547</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.00</td>
      <td>1.000000</td>
      <td>1</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="data-testing">
<h3>Data Testing<a class="headerlink" href="#data-testing" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import library yang dibutuhkan</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsClassifier</span>

<span class="c1"># Membaca data dari file CSV</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;hd_training_80.csv&#39;</span><span class="p">)</span>

<span class="c1"># Memisahkan data menjadi fitur (X) dan target (y)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># Jika targetnya disebut &#39;target&#39;</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span>

<span class="c1"># Normalisasi data menggunakan MinMaxScaler</span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">()</span>
<span class="n">X_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

<span class="c1"># Membagi data menjadi data pelatihan dan data pengujian</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X_scaled</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># Menampilkan data awal</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Data Awal:&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>

<span class="c1"># Menampilkan data yang telah dinormalisasi</span>
<span class="n">X_scaled_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_scaled</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Data yang telah dinormalisasi:&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">X_scaled_df</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>

<span class="c1"># Menampilkan data pelatihan dan pengujian</span>
<span class="n">X_train_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="n">X_test_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Data Pelatihan:&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">X_train_df</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Data Pengujian:&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">X_test_df</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>

<span class="c1"># Melatih model KNN dengan k=7</span>
<span class="n">knn_7</span> <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="n">knn_7</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="c1"># Membuat prediksi untuk data pelatihan dan data pengujian dengan k=7</span>
<span class="n">knn_7_predictions_train</span> <span class="o">=</span> <span class="n">knn_7</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">knn_7_predictions_test</span> <span class="o">=</span> <span class="n">knn_7</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="c1"># Membuat DataFrame yang terdiri dari X_train, prediksi KNN k=7 untuk pelatihan, dan y_train</span>
<span class="n">hd_meta_train</span> <span class="o">=</span> <span class="n">X_train_df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">hd_meta_train</span><span class="p">[</span><span class="s1">&#39;knn_k7_train&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">knn_7_predictions_train</span>
<span class="n">hd_meta_train</span><span class="p">[</span><span class="s1">&#39;y_train&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_train</span><span class="o">.</span><span class="n">values</span>

<span class="c1"># Membuat DataFrame yang terdiri dari X_test, prediksi KNN k=7 untuk pengujian, dan y_test</span>
<span class="n">hd_meta_test</span> <span class="o">=</span> <span class="n">X_test_df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">hd_meta_test</span><span class="p">[</span><span class="s1">&#39;knn_k7_test&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">knn_7_predictions_test</span>
<span class="n">hd_meta_test</span><span class="p">[</span><span class="s1">&#39;y_test&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_test</span><span class="o">.</span><span class="n">values</span>

<span class="c1"># Menampilkan DataFrame hd_meta_train untuk pelatihan</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Data Pelatihan dengan Prediksi KNN k=7:&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">hd_meta_train</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>

<span class="c1"># Menampilkan DataFrame hd_meta_test untuk pengujian</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Data Pengujian dengan Prediksi KNN k=7:&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">hd_meta_test</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Data Awal:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>sex</th>
      <th>cp</th>
      <th>trestbps</th>
      <th>chol</th>
      <th>fbs</th>
      <th>restecg</th>
      <th>thalach</th>
      <th>exang</th>
      <th>oldpeak</th>
      <th>slope</th>
      <th>ca</th>
      <th>thal</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>46</td>
      <td>0</td>
      <td>0.666667</td>
      <td>142</td>
      <td>177</td>
      <td>0</td>
      <td>0.0</td>
      <td>160</td>
      <td>1</td>
      <td>1.4</td>
      <td>0.0</td>
      <td>0</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>62</td>
      <td>0</td>
      <td>0.000000</td>
      <td>160</td>
      <td>164</td>
      <td>0</td>
      <td>0.0</td>
      <td>145</td>
      <td>0</td>
      <td>6.2</td>
      <td>0.0</td>
      <td>3</td>
      <td>3</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>56</td>
      <td>1</td>
      <td>0.333333</td>
      <td>120</td>
      <td>240</td>
      <td>0</td>
      <td>0.5</td>
      <td>169</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>63</td>
      <td>1</td>
      <td>0.000000</td>
      <td>130</td>
      <td>330</td>
      <td>1</td>
      <td>0.0</td>
      <td>132</td>
      <td>1</td>
      <td>1.8</td>
      <td>1.0</td>
      <td>3</td>
      <td>3</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>51</td>
      <td>0</td>
      <td>0.666667</td>
      <td>140</td>
      <td>308</td>
      <td>0</td>
      <td>0.0</td>
      <td>142</td>
      <td>0</td>
      <td>1.5</td>
      <td>1.0</td>
      <td>1</td>
      <td>2</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Data yang telah dinormalisasi:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>sex</th>
      <th>cp</th>
      <th>trestbps</th>
      <th>chol</th>
      <th>fbs</th>
      <th>restecg</th>
      <th>thalach</th>
      <th>exang</th>
      <th>oldpeak</th>
      <th>slope</th>
      <th>ca</th>
      <th>thal</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.279070</td>
      <td>0.0</td>
      <td>0.666667</td>
      <td>0.452830</td>
      <td>0.068783</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.679245</td>
      <td>1.0</td>
      <td>0.225806</td>
      <td>0.0</td>
      <td>0.00</td>
      <td>0.666667</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.651163</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.622642</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.537736</td>
      <td>0.0</td>
      <td>1.000000</td>
      <td>0.0</td>
      <td>0.75</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.511628</td>
      <td>1.0</td>
      <td>0.333333</td>
      <td>0.245283</td>
      <td>0.402116</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>0.764151</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.00</td>
      <td>0.666667</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.674419</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>0.339623</td>
      <td>0.878307</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.415094</td>
      <td>1.0</td>
      <td>0.290323</td>
      <td>1.0</td>
      <td>0.75</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.395349</td>
      <td>0.0</td>
      <td>0.666667</td>
      <td>0.433962</td>
      <td>0.761905</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.509434</td>
      <td>0.0</td>
      <td>0.241935</td>
      <td>1.0</td>
      <td>0.25</td>
      <td>0.666667</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Data Pelatihan:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>sex</th>
      <th>cp</th>
      <th>trestbps</th>
      <th>chol</th>
      <th>fbs</th>
      <th>restecg</th>
      <th>thalach</th>
      <th>exang</th>
      <th>oldpeak</th>
      <th>slope</th>
      <th>ca</th>
      <th>thal</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.395349</td>
      <td>1.0</td>
      <td>0.666667</td>
      <td>0.150943</td>
      <td>0.058201</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>0.330189</td>
      <td>0.0</td>
      <td>0.096774</td>
      <td>1.0</td>
      <td>0.00</td>
      <td>0.666667</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.395349</td>
      <td>1.0</td>
      <td>0.666667</td>
      <td>0.056604</td>
      <td>0.306878</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>0.518868</td>
      <td>1.0</td>
      <td>0.193548</td>
      <td>0.5</td>
      <td>0.00</td>
      <td>0.666667</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.232558</td>
      <td>1.0</td>
      <td>0.666667</td>
      <td>0.433962</td>
      <td>0.375661</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.867925</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.00</td>
      <td>0.666667</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.348837</td>
      <td>1.0</td>
      <td>0.666667</td>
      <td>0.245283</td>
      <td>0.126984</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>0.481132</td>
      <td>0.0</td>
      <td>0.322581</td>
      <td>0.5</td>
      <td>0.75</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.511628</td>
      <td>1.0</td>
      <td>0.333333</td>
      <td>0.339623</td>
      <td>0.301587</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.707547</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.00</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Data Pengujian:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>sex</th>
      <th>cp</th>
      <th>trestbps</th>
      <th>chol</th>
      <th>fbs</th>
      <th>restecg</th>
      <th>thalach</th>
      <th>exang</th>
      <th>oldpeak</th>
      <th>slope</th>
      <th>ca</th>
      <th>thal</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.511628</td>
      <td>1.0</td>
      <td>0.666667</td>
      <td>0.339623</td>
      <td>0.486772</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.509434</td>
      <td>1.0</td>
      <td>0.096774</td>
      <td>0.5</td>
      <td>0.25</td>
      <td>0.333333</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.581395</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>0.415094</td>
      <td>0.566138</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.886792</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.00</td>
      <td>0.666667</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.093023</td>
      <td>1.0</td>
      <td>0.666667</td>
      <td>0.415094</td>
      <td>0.058201</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>0.801887</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>1.00</td>
      <td>0.666667</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.232558</td>
      <td>1.0</td>
      <td>0.333333</td>
      <td>0.245283</td>
      <td>0.296296</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>0.773585</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.00</td>
      <td>0.666667</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.813953</td>
      <td>0.0</td>
      <td>1.000000</td>
      <td>0.433962</td>
      <td>0.396825</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>0.594340</td>
      <td>0.0</td>
      <td>0.290323</td>
      <td>1.0</td>
      <td>0.50</td>
      <td>0.666667</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Data Pelatihan dengan Prediksi KNN k=7:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>sex</th>
      <th>cp</th>
      <th>trestbps</th>
      <th>chol</th>
      <th>fbs</th>
      <th>restecg</th>
      <th>thalach</th>
      <th>exang</th>
      <th>oldpeak</th>
      <th>slope</th>
      <th>ca</th>
      <th>thal</th>
      <th>knn_k7_train</th>
      <th>y_train</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.395349</td>
      <td>1.0</td>
      <td>0.666667</td>
      <td>0.150943</td>
      <td>0.058201</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>0.330189</td>
      <td>0.0</td>
      <td>0.096774</td>
      <td>1.0</td>
      <td>0.00</td>
      <td>0.666667</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.395349</td>
      <td>1.0</td>
      <td>0.666667</td>
      <td>0.056604</td>
      <td>0.306878</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>0.518868</td>
      <td>1.0</td>
      <td>0.193548</td>
      <td>0.5</td>
      <td>0.00</td>
      <td>0.666667</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.232558</td>
      <td>1.0</td>
      <td>0.666667</td>
      <td>0.433962</td>
      <td>0.375661</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.867925</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.00</td>
      <td>0.666667</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.348837</td>
      <td>1.0</td>
      <td>0.666667</td>
      <td>0.245283</td>
      <td>0.126984</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>0.481132</td>
      <td>0.0</td>
      <td>0.322581</td>
      <td>0.5</td>
      <td>0.75</td>
      <td>1.000000</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.511628</td>
      <td>1.0</td>
      <td>0.333333</td>
      <td>0.339623</td>
      <td>0.301587</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.707547</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.00</td>
      <td>1.000000</td>
      <td>1</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Data Pengujian dengan Prediksi KNN k=7:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>sex</th>
      <th>cp</th>
      <th>trestbps</th>
      <th>chol</th>
      <th>fbs</th>
      <th>restecg</th>
      <th>thalach</th>
      <th>exang</th>
      <th>oldpeak</th>
      <th>slope</th>
      <th>ca</th>
      <th>thal</th>
      <th>knn_k7_test</th>
      <th>y_test</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.511628</td>
      <td>1.0</td>
      <td>0.666667</td>
      <td>0.339623</td>
      <td>0.486772</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.509434</td>
      <td>1.0</td>
      <td>0.096774</td>
      <td>0.5</td>
      <td>0.25</td>
      <td>0.333333</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.581395</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>0.415094</td>
      <td>0.566138</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.886792</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.00</td>
      <td>0.666667</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.093023</td>
      <td>1.0</td>
      <td>0.666667</td>
      <td>0.415094</td>
      <td>0.058201</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>0.801887</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>1.00</td>
      <td>0.666667</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.232558</td>
      <td>1.0</td>
      <td>0.333333</td>
      <td>0.245283</td>
      <td>0.296296</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>0.773585</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.00</td>
      <td>0.666667</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.813953</td>
      <td>0.0</td>
      <td>1.000000</td>
      <td>0.433962</td>
      <td>0.396825</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>0.594340</td>
      <td>0.0</td>
      <td>0.290323</td>
      <td>1.0</td>
      <td>0.50</td>
      <td>0.666667</td>
      <td>1</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span>

<span class="c1"># Melatih model KNN dengan k=7</span>
<span class="n">knn_7</span> <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="n">knn_7</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="c1"># Membuat prediksi untuk data training dan data testing dengan k=7</span>
<span class="n">knn_7_predictions_train</span> <span class="o">=</span> <span class="n">knn_7</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">knn_7_predictions_test</span> <span class="o">=</span> <span class="n">knn_7</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="c1"># Menghitung keakuratan untuk data training</span>
<span class="n">accuracy_train</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">knn_7_predictions_train</span><span class="p">)</span>

<span class="c1"># Menghitung keakuratan untuk data testing</span>
<span class="n">accuracy_test</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">knn_7_predictions_test</span><span class="p">)</span>

<span class="c1"># Menampilkan keakuratan</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Akurasi Data Training: </span><span class="si">{</span><span class="n">accuracy_train</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Akurasi Data Testing: </span><span class="si">{</span><span class="n">accuracy_test</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Akurasi Data Training: 0.83
Akurasi Data Testing: 0.70
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="ensemble-bagging">
<h2>Ensemble Bagging<a class="headerlink" href="#ensemble-bagging" title="Link to this heading">#</a></h2>
<p>Ensemble bagging, yang merupakan singkatan dari Bootstrap Aggregating, adalah teknik ensemble dalam pembelajaran mesin yang dirancang untuk meningkatkan akurasi dan ketahanan model dengan menggabungkan beberapa instance dari algoritma pembelajaran yang sama. Dengan menggabungkan prediksi dari beberapa model yang dilatih pada subset data yang berbeda, teknik ini dapat secara signifikan mengurangi overfitting dan meningkatkan akurasi prediksi.</p>
<section id="id2">
<h3>Menampilkan Data<a class="headerlink" href="#id2" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import library yang dibutuhkan</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsClassifier</span>

<span class="c1"># Membaca data dari file CSV</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;hd_training_80.csv&#39;</span><span class="p">)</span>

<span class="c1"># Memisahkan data menjadi fitur (X) dan target (y)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># Jika targetnya disebut &#39;target&#39;</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span>

<span class="c1"># Normalisasi data menggunakan MinMaxScaler</span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">()</span>
<span class="n">X_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

<span class="c1"># Membagi data menjadi data pelatihan dan data pengujian</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X_scaled</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># Menampilkan data awal</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Data Awal:&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>

<span class="c1"># Menampilkan data yang telah dinormalisasi</span>
<span class="n">X_scaled_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_scaled</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Data yang telah dinormalisasi:&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">X_scaled_df</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>

<span class="c1"># Menampilkan data pelatihan dan pengujian</span>
<span class="n">X_train_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="n">X_test_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Data Pelatihan:&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">X_train_df</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Data Pengujian:&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">X_test_df</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Data Awal:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>sex</th>
      <th>cp</th>
      <th>trestbps</th>
      <th>chol</th>
      <th>fbs</th>
      <th>restecg</th>
      <th>thalach</th>
      <th>exang</th>
      <th>oldpeak</th>
      <th>slope</th>
      <th>ca</th>
      <th>thal</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>46</td>
      <td>0</td>
      <td>0.666667</td>
      <td>142</td>
      <td>177</td>
      <td>0</td>
      <td>0.0</td>
      <td>160</td>
      <td>1</td>
      <td>1.4</td>
      <td>0.0</td>
      <td>0</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>62</td>
      <td>0</td>
      <td>0.000000</td>
      <td>160</td>
      <td>164</td>
      <td>0</td>
      <td>0.0</td>
      <td>145</td>
      <td>0</td>
      <td>6.2</td>
      <td>0.0</td>
      <td>3</td>
      <td>3</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>56</td>
      <td>1</td>
      <td>0.333333</td>
      <td>120</td>
      <td>240</td>
      <td>0</td>
      <td>0.5</td>
      <td>169</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>63</td>
      <td>1</td>
      <td>0.000000</td>
      <td>130</td>
      <td>330</td>
      <td>1</td>
      <td>0.0</td>
      <td>132</td>
      <td>1</td>
      <td>1.8</td>
      <td>1.0</td>
      <td>3</td>
      <td>3</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>51</td>
      <td>0</td>
      <td>0.666667</td>
      <td>140</td>
      <td>308</td>
      <td>0</td>
      <td>0.0</td>
      <td>142</td>
      <td>0</td>
      <td>1.5</td>
      <td>1.0</td>
      <td>1</td>
      <td>2</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Data yang telah dinormalisasi:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>sex</th>
      <th>cp</th>
      <th>trestbps</th>
      <th>chol</th>
      <th>fbs</th>
      <th>restecg</th>
      <th>thalach</th>
      <th>exang</th>
      <th>oldpeak</th>
      <th>slope</th>
      <th>ca</th>
      <th>thal</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.279070</td>
      <td>0.0</td>
      <td>0.666667</td>
      <td>0.452830</td>
      <td>0.068783</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.679245</td>
      <td>1.0</td>
      <td>0.225806</td>
      <td>0.0</td>
      <td>0.00</td>
      <td>0.666667</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.651163</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.622642</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.537736</td>
      <td>0.0</td>
      <td>1.000000</td>
      <td>0.0</td>
      <td>0.75</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.511628</td>
      <td>1.0</td>
      <td>0.333333</td>
      <td>0.245283</td>
      <td>0.402116</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>0.764151</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.00</td>
      <td>0.666667</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.674419</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>0.339623</td>
      <td>0.878307</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.415094</td>
      <td>1.0</td>
      <td>0.290323</td>
      <td>1.0</td>
      <td>0.75</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.395349</td>
      <td>0.0</td>
      <td>0.666667</td>
      <td>0.433962</td>
      <td>0.761905</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.509434</td>
      <td>0.0</td>
      <td>0.241935</td>
      <td>1.0</td>
      <td>0.25</td>
      <td>0.666667</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Data Pelatihan:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>sex</th>
      <th>cp</th>
      <th>trestbps</th>
      <th>chol</th>
      <th>fbs</th>
      <th>restecg</th>
      <th>thalach</th>
      <th>exang</th>
      <th>oldpeak</th>
      <th>slope</th>
      <th>ca</th>
      <th>thal</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.395349</td>
      <td>1.0</td>
      <td>0.666667</td>
      <td>0.150943</td>
      <td>0.058201</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>0.330189</td>
      <td>0.0</td>
      <td>0.096774</td>
      <td>1.0</td>
      <td>0.00</td>
      <td>0.666667</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.395349</td>
      <td>1.0</td>
      <td>0.666667</td>
      <td>0.056604</td>
      <td>0.306878</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>0.518868</td>
      <td>1.0</td>
      <td>0.193548</td>
      <td>0.5</td>
      <td>0.00</td>
      <td>0.666667</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.232558</td>
      <td>1.0</td>
      <td>0.666667</td>
      <td>0.433962</td>
      <td>0.375661</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.867925</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.00</td>
      <td>0.666667</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.348837</td>
      <td>1.0</td>
      <td>0.666667</td>
      <td>0.245283</td>
      <td>0.126984</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>0.481132</td>
      <td>0.0</td>
      <td>0.322581</td>
      <td>0.5</td>
      <td>0.75</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.511628</td>
      <td>1.0</td>
      <td>0.333333</td>
      <td>0.339623</td>
      <td>0.301587</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.707547</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.00</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Data Pengujian:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>sex</th>
      <th>cp</th>
      <th>trestbps</th>
      <th>chol</th>
      <th>fbs</th>
      <th>restecg</th>
      <th>thalach</th>
      <th>exang</th>
      <th>oldpeak</th>
      <th>slope</th>
      <th>ca</th>
      <th>thal</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.511628</td>
      <td>1.0</td>
      <td>0.666667</td>
      <td>0.339623</td>
      <td>0.486772</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.509434</td>
      <td>1.0</td>
      <td>0.096774</td>
      <td>0.5</td>
      <td>0.25</td>
      <td>0.333333</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.581395</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>0.415094</td>
      <td>0.566138</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.886792</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.00</td>
      <td>0.666667</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.093023</td>
      <td>1.0</td>
      <td>0.666667</td>
      <td>0.415094</td>
      <td>0.058201</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>0.801887</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>1.00</td>
      <td>0.666667</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.232558</td>
      <td>1.0</td>
      <td>0.333333</td>
      <td>0.245283</td>
      <td>0.296296</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>0.773585</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.00</td>
      <td>0.666667</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.813953</td>
      <td>0.0</td>
      <td>1.000000</td>
      <td>0.433962</td>
      <td>0.396825</td>
      <td>0.0</td>
      <td>0.5</td>
      <td>0.594340</td>
      <td>0.0</td>
      <td>0.290323</td>
      <td>1.0</td>
      <td>0.50</td>
      <td>0.666667</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="memprediksi-menggunakan-ensemble-bagging-n-estimators-in-range-3-10">
<h3>Memprediksi Menggunakan Ensemble Bagging (n_estimators in range 3-10)<a class="headerlink" href="#memprediksi-menggunakan-ensemble-bagging-n-estimators-in-range-3-10" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>  <span class="c1"># Import pandas untuk manipulasi data</span>
<span class="kn">from</span> <span class="nn">sklearn.naive_bayes</span> <span class="kn">import</span> <span class="n">GaussianNB</span>  <span class="c1"># Import Gaussian Naive Bayes dari scikit-learn</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">BaggingClassifier</span>  <span class="c1"># Import BaggingClassifier dari scikit-learn</span>

<span class="c1"># Load the dataset</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;hd_training_80.csv&#39;</span><span class="p">)</span>  <span class="c1"># Membaca dataset dari file CSV</span>

<span class="c1"># Assuming the last column is the target</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># Memisahkan fitur (semua kolom kecuali kolom terakhir)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># Memisahkan target (kolom terakhir)</span>

<span class="c1"># Check if the dataset loaded correctly</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Dataset head:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>  <span class="c1"># Menampilkan 5 baris pertama dataset untuk memeriksa apakah data dimuat dengan benar</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Features shape:&quot;</span><span class="p">,</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># Menampilkan bentuk (shape) dari fitur</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Target shape:&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># Menampilkan bentuk (shape) dari target</span>

<span class="c1"># Sample input for prediction (with placeholders for the remaining features)</span>
<span class="n">sample_input</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.0582010582</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.3301886792</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.09677419355</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.6666666667</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>  <span class="c1"># Input sampel untuk prediksi</span>

<span class="c1"># Ensure the sample input has the correct number of features</span>
<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sample_input</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">!=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>  <span class="c1"># Memastikan jumlah fitur dalam input sampel sesuai dengan jumlah fitur dalam dataset</span>
    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sample input must have </span><span class="si">{</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2"> features, but got </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">sample_input</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="si">}</span><span class="s2"> features.&quot;</span><span class="p">)</span>  <span class="c1"># Mengangkat error jika jumlah fitur tidak sesuai</span>

<span class="c1"># Convert sample_input to DataFrame with same columns as X</span>
<span class="n">sample_input_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">sample_input</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>  <span class="c1"># Mengonversi input sampel menjadi DataFrame dengan kolom yang sama seperti X</span>

<span class="c1"># Loop through n_estimators from 3 to 10</span>
<span class="k">for</span> <span class="n">n_estimators</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">11</span><span class="p">):</span>  <span class="c1"># Melakukan loop untuk jumlah estimator dari 3 hingga 10</span>
    <span class="c1"># Create and train the BaggingClassifier with a Naive Bayes estimator</span>
    <span class="n">clf</span> <span class="o">=</span> <span class="n">BaggingClassifier</span><span class="p">(</span><span class="n">base_estimator</span><span class="o">=</span><span class="n">GaussianNB</span><span class="p">(),</span>  <span class="c1"># Membuat BaggingClassifier dengan GaussianNB sebagai estimator dasar</span>
                            <span class="n">n_estimators</span><span class="o">=</span><span class="n">n_estimators</span><span class="p">,</span>  <span class="c1"># Mengatur jumlah estimator</span>
                            <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>  <span class="c1"># Melatih model dengan data</span>

    <span class="c1"># Make a prediction</span>
    <span class="n">prediction</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">sample_input_df</span><span class="p">)</span>  <span class="c1"># Membuat prediksi berdasarkan input sampel</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Prediction with n_estimators=</span><span class="si">{</span><span class="n">n_estimators</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="n">prediction</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>  <span class="c1"># Mencetak prediksi untuk jumlah estimator tertentu</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Dataset head:
    age  sex        cp  trestbps  chol  fbs  restecg  thalach  exang  oldpeak  \
0   46    0  0.666667       142   177    0      0.0      160      1      1.4   
1   62    0  0.000000       160   164    0      0.0      145      0      6.2   
2   56    1  0.333333       120   240    0      0.5      169      0      0.0   
3   63    1  0.000000       130   330    1      0.0      132      1      1.8   
4   51    0  0.666667       140   308    0      0.0      142      0      1.5   

   slope  ca  thal  target  
0    0.0   0     2       1  
1    0.0   3     3       0  
2    0.0   0     2       1  
3    1.0   3     3       0  
4    1.0   1     2       1  
Features shape: (217, 13)
Target shape: (217,)
Prediction with n_estimators=3: [0]
Prediction with n_estimators=4: [0]
Prediction with n_estimators=5: [0]
Prediction with n_estimators=6: [0]
Prediction with n_estimators=7: [0]
Prediction with n_estimators=8: [0]
Prediction with n_estimators=9: [0]
Prediction with n_estimators=10: [0]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>  <span class="c1"># Import pandas untuk manipulasi data</span>
<span class="kn">from</span> <span class="nn">sklearn.naive_bayes</span> <span class="kn">import</span> <span class="n">GaussianNB</span>  <span class="c1"># Import Gaussian Naive Bayes dari scikit-learn</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">BaggingClassifier</span>  <span class="c1"># Import BaggingClassifier dari scikit-learn</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>  <span class="c1"># Import train_test_split untuk membagi dataset</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span>  <span class="c1"># Import accuracy_score untuk menghitung akurasi</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>  <span class="c1"># Import matplotlib untuk visualisasi</span>

<span class="c1"># Load the dataset</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;hd_training_80.csv&#39;</span><span class="p">)</span>  <span class="c1"># Membaca dataset dari file CSV</span>

<span class="c1"># Assuming the last column is the target</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># Memisahkan fitur (semua kolom kecuali kolom terakhir)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># Memisahkan target (kolom terakhir)</span>

<span class="c1"># Split the dataset into training and testing sets</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># Membagi dataset menjadi set pelatihan dan pengujian dengan rasio 80:20</span>

<span class="c1"># Initialize lists to store the number of estimators and corresponding accuracies</span>
<span class="n">estimators</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">11</span><span class="p">))</span>  <span class="c1"># Membuat daftar jumlah estimator dari 3 hingga 10</span>
<span class="n">accuracies</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># Inisialisasi list untuk menyimpan akurasi</span>

<span class="c1"># Loop through n_estimators from 3 to 10</span>
<span class="k">for</span> <span class="n">n_estimators</span> <span class="ow">in</span> <span class="n">estimators</span><span class="p">:</span>  <span class="c1"># Loop melalui jumlah estimator dari 3 hingga 10</span>
    <span class="c1"># Create and train the BaggingClassifier with a Naive Bayes estimator</span>
    <span class="n">clf</span> <span class="o">=</span> <span class="n">BaggingClassifier</span><span class="p">(</span><span class="n">base_estimator</span><span class="o">=</span><span class="n">GaussianNB</span><span class="p">(),</span>  <span class="c1"># Membuat BaggingClassifier dengan GaussianNB sebagai estimator dasar</span>
                            <span class="n">n_estimators</span><span class="o">=</span><span class="n">n_estimators</span><span class="p">,</span>  <span class="c1"># Mengatur jumlah estimator</span>
                            <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>  <span class="c1"># Melatih model dengan data pelatihan</span>
    
    <span class="c1"># Make predictions on the testing set</span>
    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>  <span class="c1"># Membuat prediksi pada data pengujian</span>
    
    <span class="c1"># Calculate accuracy and store it</span>
    <span class="n">accuracy</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>  <span class="c1"># Menghitung akurasi prediksi</span>
    <span class="n">accuracies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">accuracy</span><span class="p">)</span>  <span class="c1"># Menyimpan akurasi ke dalam list</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Accuracy with n_estimators=</span><span class="si">{</span><span class="n">n_estimators</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="n">accuracy</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>  <span class="c1"># Mencetak akurasi untuk jumlah estimator tertentu</span>

<span class="c1"># Plot the accuracies</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>  <span class="c1"># Membuat figure dengan ukuran tertentu</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">estimators</span><span class="p">,</span> <span class="n">accuracies</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>  <span class="c1"># Membuat plot akurasi vs jumlah estimator</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Number of Estimators&#39;</span><span class="p">)</span>  <span class="c1"># Menambahkan label sumbu x</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Accuracy&#39;</span><span class="p">)</span>  <span class="c1"># Menambahkan label sumbu y</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Bagging Classifier Accuracy vs. Number of Estimators&#39;</span><span class="p">)</span>  <span class="c1"># Menambahkan judul plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># Mengatur batas sumbu y dari 0 hingga 1</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># Menambahkan grid pada plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>  <span class="c1"># Menampilkan plot</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Accuracy with n_estimators=3: 0.8864
Accuracy with n_estimators=4: 0.8636
Accuracy with n_estimators=5: 0.8864
Accuracy with n_estimators=6: 0.9318
Accuracy with n_estimators=7: 0.9318
Accuracy with n_estimators=8: 0.9318
Accuracy with n_estimators=9: 0.9318
Accuracy with n_estimators=10: 0.8864
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/5e55447bae4e01d6ff0a9b5e60cd0598eed6bf42e6665255bcb66e5c7f400e0d.png"><img alt="_images/5e55447bae4e01d6ff0a9b5e60cd0598eed6bf42e6665255bcb66e5c7f400e0d.png" src="_images/5e55447bae4e01d6ff0a9b5e60cd0598eed6bf42e6665255bcb66e5c7f400e0d.png" style="width: 846px; height: 547px;" /></a>
</div>
</div>
<p>Menggunakan Data  Testing 20%</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">sklearn.naive_bayes</span> <span class="kn">import</span> <span class="n">GaussianNB</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">BaggingClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Load the training and testing datasets</span>
<span class="n">train_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;hd_training_80.csv&#39;</span><span class="p">)</span>
<span class="n">test_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;hd_testing_20.csv&#39;</span><span class="p">)</span>

<span class="c1"># Assuming the last column is the target</span>
<span class="n">X_train</span> <span class="o">=</span> <span class="n">train_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">y_train</span> <span class="o">=</span> <span class="n">train_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">test_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">y_test</span> <span class="o">=</span> <span class="n">test_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<span class="c1"># Extract feature names</span>
<span class="n">feature_names</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">columns</span>

<span class="c1"># Sample input for prediction with correct feature names</span>
<span class="n">sample_input</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="mf">0.0582010582</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.3301886792</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.09677419355</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.6666666667</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span> <span class="n">columns</span><span class="o">=</span><span class="n">feature_names</span><span class="p">)</span>

<span class="c1"># Initialize lists to store the number of estimators and corresponding accuracies</span>
<span class="n">estimators</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">20</span><span class="p">))</span>
<span class="n">accuracies</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># Loop through n_estimators from 3 to 10</span>
<span class="k">for</span> <span class="n">n_estimators</span> <span class="ow">in</span> <span class="n">estimators</span><span class="p">:</span>
    <span class="c1"># Create and train the BaggingClassifier with a Naive Bayes estimator</span>
    <span class="n">clf</span> <span class="o">=</span> <span class="n">BaggingClassifier</span><span class="p">(</span><span class="n">base_estimator</span><span class="o">=</span><span class="n">GaussianNB</span><span class="p">(),</span>
                            <span class="n">n_estimators</span><span class="o">=</span><span class="n">n_estimators</span><span class="p">,</span>
                            <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    
    <span class="c1"># Make a prediction</span>
    <span class="n">prediction</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">sample_input</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Prediction with n_estimators=</span><span class="si">{</span><span class="n">n_estimators</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="n">prediction</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    
    <span class="c1"># Evaluate the model on the testing set</span>
    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
    <span class="n">accuracy</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
    <span class="n">accuracies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">accuracy</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Accuracy with n_estimators=</span><span class="si">{</span><span class="n">n_estimators</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="n">accuracy</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1"># Plot the accuracies</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">estimators</span><span class="p">,</span> <span class="n">accuracies</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Number of Estimators&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Accuracy&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Bagging Classifier Accuracy vs. Number of Estimators&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Prediction with n_estimators=3: [0]
Accuracy with n_estimators=3: 0.8000
Prediction with n_estimators=4: [0]
Accuracy with n_estimators=4: 0.8000
Prediction with n_estimators=5: [0]
Accuracy with n_estimators=5: 0.8000
Prediction with n_estimators=6: [0]
Accuracy with n_estimators=6: 0.8000
Prediction with n_estimators=7: [0]
Accuracy with n_estimators=7: 0.8182
Prediction with n_estimators=8: [0]
Accuracy with n_estimators=8: 0.8182
Prediction with n_estimators=9: [0]
Accuracy with n_estimators=9: 0.8182
Prediction with n_estimators=10: [0]
Accuracy with n_estimators=10: 0.8364
Prediction with n_estimators=11: [0]
Accuracy with n_estimators=11: 0.8182
Prediction with n_estimators=12: [0]
Accuracy with n_estimators=12: 0.8182
Prediction with n_estimators=13: [0]
Accuracy with n_estimators=13: 0.8364
Prediction with n_estimators=14: [0]
Accuracy with n_estimators=14: 0.8364
Prediction with n_estimators=15: [0]
Accuracy with n_estimators=15: 0.8364
Prediction with n_estimators=16: [0]
Accuracy with n_estimators=16: 0.8364
Prediction with n_estimators=17: [0]
Accuracy with n_estimators=17: 0.8364
Prediction with n_estimators=18: [0]
Accuracy with n_estimators=18: 0.8364
Prediction with n_estimators=19: [0]
Accuracy with n_estimators=19: 0.8364
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/3b652356e864182e92de7988bdfdbbc6570eb23b0d186b78706405e88ef2898c.png"><img alt="_images/3b652356e864182e92de7988bdfdbbc6570eb23b0d186b78706405e88ef2898c.png" src="_images/3b652356e864182e92de7988bdfdbbc6570eb23b0d186b78706405e88ef2898c.png" style="width: 846px; height: 547px;" /></a>
</div>
</div>
<p>Kesimpulan: prediksi tertinggi itu menggunakan n_estimator= 10, dimana nilai yang dihasilkan paling tinggi dari n_enstimator sebelum-sebelumnya.</p>
</section>
</section>
<section id="pembuatan-website-atau-aplikasi">
<h2>Pembuatan Website atau Aplikasi<a class="headerlink" href="#pembuatan-website-atau-aplikasi" title="Link to this heading">#</a></h2>
<p>Untuk pembuatan website kami menggunakan pickle, yang setelah data ditraining dapat disimpan ke dalam file menggunakan library Pickle. Maka dapatlah website yang dapat memprediksi diagnosa penyakit jantung.</p>
<section id="pickle">
<h3>Pickle<a class="headerlink" href="#pickle" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import library yang dibutuhkan</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">pickle</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span><span class="p">,</span> <span class="n">GridSearchCV</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span>

<span class="c1"># Membaca data dari file CSV</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;dataset_normalization.csv&#39;</span><span class="p">)</span>

<span class="c1"># Memisahkan data menjadi fitur (X) dan target (y)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># Jika targetnya disebut &#39;target&#39;</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span>

<span class="c1"># Normalisasi data menggunakan MinMaxScaler</span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">()</span>
<span class="n">X_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

<span class="c1"># Menyimpan scaler ke file pickle</span>
<span class="n">scaler_filename</span> <span class="o">=</span> <span class="s2">&quot;preprocessing.pickle&quot;</span>
<span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">scaler</span><span class="p">,</span> <span class="nb">open</span><span class="p">(</span><span class="n">scaler_filename</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">))</span>

<span class="c1"># Membagi data menjadi data pelatihan dan data pengujian</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X_scaled</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># Menentukan kisaran nilai K yang ingin diuji</span>
<span class="n">param_grid</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;n_neighbors&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">15</span><span class="p">]}</span>

<span class="c1"># Inisialisasi model KNN</span>
<span class="n">knn</span> <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">()</span>

<span class="c1"># Inisialisasi Grid Search Cross-Validation</span>
<span class="n">grid_search</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="n">knn</span><span class="p">,</span> <span class="n">param_grid</span><span class="o">=</span><span class="n">param_grid</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="c1"># Melatih model menggunakan Grid Search Cross-Validation</span>
<span class="n">grid_search</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="c1"># Menampilkan hasil Grid Search</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;K optimal: &quot;</span><span class="p">,</span> <span class="n">grid_search</span><span class="o">.</span><span class="n">best_params_</span><span class="p">)</span>

<span class="c1"># Menggunakan model terbaik untuk prediksi pada data uji</span>
<span class="n">best_knn</span> <span class="o">=</span> <span class="n">grid_search</span><span class="o">.</span><span class="n">best_estimator_</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">best_knn</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="c1"># Menghitung dan menampilkan akurasi model</span>
<span class="n">accuracy</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Akurasi pada data uji: &quot;</span><span class="p">,</span> <span class="n">accuracy</span><span class="p">)</span>

<span class="c1"># Menyimpan model yang sudah dilatih ke file pickle</span>
<span class="n">model_filename</span> <span class="o">=</span> <span class="s2">&quot;knn_model.pickle&quot;</span>
<span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">best_knn</span><span class="p">,</span> <span class="nb">open</span><span class="p">(</span><span class="n">model_filename</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>K optimal:  {&#39;n_neighbors&#39;: 5}
Akurasi pada data uji:  0.8363636363636363
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">sklearn.naive_bayes</span> <span class="kn">import</span> <span class="n">GaussianNB</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">BaggingClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span><span class="p">,</span> <span class="n">classification_report</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pickle</span>

<span class="c1"># Load the training and testing datasets</span>
<span class="n">train_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;hd_training_80.csv&#39;</span><span class="p">)</span>
<span class="n">test_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;hd_testing_20.csv&#39;</span><span class="p">)</span>

<span class="c1"># Assuming the last column is the target</span>
<span class="n">X_train</span> <span class="o">=</span> <span class="n">train_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">y_train</span> <span class="o">=</span> <span class="n">train_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">test_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">y_test</span> <span class="o">=</span> <span class="n">test_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<span class="c1"># Check class balance</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Class distribution in training set:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y_train</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Class distribution in test set:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y_test</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>

<span class="c1"># Scale features</span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">X_train_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">X_test_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="c1"># Save the scaler</span>
<span class="n">scaler_filename</span> <span class="o">=</span> <span class="s2">&quot;preprocessing.pickle&quot;</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">scaler_filename</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">scaler_file</span><span class="p">:</span>
    <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">scaler</span><span class="p">,</span> <span class="n">scaler_file</span><span class="p">)</span>

<span class="c1"># Number of estimators</span>
<span class="n">n_estimators</span> <span class="o">=</span> <span class="mi">10</span>

<span class="c1"># Create and train the BaggingClassifier with a Naive Bayes estimator</span>
<span class="n">clf</span> <span class="o">=</span> <span class="n">BaggingClassifier</span><span class="p">(</span><span class="n">base_estimator</span><span class="o">=</span><span class="n">GaussianNB</span><span class="p">(),</span> <span class="n">n_estimators</span><span class="o">=</span><span class="n">n_estimators</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_scaled</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="c1"># Save the trained model to a pickle file</span>
<span class="n">model_filename</span> <span class="o">=</span> <span class="s2">&quot;bagging_classifier_model.pickle&quot;</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">model_filename</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">model_file</span><span class="p">:</span>
    <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">clf</span><span class="p">,</span> <span class="n">model_file</span><span class="p">)</span>

<span class="c1"># Make a prediction on the sample input from the training data</span>
<span class="n">sample_input</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">sample_input_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">sample_input</span><span class="p">)</span>
<span class="n">prediction</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">sample_input_scaled</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Prediction with n_estimators=</span><span class="si">{</span><span class="n">n_estimators</span><span class="si">}</span><span class="s1"> for sample input: </span><span class="si">{</span><span class="n">prediction</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1"># Evaluate the model on the testing set</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_scaled</span><span class="p">)</span>
<span class="n">accuracy</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Accuracy with n_estimators=</span><span class="si">{</span><span class="n">n_estimators</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="n">accuracy</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1"># Classification report for detailed analysis</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Classification Report:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">))</span>

<span class="c1"># Save the results to a DataFrame and then to a CSV file</span>
<span class="n">results_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;n_estimators&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">n_estimators</span><span class="p">],</span>
    <span class="s1">&#39;accuracy&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">accuracy</span><span class="p">]</span>
<span class="p">})</span>
<span class="n">results_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;bagging.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Generate random data for predictions</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># Set seed for reproducibility</span>
<span class="n">random_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X_train</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">X_train</span><span class="o">.</span><span class="n">columns</span><span class="p">))</span>
<span class="n">random_data_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">random_data</span><span class="p">)</span>

<span class="c1"># Make predictions on the random data</span>
<span class="n">random_predictions</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">random_data_scaled</span><span class="p">)</span>

<span class="c1"># Save the final model&#39;s predictions on the entire training set along with Bagging value</span>
<span class="n">train_predictions_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;bagging&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">n_estimators</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">random_predictions</span><span class="p">),</span>
    <span class="s1">&#39;prediction&#39;</span><span class="p">:</span> <span class="n">random_predictions</span>
<span class="p">})</span>
<span class="n">train_predictions_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;train_predictions.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Class distribution in training set:
target
1    115
0    102
Name: count, dtype: int64
Class distribution in test set:
target
1    32
0    23
Name: count, dtype: int64
/shared-libs/python3.9/py/lib/python3.9/site-packages/sklearn/base.py:450: UserWarning: X does not have valid feature names, but StandardScaler was fitted with feature names
  warnings.warn(
Prediction with n_estimators=10 for sample input: [1]
Accuracy with n_estimators=10: 0.8364
Classification Report:
              precision    recall  f1-score   support

           0       0.94      0.65      0.77        23
           1       0.79      0.97      0.87        32

    accuracy                           0.84        55
   macro avg       0.87      0.81      0.82        55
weighted avg       0.85      0.84      0.83        55

/shared-libs/python3.9/py/lib/python3.9/site-packages/sklearn/base.py:450: UserWarning: X does not have valid feature names, but StandardScaler was fitted with feature names
  warnings.warn(
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pickle</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># Load the trained model</span>
<span class="n">model_filename</span> <span class="o">=</span> <span class="s1">&#39;bagging_classifier_model.pickle&#39;</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">model_filename</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">model_file</span><span class="p">:</span>
    <span class="n">modelku</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">model_file</span><span class="p">)</span>

<span class="c1"># Load the pre-processing scaler</span>
<span class="n">scaler_filename</span> <span class="o">=</span> <span class="s1">&#39;preprocessing.pickle&#39;</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">scaler_filename</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">scaler_file</span><span class="p">:</span>
    <span class="n">pra_proses</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">scaler_file</span><span class="p">)</span>

<span class="c1"># Sample data for prediction</span>
<span class="n">data_sample</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0582010582</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.3301886792</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.09677419355</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.6666666667</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">arr</span> <span class="o">=</span> <span class="p">[</span><span class="n">data_sample</span><span class="p">]</span>

<span class="c1"># Pre-process the data sample</span>
<span class="n">hasil</span> <span class="o">=</span> <span class="n">pra_proses</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>

<span class="c1"># Predict using the loaded model</span>
<span class="n">prediksi</span> <span class="o">=</span> <span class="n">modelku</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">hasil</span><span class="p">)</span>

<span class="c1"># Display the prediction result</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Hasil Prediksi:&quot;</span><span class="p">,</span> <span class="n">prediksi</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Hasil Prediksi: [0]
/shared-libs/python3.9/py/lib/python3.9/site-packages/sklearn/base.py:450: UserWarning: X does not have valid feature names, but StandardScaler was fitted with feature names
  warnings.warn(
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="proses-hosting">
<h2>Proses Hosting<a class="headerlink" href="#proses-hosting" title="Link to this heading">#</a></h2>
<p>Setelah website yang dibuat jadi, kami menghosting wbsite tersebut menggunakan website hosting ploomber. Untuk langkah langkah hosting dapat disimak sebagai berikut:</p>
<ul class="simple">
<li><p>Buka website dari ploomber cloud <a class="reference external" href="https://ploomber.io/">https://ploomber.io/</a> , setelah itu login terlebih dahulu</p></li>
</ul>
<ul class="simple">
<li><p>Lalu pilih fitur application, klik ‚ÄòNEW‚Äô untuk memasukan file</p></li>
</ul>
<ul class="simple">
<li><p>Pilih framework, disini kami memakai framework Flask</p></li>
</ul>
<ul class="simple">
<li><p>Selanjutnya masukan file yang sudah berbentuk zip</p></li>
</ul>
<ul class="simple">
<li><p>Lalu klik ‚Äòcreate‚Äô</p></li>
</ul>
<p>Berikut adalah aplikasi yang sudah kami hosting <a class="reference external" href="https://misty-smoke-2369.ploomberapp.io">https://misty-smoke-2369.ploomberapp.io</a></p>
<a style='text-decoration:none;line-height:16px;display:flex;color:#5B5B62;padding:10px;justify-content:end;' href='https://deepnote.com?utm_source=created-in-deepnote-cell&projectId=22d9449c-fd95-4c2b-a4dc-b93a8c81f983' target="_blank">
<img alt='Created in deepnote.com' style='display:inline;max-height:16px;margin:0px;margin-right:7.5px;' src='data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iODBweCIgaGVpZ2h0PSI4MHB4IiB2aWV3Qm94PSIwIDAgODAgODAiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU0LjEgKDc2NDkwKSAtIGh0dHBzOi8vc2tldGNoYXBwLmNvbSAtLT4KICAgIDx0aXRsZT5Hcm91cCAzPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9IkxhbmRpbmciIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxnIGlkPSJBcnRib2FyZCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTEyMzUuMDAwMDAwLCAtNzkuMDAwMDAwKSI+CiAgICAgICAgICAgIDxnIGlkPSJHcm91cC0zIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMjM1LjAwMDAwMCwgNzkuMDAwMDAwKSI+CiAgICAgICAgICAgICAgICA8cG9seWdvbiBpZD0iUGF0aC0yMCIgZmlsbD0iIzAyNjVCNCIgcG9pbnRzPSIyLjM3NjIzNzYyIDgwIDM4LjA0NzY2NjcgODAgNTcuODIxNzgyMiA3My44MDU3NTkyIDU3LjgyMTc4MjIgMzIuNzU5MjczOSAzOS4xNDAyMjc4IDMxLjY4MzE2ODMiPjwvcG9seWdvbj4KICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0zNS4wMDc3MTgsODAgQzQyLjkwNjIwMDcsNzYuNDU0OTM1OCA0Ny41NjQ5MTY3LDcxLjU0MjI2NzEgNDguOTgzODY2LDY1LjI2MTk5MzkgQzUxLjExMjI4OTksNTUuODQxNTg0MiA0MS42NzcxNzk1LDQ5LjIxMjIyODQgMjUuNjIzOTg0Niw0OS4yMTIyMjg0IEMyNS40ODQ5Mjg5LDQ5LjEyNjg0NDggMjkuODI2MTI5Niw0My4yODM4MjQ4IDM4LjY0NzU4NjksMzEuNjgzMTY4MyBMNzIuODcxMjg3MSwzMi41NTQ0MjUgTDY1LjI4MDk3Myw2Ny42NzYzNDIxIEw1MS4xMTIyODk5LDc3LjM3NjE0NCBMMzUuMDA3NzE4LDgwIFoiIGlkPSJQYXRoLTIyIiBmaWxsPSIjMDAyODY4Ij48L3BhdGg+CiAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMCwzNy43MzA0NDA1IEwyNy4xMTQ1MzcsMC4yNTcxMTE0MzYgQzYyLjM3MTUxMjMsLTEuOTkwNzE3MDEgODAsMTAuNTAwMzkyNyA4MCwzNy43MzA0NDA1IEM4MCw2NC45NjA0ODgyIDY0Ljc3NjUwMzgsNzkuMDUwMzQxNCAzNC4zMjk1MTEzLDgwIEM0Ny4wNTUzNDg5LDc3LjU2NzA4MDggNTMuNDE4MjY3Nyw3MC4zMTM2MTAzIDUzLjQxODI2NzcsNTguMjM5NTg4NSBDNTMuNDE4MjY3Nyw0MC4xMjg1NTU3IDM2LjMwMzk1NDQsMzcuNzMwNDQwNSAyNS4yMjc0MTcsMzcuNzMwNDQwNSBDMTcuODQzMDU4NiwzNy43MzA0NDA1IDkuNDMzOTE5NjYsMzcuNzMwNDQwNSAwLDM3LjczMDQ0MDUgWiIgaWQ9IlBhdGgtMTkiIGZpbGw9IiMzNzkzRUYiPjwvcGF0aD4KICAgICAgICAgICAgPC9nPgogICAgICAgIDwvZz4KICAgIDwvZz4KPC9zdmc+' > </img>
Created in <span style='font-weight:600;margin-left:4px;'>Deepnote</span></a></section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="notebooks.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Content with notebooks</p>
      </div>
    </a>
    <a class="right-next"
       href="markdown-notebooks.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Notebooks with MyST Markdown</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-understanding-memahami-data">1. Data Understanding (memahami data)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#menampilkan-data">Menampilkan Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#menentukan-missing-value">Menentukan Missing Value</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mengeksplorasi-data-numerik">Mengeksplorasi Data (Numerik)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mengeksplorasi-data-categorical">Mengeksplorasi Data (Categorical)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#menentukan-outlier">Menentukan Outlier</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#preprocessing">2. Preprocessing</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#menghapus-outlier">Menghapus Outlier</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#memisahkan-data-numeric-dan-categorical">Memisahkan data Numeric dan Categorical</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#min-max">Min Max</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#normalisasi-data">Normalisasi Data</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pemodelan">3. Pemodelan</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pengujian-dan-percobaan-dataset">Pengujian dan Percobaan Dataset</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#menyimpan-data-training-dan-data-testing-ke-csv">Menyimpan Data Training dan Data Testing ke CSV</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#prediksi-penyakit-jantung-menggunakan-klasifikasi-k-nearest-neighboars-knn">Prediksi Penyakit jantung Menggunakan Klasifikasi K-Nearest Neighboars (KNN)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Menampilkan data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#menampilkan-grafik-data">Menampilkan grafik data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#menentukan-nilai-k">Menentukan nilai K</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#menghitung-knn">Menghitung KNN</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#stacking-ensemble">Stacking Ensemble</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-training">Data Training</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-testing">Data Testing</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ensemble-bagging">Ensemble Bagging</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Menampilkan Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#memprediksi-menggunakan-ensemble-bagging-n-estimators-in-range-3-10">Memprediksi Menggunakan Ensemble Bagging (n_estimators in range 3-10)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pembuatan-website-atau-aplikasi">Pembuatan Website atau Aplikasi</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pickle">Pickle</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#proses-hosting">Proses Hosting</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The Jupyter Book Community
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      ¬© Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=3ee479438cf8b5e0d341"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=3ee479438cf8b5e0d341"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>